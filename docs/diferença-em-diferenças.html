<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 Diferença em Diferenças | Curso de Inferência Causal</title>
  <meta name="description" content="Capítulo 8 Diferença em Diferenças | Curso de Inferência Causal" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 Diferença em Diferenças | Curso de Inferência Causal" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 Diferença em Diferenças | Curso de Inferência Causal" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2025-06-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="desenho-de-regresão-discontínua.html"/>
<link rel="next" href="time-series-cross-section-tscs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causalidade</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introdução</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#revisão-de-regressão"><i class="fa fa-check"></i><b>1.1</b> Revisão de Regressão</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#teorema-da-anatomia-da-regressão"><i class="fa fa-check"></i><b>1.1.1</b> Teorema da Anatomia da Regressão</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#inferência"><i class="fa fa-check"></i><b>1.2</b> Inferência</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#referências"><i class="fa fa-check"></i><b>1.3</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html"><i class="fa fa-check"></i><b>2</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="2.1" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#causalidade-e-o-método-comparativo"><i class="fa fa-check"></i><b>2.1</b> Causalidade e o Método Comparativo</a></li>
<li class="chapter" data-level="2.2" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#potential-outcomes"><i class="fa fa-check"></i><b>2.2</b> Potential Outcomes</a></li>
<li class="chapter" data-level="2.3" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#notação"><i class="fa fa-check"></i><b>2.3</b> Notação</a></li>
<li class="chapter" data-level="2.4" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#problema-fundamental-da-inferência-causal"><i class="fa fa-check"></i><b>2.4</b> Problema Fundamental da Inferência Causal</a></li>
<li class="chapter" data-level="2.5" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#estimando"><i class="fa fa-check"></i><b>2.5</b> Estimando</a></li>
<li class="chapter" data-level="2.6" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#estimandos-mais-comuns"><i class="fa fa-check"></i><b>2.6</b> Estimandos Mais Comuns</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#ate"><i class="fa fa-check"></i><b>2.6.1</b> ATE</a></li>
<li class="chapter" data-level="2.6.2" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#att"><i class="fa fa-check"></i><b>2.6.2</b> ATT</a></li>
<li class="chapter" data-level="2.6.3" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#cate"><i class="fa fa-check"></i><b>2.6.3</b> CATE</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#nota-sobre-estimandos"><i class="fa fa-check"></i><b>2.7</b> Nota sobre estimandos</a></li>
<li class="chapter" data-level="2.8" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#exercício---qual-o-estimando-e-o-estimador-se-possível"><i class="fa fa-check"></i><b>2.8</b> Exercício - Qual o estimando e o estimador (se possível)?</a></li>
<li class="chapter" data-level="2.9" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#identificação"><i class="fa fa-check"></i><b>2.9</b> Identificação</a></li>
<li class="chapter" data-level="2.10" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#identificação-do-ate"><i class="fa fa-check"></i><b>2.10</b> Identificação do ATE</a></li>
<li class="chapter" data-level="2.11" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#equações-estruturais"><i class="fa fa-check"></i><b>2.11</b> Equações estruturais</a></li>
<li class="chapter" data-level="2.12" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#modelo-versus-desenho"><i class="fa fa-check"></i><b>2.12</b> Modelo versus Desenho</a></li>
<li class="chapter" data-level="2.13" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#exercício-em-sala"><i class="fa fa-check"></i><b>2.13</b> Exercício em sala</a></li>
<li class="chapter" data-level="2.14" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#referências-1"><i class="fa fa-check"></i><b>2.14</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dags.html"><a href="dags.html"><i class="fa fa-check"></i><b>3</b> DAGs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dags.html"><a href="dags.html#causalidade"><i class="fa fa-check"></i><b>3.1</b> Causalidade</a></li>
<li class="chapter" data-level="3.2" data-path="dags.html"><a href="dags.html#introdução-1"><i class="fa fa-check"></i><b>3.2</b> Introdução</a></li>
<li class="chapter" data-level="3.3" data-path="dags.html"><a href="dags.html#os-tipos-básicos-de-dags"><i class="fa fa-check"></i><b>3.3</b> Os Tipos Básicos de DAGs</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dags.html"><a href="dags.html#chains"><i class="fa fa-check"></i><b>3.3.1</b> 1. Chains</a></li>
<li class="chapter" data-level="3.3.2" data-path="dags.html"><a href="dags.html#forks"><i class="fa fa-check"></i><b>3.3.2</b> 2. Forks</a></li>
<li class="chapter" data-level="3.3.3" data-path="dags.html"><a href="dags.html#colliders"><i class="fa fa-check"></i><b>3.3.3</b> 3. Colliders</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dags.html"><a href="dags.html#simulação-no-r-ilustrando-o-collider-bias"><i class="fa fa-check"></i><b>3.4</b> Simulação no R: Ilustrando o Collider Bias</a></li>
<li class="chapter" data-level="3.5" data-path="dags.html"><a href="dags.html#definições"><i class="fa fa-check"></i><b>3.5</b> Definições</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="dags.html"><a href="dags.html#relações-entre-variáveis-nós"><i class="fa fa-check"></i><b>3.5.1</b> Relações entre Variáveis (nós):</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dags.html"><a href="dags.html#controle-e-ajuste"><i class="fa fa-check"></i><b>3.6</b> Controle e Ajuste</a></li>
<li class="chapter" data-level="3.7" data-path="dags.html"><a href="dags.html#fatorização-da-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.7</b> Fatorização da Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.8" data-path="dags.html"><a href="dags.html#fatorização-e-dags"><i class="fa fa-check"></i><b>3.8</b> Fatorização e DAGs</a></li>
<li class="chapter" data-level="3.9" data-path="dags.html"><a href="dags.html#fatorização-dags-e-causalidade"><i class="fa fa-check"></i><b>3.9</b> Fatorização, DAGs e Causalidade</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="experimentos.html"><a href="experimentos.html"><i class="fa fa-check"></i><b>4</b> Experimentos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="experimentos.html"><a href="experimentos.html#introdução-2"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="experimentos.html"><a href="experimentos.html#experimentos-aleatórios"><i class="fa fa-check"></i><b>4.2</b> Experimentos aleatórios</a></li>
<li class="chapter" data-level="4.3" data-path="experimentos.html"><a href="experimentos.html#restrição-de-exclusão"><i class="fa fa-check"></i><b>4.3</b> Restrição de Exclusão</a></li>
<li class="chapter" data-level="4.4" data-path="experimentos.html"><a href="experimentos.html#tipos-de-experimentos"><i class="fa fa-check"></i><b>4.4</b> Tipos de experimentos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="experimentos.html"><a href="experimentos.html#aleatorização-de-bernoulli"><i class="fa fa-check"></i><b>4.4.1</b> Aleatorização de Bernoulli</a></li>
<li class="chapter" data-level="4.4.2" data-path="experimentos.html"><a href="experimentos.html#aleatorização-completa"><i class="fa fa-check"></i><b>4.4.2</b> Aleatorização Completa</a></li>
<li class="chapter" data-level="4.4.3" data-path="experimentos.html"><a href="experimentos.html#aleatorização-condicional-block-random-assigment"><i class="fa fa-check"></i><b>4.4.3</b> Aleatorização Condicional (Block Random Assigment)</a></li>
<li class="chapter" data-level="4.4.4" data-path="experimentos.html"><a href="experimentos.html#pensando-aleatorização-em-bloco"><i class="fa fa-check"></i><b>4.4.4</b> Pensando aleatorização em bloco</a></li>
<li class="chapter" data-level="4.4.5" data-path="experimentos.html"><a href="experimentos.html#ate-com-aleatorização-condicional-bloco"><i class="fa fa-check"></i><b>4.4.5</b> ATE com Aleatorização Condicional (Bloco)</a></li>
<li class="chapter" data-level="4.4.6" data-path="experimentos.html"><a href="experimentos.html#aleatorização-em-bloco"><i class="fa fa-check"></i><b>4.4.6</b> Aleatorização em bloco</a></li>
<li class="chapter" data-level="4.4.7" data-path="experimentos.html"><a href="experimentos.html#precisão-da-aleatorização-em-bloco"><i class="fa fa-check"></i><b>4.4.7</b> Precisão da aleatorização em bloco</a></li>
<li class="chapter" data-level="4.4.8" data-path="experimentos.html"><a href="experimentos.html#comparação-de-ses"><i class="fa fa-check"></i><b>4.4.8</b> Comparação de SEs</a></li>
<li class="chapter" data-level="4.4.9" data-path="experimentos.html"><a href="experimentos.html#cluster-randomization"><i class="fa fa-check"></i><b>4.4.9</b> Cluster randomization</a></li>
<li class="chapter" data-level="4.4.10" data-path="experimentos.html"><a href="experimentos.html#tabelas-em-artigos"><i class="fa fa-check"></i><b>4.4.10</b> Tabelas em artigos</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="experimentos.html"><a href="experimentos.html#estimador-ate"><i class="fa fa-check"></i><b>4.5</b> Estimador ATE</a></li>
<li class="chapter" data-level="4.6" data-path="experimentos.html"><a href="experimentos.html#key-takeways"><i class="fa fa-check"></i><b>4.6</b> Key Takeways</a></li>
<li class="chapter" data-level="4.7" data-path="experimentos.html"><a href="experimentos.html#declare-design"><i class="fa fa-check"></i><b>4.7</b> Declare Design</a></li>
<li class="chapter" data-level="4.8" data-path="experimentos.html"><a href="experimentos.html#exercício"><i class="fa fa-check"></i><b>4.8</b> Exercício</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="experimentos.html"><a href="experimentos.html#experimento-com-envio-de-cartões-postais-e-participação-eleitoral"><i class="fa fa-check"></i><b>4.8.1</b> Experimento com envio de cartões-postais e participação eleitoral</a></li>
<li class="chapter" data-level="4.8.2" data-path="experimentos.html"><a href="experimentos.html#experimento-com-anúncios-de-tv-e-participação-eleitoral"><i class="fa fa-check"></i><b>4.8.2</b> Experimento com anúncios de TV e participação eleitoral</a></li>
<li class="chapter" data-level="4.8.3" data-path="experimentos.html"><a href="experimentos.html#exclusão-de-participantes-em-experimentos-de-survey"><i class="fa fa-check"></i><b>4.8.3</b> Exclusão de participantes em experimentos de survey</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html"><i class="fa fa-check"></i><b>5</b> Propensity Score e Matching</a>
<ul>
<li class="chapter" data-level="5.1" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#introdução-3"><i class="fa fa-check"></i><b>5.1</b> Introdução</a></li>
<li class="chapter" data-level="5.2" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#propensity-score"><i class="fa fa-check"></i><b>5.2</b> Propensity Score</a></li>
<li class="chapter" data-level="5.3" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching"><i class="fa fa-check"></i><b>5.3</b> Matching</a></li>
<li class="chapter" data-level="5.4" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#suposições-de-identificação"><i class="fa fa-check"></i><b>5.4</b> Suposições de identificação</a></li>
<li class="chapter" data-level="5.5" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-1"><i class="fa fa-check"></i><b>5.5</b> Matching</a></li>
<li class="chapter" data-level="5.6" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-exato"><i class="fa fa-check"></i><b>5.6</b> Matching exato</a></li>
<li class="chapter" data-level="5.7" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-aproximado"><i class="fa fa-check"></i><b>5.7</b> Matching aproximado</a></li>
<li class="chapter" data-level="5.8" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#estimando-1"><i class="fa fa-check"></i><b>5.8</b> Estimando</a></li>
<li class="chapter" data-level="5.9" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#declare-design-e-matching"><i class="fa fa-check"></i><b>5.9</b> Declare Design e Matching</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-e-propensity-scores"><i class="fa fa-check"></i><b>5.9.1</b> Matching e Propensity scores</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#recomendações-práticas-sobre-matching"><i class="fa fa-check"></i><b>5.10</b> Recomendações Práticas sobre Matching</a></li>
<li class="chapter" data-level="5.11" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#referências-2"><i class="fa fa-check"></i><b>5.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html"><i class="fa fa-check"></i><b>6</b> Variáveis Instrumentais</a>
<ul>
<li class="chapter" data-level="6.1" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#introdução-4"><i class="fa fa-check"></i><b>6.1</b> Introdução</a></li>
<li class="chapter" data-level="6.2" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#iv-com-modelo-estrutural"><i class="fa fa-check"></i><b>6.2</b> IV com modelo estrutural</a></li>
<li class="chapter" data-level="6.3" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#mqo-em-2-estágios"><i class="fa fa-check"></i><b>6.3</b> MQO em 2 Estágios</a></li>
<li class="chapter" data-level="6.4" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#principais-usos-de-iv"><i class="fa fa-check"></i><b>6.4</b> Principais usos de IV</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#experimentos-1"><i class="fa fa-check"></i><b>6.4.1</b> Experimentos</a></li>
<li class="chapter" data-level="6.4.2" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#regras-com-variação-quasi-aleatória"><i class="fa fa-check"></i><b>6.4.2</b> Regras com variação quasi-aleatória</a></li>
<li class="chapter" data-level="6.4.3" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#teoria"><i class="fa fa-check"></i><b>6.4.3</b> Teoria</a></li>
<li class="chapter" data-level="6.4.4" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#suposições-para-estimar-o-late"><i class="fa fa-check"></i><b>6.4.4</b> Suposições para estimar o LATE</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#restrição-de-exclusão-1"><i class="fa fa-check"></i><b>6.5</b> Restrição de Exclusão</a></li>
<li class="chapter" data-level="6.6" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#monoticidade"><i class="fa fa-check"></i><b>6.6</b> Monoticidade</a></li>
<li class="chapter" data-level="6.7" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#estimação-aka-estatística-f"><i class="fa fa-check"></i><b>6.7</b> Estimação (aka estatística F)</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#f-stat"><i class="fa fa-check"></i><b>6.7.1</b> F stat</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#referências-3"><i class="fa fa-check"></i><b>6.8</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html"><i class="fa fa-check"></i><b>7</b> Desenho de Regresão Discontínua</a>
<ul>
<li class="chapter" data-level="7.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#outline-da-aula"><i class="fa fa-check"></i><b>7.1</b> Outline da aula</a></li>
<li class="chapter" data-level="7.2" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#características-chave-da-rdd"><i class="fa fa-check"></i><b>7.2</b> Características-chave da RDD</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#determinação-do-tratamento"><i class="fa fa-check"></i><b>7.2.1</b> Determinação do Tratamento</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#fuzzy-rdd"><i class="fa fa-check"></i><b>7.3</b> Fuzzy RDD</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#observação-e-corte"><i class="fa fa-check"></i><b>7.3.1</b> Observação e Corte</a></li>
<li class="chapter" data-level="7.3.2" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#estimativa-dos-efeitos-do-tratamento"><i class="fa fa-check"></i><b>7.3.2</b> Estimativa dos Efeitos do Tratamento</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#suposição-de-continuidade"><i class="fa fa-check"></i><b>7.4</b> Suposição de continuidade</a></li>
<li class="chapter" data-level="7.5" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#suposições-na-rdd"><i class="fa fa-check"></i><b>7.5</b> Suposições na RDD</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#suposição-de-não-manipulação-com-precisão"><i class="fa fa-check"></i><b>7.5.1</b> Suposição de Não-manipulação com Precisão</a></li>
<li class="chapter" data-level="7.5.2" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#problemas-de-manipulação"><i class="fa fa-check"></i><b>7.5.2</b> Problemas de Manipulação</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#testabilidade-da-suposição-de-não-manipulação"><i class="fa fa-check"></i><b>7.6</b> Testabilidade da Suposição de não-Manipulação</a></li>
<li class="chapter" data-level="7.7" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#estimação-em-rdd"><i class="fa fa-check"></i><b>7.7</b> Estimação em RDD</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#problema-de-complete-overlapping"><i class="fa fa-check"></i><b>7.7.1</b> Problema de Complete Overlapping</a></li>
<li class="chapter" data-level="7.7.2" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#dependência-de-extrapolação"><i class="fa fa-check"></i><b>7.7.2</b> Dependência de Extrapolação</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#métodos-de-estimação"><i class="fa fa-check"></i><b>7.8</b> Métodos de Estimação</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#identificação-no-limite"><i class="fa fa-check"></i><b>7.8.1</b> Identificação no Limite</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#trade-off-de-viés-variância"><i class="fa fa-check"></i><b>7.9</b> Trade-off de Viés-Variância</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#métodos-de-largura-de-banda-ótima"><i class="fa fa-check"></i><b>7.9.1</b> Métodos de Largura de Banda Ótima</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#regras-arbitrárias"><i class="fa fa-check"></i><b>7.10</b> Regras arbitrárias</a></li>
<li class="chapter" data-level="7.11" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#simulação"><i class="fa fa-check"></i><b>7.11</b> Simulação</a></li>
<li class="chapter" data-level="7.12" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#simulação---potential-outcomes-y0"><i class="fa fa-check"></i><b>7.12</b> Simulação - Potential Outcomes Y0</a></li>
<li class="chapter" data-level="7.13" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#simulação---potential-outcomes-y1"><i class="fa fa-check"></i><b>7.13</b> Simulação - Potential Outcomes Y1</a></li>
<li class="chapter" data-level="7.14" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#simulação---potential-outcomes-y1-e-y0"><i class="fa fa-check"></i><b>7.14</b> Simulação - Potential Outcomes Y1 e Y0</a></li>
<li class="chapter" data-level="7.15" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#simulação---y-observado"><i class="fa fa-check"></i><b>7.15</b> Simulação - Y observado</a></li>
<li class="chapter" data-level="7.16" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#quando-o-rdd-funciona"><i class="fa fa-check"></i><b>7.16</b> Quando o RDD funciona?</a></li>
<li class="chapter" data-level="7.17" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#raw-data-versus-bin"><i class="fa fa-check"></i><b>7.17</b> Raw Data versus Bin</a></li>
<li class="chapter" data-level="7.18" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#permutation-tests-balancing"><i class="fa fa-check"></i><b>7.18</b> Permutation tests (balancing)</a></li>
<li class="chapter" data-level="7.19" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#mccray-test"><i class="fa fa-check"></i><b>7.19</b> McCray test</a></li>
<li class="chapter" data-level="7.20" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#robustez"><i class="fa fa-check"></i><b>7.20</b> Robustez</a></li>
<li class="chapter" data-level="7.21" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#densidade-descontínua---results"><i class="fa fa-check"></i><b>7.21</b> Densidade descontínua - results</a></li>
<li class="chapter" data-level="7.22" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#regressão-rdd"><i class="fa fa-check"></i><b>7.22</b> Regressão RDD</a></li>
<li class="chapter" data-level="7.23" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#placebo-tests"><i class="fa fa-check"></i><b>7.23</b> Placebo Tests</a></li>
<li class="chapter" data-level="7.24" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#pcrd"><i class="fa fa-check"></i><b>7.24</b> PCRD</a></li>
<li class="chapter" data-level="7.25" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#checlist-para-um-paper"><i class="fa fa-check"></i><b>7.25</b> Checlist para um paper</a></li>
<li class="chapter" data-level="7.26" data-path="desenho-de-regresão-discontínua.html"><a href="desenho-de-regresão-discontínua.html#referências-4"><i class="fa fa-check"></i><b>7.26</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html"><i class="fa fa-check"></i><b>8</b> Diferença em Diferenças</a>
<ul>
<li class="chapter" data-level="8.1" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#modelo-básico-2x2"><i class="fa fa-check"></i><b>8.1</b> Modelo básico 2x2</a></li>
<li class="chapter" data-level="8.2" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#twfe"><i class="fa fa-check"></i><b>8.2</b> TWFE</a></li>
<li class="chapter" data-level="8.3" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#pressupostos"><i class="fa fa-check"></i><b>8.3</b> Pressupostos</a></li>
<li class="chapter" data-level="8.4" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#aplicação"><i class="fa fa-check"></i><b>8.4</b> Aplicação</a></li>
<li class="chapter" data-level="8.5" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#múltiplos-períodos"><i class="fa fa-check"></i><b>8.5</b> Múltiplos períodos</a></li>
<li class="chapter" data-level="8.6" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#tendências-paralelas"><i class="fa fa-check"></i><b>8.6</b> Tendências Paralelas</a></li>
<li class="chapter" data-level="8.7" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#múltiplos-períodos-pós-tratamento"><i class="fa fa-check"></i><b>8.7</b> Múltiplos períodos pós-tratamento</a></li>
<li class="chapter" data-level="8.8" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#análise-de-sensibilidade-em-did"><i class="fa fa-check"></i><b>8.8</b> Análise de sensibilidade em DiD</a></li>
<li class="chapter" data-level="8.9" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#did-generalizado"><i class="fa fa-check"></i><b>8.9</b> DiD generalizado</a></li>
<li class="chapter" data-level="8.10" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#did-com-adoção-escalonada-staggered-timing"><i class="fa fa-check"></i><b>8.10</b> DID com adoção escalonada (staggered timing)</a></li>
<li class="chapter" data-level="8.11" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#paper-voter-gratitude-last-long"><i class="fa fa-check"></i><b>8.11</b> Paper Voter Gratitude Last Long?</a></li>
<li class="chapter" data-level="8.12" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#referências-5"><i class="fa fa-check"></i><b>8.12</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html"><i class="fa fa-check"></i><b>9</b> Time-Series Cross-Section (TSCS)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#introdução-5"><i class="fa fa-check"></i><b>9.1</b> Introdução</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#within-versus-between"><i class="fa fa-check"></i><b>9.1.1</b> Within versus Between</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#ovb"><i class="fa fa-check"></i><b>9.2</b> OVB</a></li>
<li class="chapter" data-level="9.3" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#estimandos"><i class="fa fa-check"></i><b>9.3</b> Estimandos</a></li>
<li class="chapter" data-level="9.4" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#resultados-potenciais-1"><i class="fa fa-check"></i><b>9.4</b> Resultados Potenciais</a></li>
<li class="chapter" data-level="9.5" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#modelo-ar1"><i class="fa fa-check"></i><b>9.5</b> Modelo AR(1)</a></li>
<li class="chapter" data-level="9.6" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#sequential-ignorability"><i class="fa fa-check"></i><b>9.6</b> Sequential ignorability</a></li>
<li class="chapter" data-level="9.7" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#resumo"><i class="fa fa-check"></i><b>9.7</b> Resumo</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#remark"><i class="fa fa-check"></i><b>9.7.1</b> Remark</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#suposições-para-inferência"><i class="fa fa-check"></i><b>9.8</b> Suposições para Inferência</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#remark-1"><i class="fa fa-check"></i><b>9.8.1</b> Remark</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#efeitos-aleatórios"><i class="fa fa-check"></i><b>9.9</b> Efeitos aleatórios</a></li>
<li class="chapter" data-level="9.10" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#referências-6"><i class="fa fa-check"></i><b>9.10</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="synthetic-control.html"><a href="synthetic-control.html"><i class="fa fa-check"></i><b>10</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="synthetic-control.html"><a href="synthetic-control.html#tratamento"><i class="fa fa-check"></i><b>10.0.1</b> Tratamento</a></li>
<li class="chapter" data-level="10.1" data-path="synthetic-control.html"><a href="synthetic-control.html#implementação-no-r"><i class="fa fa-check"></i><b>10.1</b> Implementação no R</a></li>
<li class="chapter" data-level="10.2" data-path="synthetic-control.html"><a href="synthetic-control.html#synthethic-did"><i class="fa fa-check"></i><b>10.2</b> Synthethic DiD</a></li>
<li class="chapter" data-level="10.3" data-path="synthetic-control.html"><a href="synthetic-control.html#referências-7"><i class="fa fa-check"></i><b>10.3</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="llms-e-outras.html"><a href="llms-e-outras.html"><i class="fa fa-check"></i><b>11</b> LLMs e outras</a>
<ul>
<li class="chapter" data-level="11.1" data-path="llms-e-outras.html"><a href="llms-e-outras.html#google-colab"><i class="fa fa-check"></i><b>11.1</b> Google Colab</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html"><i class="fa fa-check"></i><b>12</b> Interferência, spillover e dinâmica</a>
<ul>
<li class="chapter" data-level="12.1" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html#suposições-simplifcadoras"><i class="fa fa-check"></i><b>12.1</b> Suposições simplifcadoras</a></li>
<li class="chapter" data-level="12.2" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html#po-com-tratamento-de-múltiplos-valores-multi-valued"><i class="fa fa-check"></i><b>12.2</b> PO com tratamento de múltiplos valores (multi-valued)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html#multi-valued-discreto"><i class="fa fa-check"></i><b>12.2.1</b> Multi-valued discreto</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html#dinâmica"><i class="fa fa-check"></i><b>12.3</b> Dinâmica</a></li>
<li class="chapter" data-level="12.4" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html#interferência"><i class="fa fa-check"></i><b>12.4</b> Interferência</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curso de Inferência Causal</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="diferença-em-diferenças" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Capítulo 8</span> Diferença em Diferenças<a href="diferença-em-diferenças.html#diferença-em-diferenças" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="modelo-básico-2x2" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Modelo básico 2x2<a href="diferença-em-diferenças.html#modelo-básico-2x2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos considerar primeiro um cenário de dois grupos <span class="math inline">\(G \in \{1,2\}\)</span> e dois períodos de tempo <span class="math inline">\(T \in \{1,2\}\)</span>.</p>
<p>A notação de resultados potenciais é:
<span class="math inline">\(Y_{gt}(0,0)\)</span> é o resultado potencial da unidade <span class="math inline">\(g\)</span> no período <span class="math inline">\(t\)</span> se não for tratada nos dois períodos.
<span class="math inline">\(Y_{gt}(0,1)\)</span> é o resultado potencial da unidade <span class="math inline">\(g\)</span> no período <span class="math inline">\(t\)</span> se for tratada no segundo período.</p>
<p>Usualmente nós simplificamos a notação com dois períodos para <span class="math inline">\(Y_{gt}(0)\)</span> e <span class="math inline">\(Y_{gt}(1)\)</span>. A vantagem da notação mais complexa é para manter a ideia de que o path (caminho) pode vir a ser relevante.</p>
<p>Supondo, como usual, que temos um tratamento binário <span class="math inline">\(D\)</span>, e que ele é ativado (implementado) apenas no período <span class="math inline">\(2\)</span> para um dos grupos, temos a seguinte tabela para descrever como usualmente se pensa as relações causais.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(t = 0\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(t = 1\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;border-right:1px solid;">
<span class="math inline">\(D = 0\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\gamma_0 + \alpha_i\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\gamma_1 + \alpha_i\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-right:1px solid;">
<span class="math inline">\(D = 1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\gamma_0 + \alpha_i + \tau_i\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\gamma_1 + \alpha_i + \tau_i\)</span>
</td>
</tr>
</tbody>
</table>
<p>A diferença para cada grupo <span class="math inline">\(g\)</span> é:
<span class="math display">\[
y_{g1} - y_{g0} = (\lambda_1 - \lambda_0) + \tau_i(D_i1 - D_i0)
\]</span>
Como pode haver mudança nos resultados apenas pela passagem do tempo, o efeito causal é não-identificado.
Contudo, veja que:</p>
<p><span class="math display">\[
\mathbb{E}[y_{g1} - y_{g0}|D_{i1} - D_{i0} = 1] - \mathbb{E}[y_{g1} - y_{g0}|D_{i1} - D_{i0} = 0] = \mathbb{E}[\tau_i(D_{i1} - D_{i0})|D_{i1} - D_{i0} = 1]
\]</span>
Unpacking:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\mathbb{E}[y_{g1} - y_{g0}|D_i1 - D_{i0} = 1]  = (\lambda_1 - \lambda_0) + \mathbb{E}[\tau_i|(D_{i1} - D_{i0})=1]\)</span> e</p></li>
<li><p><span class="math inline">\(\mathbb{E}[y_{g1} - y_{g0}|D_i1 - D_{i0} = 0] = (\lambda_1 - \lambda_0)\)</span>,</p></li>
</ol>
<p>então a diferença é <span class="math inline">\((\lambda_1 - \lambda_0) + \tau_i -  (\lambda_1 - \lambda_0) = \mathbb{E}[\tau_i|D_{i1}=1]\)</span>.</p>
</div>
<div id="twfe" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> TWFE<a href="diferença-em-diferenças.html#twfe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>É possível estimar um modelo de DiD com regressão.</p>
<p><span class="math display">\[
y_{gt} = \alpha + \beta_1 Post_t + \beta_2 Treat_g + \tau (Post_t \times Treat_g) + e_{gt}
\]</span>
Outras parametrização é:
<span class="math display">\[
y_{gt} = \alpha_g + \lambda_t + \tau D_{it} + e_{gt}
\]</span></p>
<p>A segunda parametrização é chamada de “two-way fixed effects”, pois usamos um efeito fixo de unidade e um de tempo.</p>
</div>
<div id="pressupostos" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Pressupostos<a href="diferença-em-diferenças.html#pressupostos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Os pressupostos de identificação de DiD são:</p>
<ol style="list-style-type: decimal">
<li>Tendências Paralelas.”Na ausência de tratamento, a média dos resultados potenciais teriam evoluído em paralelo”.</li>
</ol>
<p><span class="math inline">\(\mathbb{E}[Y_{g2}(0) - Y_{g1}(0)|D_g=1] = \mathbb{E}[Y_{g2}(0) - Y_{g1}(0)|D_g=0]\)</span></p>
<p>Suposição paramétrica das PT: <span class="math inline">\(Y_{gt}(0) = \alpha_g + \lambda_t + e_{it}\)</span>
Isso é na verdade um resultado: é possível mostrar que supor este modelo implica PT.</p>
<ol start="2" style="list-style-type: decimal">
<li>Não-antecipação: tratamento não possui efeito no período anterior.
<span class="math inline">\(\mathbb{E}[Y_{g1}(0)] = \mathbb{E}[Y_{g1}(1)]\)</span></li>
</ol>
</div>
<div id="aplicação" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Aplicação<a href="diferença-em-diferenças.html#aplicação" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos ver um exemplo no R, a partir de um estudo meu. Os dados são de um projeto da Transparência Brasil, chamado de Obra Transparente. O projeto consistiu em uma intervenção em 20 cidades do Sudeste, em que treinamento e informações foram dados a ongs locais para monitoramento de obras de creches e escolas. O projeto começou em maio de 2017 e terminou em junho de 2019. Os dados trazem informações sobre as obras nas cidades do projeto e nas demais cidades onde havia obras similares nos mesmos estados.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="diferença-em-diferenças.html#cb119-1" tabindex="-1"></a><span class="fu">library</span>(here, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb119-2"><a href="diferença-em-diferenças.html#cb119-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb119-3"><a href="diferença-em-diferenças.html#cb119-3" tabindex="-1"></a>data_ot <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">&quot;Dados&quot;</span>, <span class="st">&quot;obra_transparente.RDS&quot;</span>))</span>
<span id="cb119-4"><a href="diferença-em-diferenças.html#cb119-4" tabindex="-1"></a><span class="fu">head</span>(data_ot) <span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="diferença-em-diferenças.html#cb119-5" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="16%" />
<col width="13%" />
<col width="18%" />
<col width="10%" />
<col width="18%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">municipio</th>
<th align="right">concluida</th>
<th align="right">group_treated</th>
<th align="right">periodo</th>
<th align="right">time_treated1</th>
<th align="right">post_treat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1366</td>
<td align="left">Conchas</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1367</td>
<td align="left">Itararé</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1391</td>
<td align="left">Brotas</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1392</td>
<td align="left">Buritizal</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1393</td>
<td align="left">Caconde</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1400</td>
<td align="left">Porteirinha</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Como o gráfico abaixo mostra, o grupo controle possui percentual mais elevado de obras concluídas em comparação ao grupo de tratamento, mesmo antes do projeto ter se iniciado. Olhando para outras covariáveis (não mostradas aqui), de fato os dois grupos eram bastante desbalanceados. Porém, apesar da diferença de nível, as mudanças (evolução temposal) são similares. Isso sugere um dif in dif como uma metodologia adequada para estimar o efeito causal.</p>
<p><img src="bookdownproj_files/figure-html/obra-transparente-1.png" width="672" /></p>
<p>A partir do período 4 o tratamento já poderia fazer efeito, mas ele é muito pequeno (leve mudança na inclinação) e o efeito é relevante apenas após o período 5. Temos portando efeitos dinâmicos.Vamos inicialmente ajustar um modelo estático, considerando apenas o período 1 e 5.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="diferença-em-diferenças.html#cb120-1" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb120-2"><a href="diferença-em-diferenças.html#cb120-2" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb120-3"><a href="diferença-em-diferenças.html#cb120-3" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb120-4"><a href="diferença-em-diferenças.html#cb120-4" tabindex="-1"></a>data_ot_reg <span class="ot">&lt;-</span> data_ot <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="diferença-em-diferenças.html#cb120-5" tabindex="-1"></a>  <span class="fu">filter</span>(periodo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb120-6"><a href="diferença-em-diferenças.html#cb120-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">post =</span> <span class="fu">ifelse</span>(periodo <span class="sc">==</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb120-7"><a href="diferença-em-diferenças.html#cb120-7" tabindex="-1"></a></span>
<span id="cb120-8"><a href="diferença-em-diferenças.html#cb120-8" tabindex="-1"></a>did <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(concluida <span class="sc">~</span> post <span class="sc">+</span> group_treated <span class="sc">+</span> post<span class="sc">*</span>group_treated, <span class="at">data=</span>data_ot_reg,</span>
<span id="cb120-9"><a href="diferença-em-diferenças.html#cb120-9" tabindex="-1"></a>                 <span class="at">clusters =</span> municipio)</span>
<span id="cb120-10"><a href="diferença-em-diferenças.html#cb120-10" tabindex="-1"></a><span class="fu">msummary</span>(did, <span class="at">stars =</span> <span class="fu">c</span>(<span class="st">&#39;*&#39;</span> <span class="ot">=</span> .<span class="dv">1</span>, <span class="st">&#39;**&#39;</span> <span class="ot">=</span> .<span class="dv">05</span>, <span class="st">&#39;***&#39;</span> <span class="ot">=</span> .<span class="dv">01</span>))</span></code></pre></div>
<!-- preamble start -->

    <script>

      function styleCell_u54u0e0nvlmv3mcqnajp(i, j, css_id) {
          var table = document.getElementById("tinytable_u54u0e0nvlmv3mcqnajp");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_u54u0e0nvlmv3mcqnajp');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_u54u0e0nvlmv3mcqnajp(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_u54u0e0nvlmv3mcqnajp");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 15, j: 1 },  ], css_id: 'tinytable_css_83y0azwaq1kosw772g9g',}, 
          { positions: [ { i: 8, j: 1 },  ], css_id: 'tinytable_css_sn4wt5ll3o1wjtnt3dxi',}, 
          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 12, j: 1 }, { i: 9, j: 1 }, { i: 10, j: 1 }, { i: 11, j: 1 }, { i: 13, j: 1 }, { i: 14, j: 1 },  ], css_id: 'tinytable_css_shsz39eaqgv3b76e8r8j',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_y7cl39wqj5ihl6uljuee',}, 
          { positions: [ { i: 15, j: 0 },  ], css_id: 'tinytable_css_sjztzirheanz7xcfycup',}, 
          { positions: [ { i: 8, j: 0 },  ], css_id: 'tinytable_css_6hbkq0v7927dzdnq8b9d',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 12, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 }, { i: 13, j: 0 }, { i: 14, j: 0 },  ], css_id: 'tinytable_css_88tt0mwaj59p76ewsjxe',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_9yc4qux24a3bl91gv7ck',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_u54u0e0nvlmv3mcqnajp(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_83y0azwaq1kosw772g9g, .table th.tinytable_css_83y0azwaq1kosw772g9g { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_sn4wt5ll3o1wjtnt3dxi, .table th.tinytable_css_sn4wt5ll3o1wjtnt3dxi { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_shsz39eaqgv3b76e8r8j, .table th.tinytable_css_shsz39eaqgv3b76e8r8j { text-align: center; }
      .table td.tinytable_css_y7cl39wqj5ihl6uljuee, .table th.tinytable_css_y7cl39wqj5ihl6uljuee { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_sjztzirheanz7xcfycup, .table th.tinytable_css_sjztzirheanz7xcfycup { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_6hbkq0v7927dzdnq8b9d, .table th.tinytable_css_6hbkq0v7927dzdnq8b9d { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_88tt0mwaj59p76ewsjxe, .table th.tinytable_css_88tt0mwaj59p76ewsjxe { text-align: left; }
      .table td.tinytable_css_9yc4qux24a3bl91gv7ck, .table th.tinytable_css_9yc4qux24a3bl91gv7ck { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_u54u0e0nvlmv3mcqnajp" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing='true'>
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan='2'>* p < 0.1, ** p < 0.05, *** p < 0.01</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.382***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.014)</td>
                </tr>
                <tr>
                  <td>post</td>
                  <td>0.481***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.010)</td>
                </tr>
                <tr>
                  <td>group_treated</td>
                  <td>-0.224***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.057)</td>
                </tr>
                <tr>
                  <td>post × group_treated</td>
                  <td>0.155**</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.062)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>9020</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.258</td>
                </tr>
                <tr>
                  <td>R2 Adj.</td>
                  <td>0.258</td>
                </tr>
                <tr>
                  <td>AIC</td>
                  <td>9911.2</td>
                </tr>
                <tr>
                  <td>BIC</td>
                  <td>9946.8</td>
                </tr>
                <tr>
                  <td>RMSE</td>
                  <td>0.42</td>
                </tr>
                <tr>
                  <td>Std.Errors</td>
                  <td>by: municipio</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="diferença-em-diferenças.html#cb121-1" tabindex="-1"></a>did_alt <span class="ot">&lt;-</span> <span class="fu">feols</span>(concluida <span class="sc">~</span> post_treat<span class="sc">|</span> municipio <span class="sc">+</span> periodo,</span>
<span id="cb121-2"><a href="diferença-em-diferenças.html#cb121-2" tabindex="-1"></a>                              <span class="at">cluster =</span> <span class="st">&quot;municipio&quot;</span>,</span>
<span id="cb121-3"><a href="diferença-em-diferenças.html#cb121-3" tabindex="-1"></a>                              <span class="at">data =</span> data_ot_reg)</span>
<span id="cb121-4"><a href="diferença-em-diferenças.html#cb121-4" tabindex="-1"></a><span class="fu">summary</span>(did_alt)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: concluida
## Observations: 9,020
## Fixed-effects: municipio: 2,020,  periodo: 2
## Standard-errors: Clustered (municipio) 
##            Estimate Std. Error t value  Pr(&gt;|t|)    
## post_treat  0.15401   0.059179 2.60247 0.0093232 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 0.338161     Adj. R2: 0.376909
##                  Within R2: 0.002425</code></pre>
</div>
<div id="múltiplos-períodos" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Múltiplos períodos<a href="diferença-em-diferenças.html#múltiplos-períodos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O que acontece se tivermos múltiplos períodos, isto é, <span class="math inline">\(t&gt;2\)</span>?</p>
<ol style="list-style-type: decimal">
<li><p>Múltiplos períodos antes do tratamento ser implementado</p></li>
<li><p>Múltiplos períodos após o tratamento ser implementado.
Precisamos escolher um período de comparação, <span class="math inline">\(t_0\)</span>.</p></li>
</ol>
<p>Nos últimos 10 anos, uma grande problematização e desenvolvimento de testes ,estimadores e entendimento do que é DiD com múltiplos períodos. Impossível cobrir tudo em uma única aula. Recomendo as vídeo-aulas do <a href="https://www.youtube.com/playlist?list=PLVObvb_htcuBt8mV9yNagt7hK9FL5KXeE">grupo de estudo em DiD</a>.</p>
</div>
<div id="tendências-paralelas" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Tendências Paralelas<a href="diferença-em-diferenças.html#tendências-paralelas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A suposição de tendências paralelas significa que <span class="math inline">\(\mathbb{E}[[Y_{i,t}(0) − Y_{g,t−1}(0)]\)</span> não varia entre grupos <span class="math inline">\(g\)</span>. Essa suposição implica que os nunca-tratados seguem um modelo de efeitos fixos duplo (Two-way fixed effects ou TWFE):</p>
<p><span class="math display">\[
\mathbb{E}[Y_{g,t}(0)] = \alpha_i + \lambda_t
\]</span>
Uma outra forma de escrever essa suposição é:
<span class="math display">\[
Y_{g,t}(0) = \alpha_i + \lambda_t + e_{it} \text{, com } \mathbb{E}[e_{it}] = 0
\]</span>
Demonstrar equivalência é demonstrar que um implica o outro. Vamos começar mostrando que TWFE implica PT.</p>
<p>Supondo que TWFE é verdade, então <span class="math inline">\(\mathbb{E}[[Y_{i,t}(0) − Y_{g,t−1}(0)] = \alpha_i + \lambda_t - (\alpha_i + \lambda_{t-1}) = \lambda_t - \lambda_{t-1})\)</span>, para todo <span class="math inline">\(g\)</span>. Como a diferença no tempo <span class="math inline">\(\lambda_t - \lambda_{t-1})\)</span> não depende de <span class="math inline">\(g\)</span>, então a PT é satisfeita.</p>
<p>Vamos agora mostrar a otra implicação. Sem perda de generalidade, defina <span class="math inline">\(\lambda_1 = 0\)</span>, isto é, o efeito do período 1 é 0. Poderia ser qualquer outro valor, mas zero vai facilitar. E vamos definir <span class="math inline">\(\alpha_g = \mathbb{E}[Y_{g,1}0]\)</span>, ou seja,</p>
<p>Se as tendências não forem exatamente paralelas, Rambachan e Roth (2023) desenvolveram uma forma de impor restrições sobre quão diferentes as tendências podem não ser paralelas pós-tratamento em comparação com o período pré-tratamento. O pacote no R honestDiD permite implementar isso. Assim conseguimos obter identificação parcial (intervalo para as estimativas), em vez de estimação pontual. O parâmetro M controla quanto o desvio é maior em relação ao observado no pré-teste. Se M é igual a 1, temos o mesmo desvio no máximo. Se M igual a 2, duas vezes maior e assim por diante.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="diferença-em-diferenças.html#cb123-1" tabindex="-1"></a><span class="fu">library</span>(HonestDiD)</span>
<span id="cb123-2"><a href="diferença-em-diferenças.html#cb123-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb123-3"><a href="diferença-em-diferenças.html#cb123-3" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb123-4"><a href="diferença-em-diferenças.html#cb123-4" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb123-5"><a href="diferença-em-diferenças.html#cb123-5" tabindex="-1"></a></span>
<span id="cb123-6"><a href="diferença-em-diferenças.html#cb123-6" tabindex="-1"></a><span class="co"># Install remotes package if not installed</span></span>
<span id="cb123-7"><a href="diferença-em-diferenças.html#cb123-7" tabindex="-1"></a><span class="co">#install.packages(&quot;remotes&quot;)</span></span>
<span id="cb123-8"><a href="diferença-em-diferenças.html#cb123-8" tabindex="-1"></a></span>
<span id="cb123-9"><a href="diferença-em-diferenças.html#cb123-9" tabindex="-1"></a><span class="co"># Turn off warning-error-conversion, because the tiniest warning stops installation</span></span>
<span id="cb123-10"><a href="diferença-em-diferenças.html#cb123-10" tabindex="-1"></a><span class="co">#Sys.setenv(&quot;R_REMOTES_NO_ERRORS_FROM_WARNINGS&quot; = &quot;true&quot;)</span></span>
<span id="cb123-11"><a href="diferença-em-diferenças.html#cb123-11" tabindex="-1"></a></span>
<span id="cb123-12"><a href="diferença-em-diferenças.html#cb123-12" tabindex="-1"></a><span class="co"># install from github</span></span>
<span id="cb123-13"><a href="diferença-em-diferenças.html#cb123-13" tabindex="-1"></a><span class="co">#remotes::install_github(&quot;asheshrambachan/HonestDiD&quot;)</span></span>
<span id="cb123-14"><a href="diferença-em-diferenças.html#cb123-14" tabindex="-1"></a></span>
<span id="cb123-15"><a href="diferença-em-diferenças.html#cb123-15" tabindex="-1"></a></span>
<span id="cb123-16"><a href="diferença-em-diferenças.html#cb123-16" tabindex="-1"></a><span class="co"># Run model</span></span>
<span id="cb123-17"><a href="diferença-em-diferenças.html#cb123-17" tabindex="-1"></a><span class="co"># twfe_results &lt;- feols(rating ~ i(goodr, qa) | year_month + asin,</span></span>
<span id="cb123-18"><a href="diferença-em-diferenças.html#cb123-18" tabindex="-1"></a><span class="co">#                 cluster = c(&quot;asin&quot;),</span></span>
<span id="cb123-19"><a href="diferença-em-diferenças.html#cb123-19" tabindex="-1"></a><span class="co">#                 data = GoodAma)</span></span>
<span id="cb123-20"><a href="diferença-em-diferenças.html#cb123-20" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-21"><a href="diferença-em-diferenças.html#cb123-21" tabindex="-1"></a><span class="co"># fixest::iplot(twfe_results)</span></span>
<span id="cb123-22"><a href="diferença-em-diferenças.html#cb123-22" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-23"><a href="diferença-em-diferenças.html#cb123-23" tabindex="-1"></a><span class="co"># # Save coefficients</span></span>
<span id="cb123-24"><a href="diferença-em-diferenças.html#cb123-24" tabindex="-1"></a><span class="co"># betahat &lt;- summary(model_4)$coefficients</span></span>
<span id="cb123-25"><a href="diferença-em-diferenças.html#cb123-25" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-26"><a href="diferença-em-diferenças.html#cb123-26" tabindex="-1"></a><span class="co"># # Save the covariance matrix</span></span>
<span id="cb123-27"><a href="diferença-em-diferenças.html#cb123-27" tabindex="-1"></a><span class="co"># sigma &lt;- summary(model_4)$cov.scaled</span></span>
<span id="cb123-28"><a href="diferença-em-diferenças.html#cb123-28" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-29"><a href="diferença-em-diferenças.html#cb123-29" tabindex="-1"></a><span class="co"># ## Identificação Parcial</span></span>
<span id="cb123-30"><a href="diferença-em-diferenças.html#cb123-30" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-31"><a href="diferença-em-diferenças.html#cb123-31" tabindex="-1"></a><span class="co"># delta_rm_results &lt;- createSensitivityResults_relativeMagnitudes(</span></span>
<span id="cb123-32"><a href="diferença-em-diferenças.html#cb123-32" tabindex="-1"></a><span class="co">#     betahat = betahat, #coefficients</span></span>
<span id="cb123-33"><a href="diferença-em-diferenças.html#cb123-33" tabindex="-1"></a><span class="co">#     sigma = sigma, #covariance matrix</span></span>
<span id="cb123-34"><a href="diferença-em-diferenças.html#cb123-34" tabindex="-1"></a><span class="co">#     numPrePeriods = 1, #num. of pre-treatment coefs</span></span>
<span id="cb123-35"><a href="diferença-em-diferenças.html#cb123-35" tabindex="-1"></a><span class="co">#     numPostPeriods = 1, #num. of post-treatment coefs</span></span>
<span id="cb123-36"><a href="diferença-em-diferenças.html#cb123-36" tabindex="-1"></a><span class="co">#     Mbarvec = seq(0.5,2,by=0.5) #values of Mbar</span></span>
<span id="cb123-37"><a href="diferença-em-diferenças.html#cb123-37" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb123-38"><a href="diferença-em-diferenças.html#cb123-38" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-39"><a href="diferença-em-diferenças.html#cb123-39" tabindex="-1"></a><span class="co"># delta_rm_results %&gt;%</span></span>
<span id="cb123-40"><a href="diferença-em-diferenças.html#cb123-40" tabindex="-1"></a><span class="co">#   kable()</span></span></code></pre></div>
</div>
<div id="múltiplos-períodos-pós-tratamento" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Múltiplos períodos pós-tratamento<a href="diferença-em-diferenças.html#múltiplos-períodos-pós-tratamento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Provavelmente, <span class="math inline">\(\tau\)</span> não é constante no tempo e entre unidades. Efeito do tratamento pode depender de quando começou. Pode depender da duração. Precisamos de um modelo mais sofisticado de regressão. O modelo que fizemos estima uma média dos efeitos. É preciso ter cuidado, pois se a amostra não for completa (não-balanceada), pode gerar problemas.</p>
<p>A primeira extensão do modelo é considerar um did dinâmico. Como fazemos isso?</p>
<p><span class="math display">\[
Y_{g,t} = \alpha_i + \lambda_t + \sum_{t=1, t \neq t_0}^T \delta_t D_{gt} + e_{gt}
\]</span>
Essa equação toma como referência o período <span class="math inline">\(t_0\)</span>, em que o tratamento foi implementado (para todas as unidades tratadas) ao mesmo tempo.</p>
<p>Um dos coeficientes é não identificado por causa do <span class="math inline">\(\alpha_i\)</span>, por isso precisamos excluir um período como categoria de referência.
E todos os coeficientes medem o efeito relativo ao período <span class="math inline">\(t_0\)</span> de referência.</p>
<p>Suposição de PT foi mais forte no modelo acima: <span class="math inline">\(Y_{g,t}(d) - Y_{g,t-k}(d) = \lambda_t - \lambda_{t-k}\)</span> para todos os <span class="math inline">\(k\)</span> e <span class="math inline">\(d\)</span>.</p>
<p>Podemos testar pré-tratamento.</p>
</div>
<div id="análise-de-sensibilidade-em-did" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Análise de sensibilidade em DiD<a href="diferença-em-diferenças.html#análise-de-sensibilidade-em-did" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
y_{gt} = \alpha_g + \lambda_t + \tau_{gt}D_{it} + e_{gt}
\]</span></p>
<p>Podemos pensar que o <span class="math inline">\(\tau\)</span> é a média dos <span class="math inline">\(\tau_{gt}\)</span>. Veja que se nós pudéssemos reescrever a equação de regressão como
<span class="math inline">\(y_{gt} -\alpha_g - \lambda_t =  \tau_{gt}D_{it} + e_{gt}\)</span>, bastaria rodar um modelo de OLS tradicional e estimar essa média. Nossa vd seria <span class="math inline">\(y_{gt} -\alpha_g - \lambda_t\)</span> e o tratamento uma variável binária indicando se o tratamento ocorreu.
Acontece que não sabemos os efeitos fixos. E se nós estimarmos eles? Utilizando o torema FWL, temos:</p>
<p>Primeiro, extraio os resíduos de uma regressão apenas com os efeitos fixos:
<span class="math display">\[
y_{gt} = \alpha_g + \lambda_t + \text{resíduos}_Y
\]</span>
Se chamar os resíduos de <span class="math inline">\(\tilde{y}_{gt}\)</span>, tenho tudo de <span class="math inline">\(y_{gt}\)</span> que não é explicado pelos efeitos fixos. E posso reescrever: <span class="math inline">\(y_{gt} = \alpha_g + \lambda_t + \text{resíduos}_Y\)</span> como <span class="math inline">\(\tilde{y}_{gt} = y_{gt} -\alpha_g - \lambda_t\)</span>.</p>
<p>Em seguida, residualizo o tratamento:
<span class="math display">\[
D_{gt} = \alpha_g + \lambda_t + \text{resíduos}_D
\]</span>
Novamente, vou chamar os resíduos de <span class="math inline">\(\tilde{D}_{gt}\)</span></p>
<p>Então, posso rodar uma regressão <span class="math inline">\(\tilde{y}_{gt} = \tilde{D}_{gt} + e_{gt}\)</span>. Ou ainda:</p>
<p><span class="math display">\[
y_{gt} - \tilde{\alpha}_g - \tilde{\lambda}_t = \tau_{gt}\tilde{D}_{it} + e_{gt}
\]</span>
Essa regressão estima <span class="math inline">\(\hat{\tau} = \sum w_{gt}\tau_{gt} \neq \tau\)</span>.</p>
<p>Esses pesos podem até mesm oser negartivos e a estimativa <span class="math inline">\(\hat{\tau}\)</span> ter sinal oposto a <span class="math inline">\(\tau\)</span>. A intuição é porque estamos comparando bananas com laranjas. Há grupos que são tratados em momentos distintos, e dependendo do tamanho dos efeitos em cada momento do tempo, a média ponderada dessas comparações dá algo estranho.</p>
<p>A solução proposta do Gardner de regressão DiD em dois estágios é justamente evitar esse problema rodando <span class="math inline">\(y_{gt} - \tilde{\alpha}_g - \tilde{\lambda}_t = \tau_{gt}D_{it} + e_{gt}\)</span>.</p>
<p>Estágio 1: Estime os efeitos fixos usando observações não tratadas ou ainda não tratadas.</p>
<p>Estágio 2. Rode a regressão <span class="math inline">\(y_{gt} - \tilde{\alpha}_g - \tilde{\lambda}_t = \tau_{gt}D_{it} + e_{gt}\)</span>.</p>
<p>Obviamente, o cálculo do erro padrão se torna mais complexo nesse caso, pois há ruído extra introduzido na nova VD. Felizmente, o pacote {did2s} faz tudo isso pra gente.</p>
<p>Se você olhar os papers mais recentes publicados nos top journals, eles estão usando esse tipo de estimador.</p>
</div>
<div id="did-generalizado" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> DiD generalizado<a href="diferença-em-diferenças.html#did-generalizado" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nós permitimos que cada unidade, por exemplo, tenha sua própria tendência. Ou que o resultado potencial do controle (não-tratado) dependa de covariáveis que variam no tempo, ou seja, a tendência paralela é condicional às covariáveis.
A única coisa não permitida é interação entre efeitos fixos de unidade e tempo.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="diferença-em-diferenças.html#cb124-1" tabindex="-1"></a>did_din <span class="ot">=</span> <span class="fu">feols</span>(concluida <span class="sc">~</span> <span class="fu">i</span>(periodo, group_treated, <span class="at">ref=</span><span class="dv">3</span>) <span class="sc">|</span> id <span class="sc">+</span> periodo, data_ot)</span>
<span id="cb124-2"><a href="diferença-em-diferenças.html#cb124-2" tabindex="-1"></a></span>
<span id="cb124-3"><a href="diferença-em-diferenças.html#cb124-3" tabindex="-1"></a><span class="fu">summary</span>(did_din)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: concluida
## Observations: 22,609
## Fixed-effects: id: 4,530,  periodo: 5
## Standard-errors: Clustered (id) 
##                           Estimate Std. Error   t value   Pr(&gt;|t|)    
## periodo::1:group_treated -0.009828   0.028085 -0.349923 7.2641e-01    
## periodo::2:group_treated -0.004025   0.018226 -0.220847 8.2522e-01    
## periodo::4:group_treated  0.022207   0.015355  1.446207 1.4819e-01    
## periodo::5:group_treated  0.143744   0.033830  4.249033 2.1901e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 0.247446     Adj. R2: 0.685451
##                  Within R2: 0.002541</code></pre>
</div>
<div id="did-com-adoção-escalonada-staggered-timing" class="section level2 hasAnchor" number="8.10">
<h2><span class="header-section-number">8.10</span> DID com adoção escalonada (staggered timing)<a href="diferença-em-diferenças.html#did-com-adoção-escalonada-staggered-timing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No meu exemplo, tratamento foi o mesmo para todas as unidades ao mesmo tempo. Mas é comum que não aconteça assim.</p>
<ol style="list-style-type: decimal">
<li>Qual é o estimando quando tenho adoção escalonada no tempo? Com quem estou comparando?</li>
</ol>
<p>Digamos que quero ver o efeito da biometria sobre comparecimento eleitoral. Como ela foi escalonada no tempo, podemos adotar um modelo de DiD. Nesse caso, uma vez implementado (turned on), não volta atrás (turn off). Porém, há casos em que a política pode ser ativada ou desativada. Exemplo: política de uso de câmeras corporais pela política. Tarcísio desativou por um tempo (STF impediu). Isso cria complicações para definir o grupo de controle adequado.</p>
</div>
<div id="paper-voter-gratitude-last-long" class="section level2 hasAnchor" number="8.11">
<h2><span class="header-section-number">8.11</span> Paper Voter Gratitude Last Long?<a href="diferença-em-diferenças.html#paper-voter-gratitude-last-long" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="diferença-em-diferenças.html#cb126-1" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb126-2"><a href="diferença-em-diferenças.html#cb126-2" tabindex="-1"></a>elbe1994_98 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="fu">here</span>(<span class="st">&quot;Dados&quot;</span>, <span class="st">&quot;Elbe&quot;</span>, <span class="st">&quot;1994_1998.dta&quot;</span>)) </span>
<span id="cb126-3"><a href="diferença-em-diferenças.html#cb126-3" tabindex="-1"></a></span>
<span id="cb126-4"><a href="diferença-em-diferenças.html#cb126-4" tabindex="-1"></a>elbe0 <span class="ot">&lt;-</span> elbe1994_98 <span class="sc">%&gt;%</span></span>
<span id="cb126-5"><a href="diferença-em-diferenças.html#cb126-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(wkr, wkrname, year, spd_z_vs, Flooded)</span>
<span id="cb126-6"><a href="diferença-em-diferenças.html#cb126-6" tabindex="-1"></a></span>
<span id="cb126-7"><a href="diferença-em-diferenças.html#cb126-7" tabindex="-1"></a>elbe1998_02 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,  <span class="st">&quot;Elbe&quot;</span>, <span class="st">&quot;1998_2002.dta&quot;</span>))</span>
<span id="cb126-8"><a href="diferença-em-diferenças.html#cb126-8" tabindex="-1"></a></span>
<span id="cb126-9"><a href="diferença-em-diferenças.html#cb126-9" tabindex="-1"></a>elbe1 <span class="ot">&lt;-</span> elbe1998_02 <span class="sc">%&gt;%</span></span>
<span id="cb126-10"><a href="diferença-em-diferenças.html#cb126-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(wkr, wkrname, year, spd_z_vs, Flooded) <span class="sc">%&gt;%</span></span>
<span id="cb126-11"><a href="diferença-em-diferenças.html#cb126-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2002</span>) </span>
<span id="cb126-12"><a href="diferença-em-diferenças.html#cb126-12" tabindex="-1"></a></span>
<span id="cb126-13"><a href="diferença-em-diferenças.html#cb126-13" tabindex="-1"></a></span>
<span id="cb126-14"><a href="diferença-em-diferenças.html#cb126-14" tabindex="-1"></a>elbe1998_05 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,  <span class="st">&quot;Elbe&quot;</span>, <span class="st">&quot;1998_2005.dta&quot;</span>))</span>
<span id="cb126-15"><a href="diferença-em-diferenças.html#cb126-15" tabindex="-1"></a></span>
<span id="cb126-16"><a href="diferença-em-diferenças.html#cb126-16" tabindex="-1"></a>elbe2 <span class="ot">&lt;-</span> elbe1998_05 <span class="sc">%&gt;%</span></span>
<span id="cb126-17"><a href="diferença-em-diferenças.html#cb126-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2005</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-18"><a href="diferença-em-diferenças.html#cb126-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(wkr, wkrname, year, spd_z_vs, Flooded)</span>
<span id="cb126-19"><a href="diferença-em-diferenças.html#cb126-19" tabindex="-1"></a></span>
<span id="cb126-20"><a href="diferença-em-diferenças.html#cb126-20" tabindex="-1"></a>elbe <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(elbe0, elbe1, elbe2)</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="diferença-em-diferenças.html#cb127-1" tabindex="-1"></a>did_short <span class="ot">&lt;-</span> <span class="fu">feols</span>(spd_z_vs <span class="sc">~</span> Flooded<span class="sc">|</span> wkr <span class="sc">+</span> year,</span>
<span id="cb127-2"><a href="diferença-em-diferenças.html#cb127-2" tabindex="-1"></a>                 <span class="at">cluster =</span> <span class="st">&quot;wkr&quot;</span>,</span>
<span id="cb127-3"><a href="diferença-em-diferenças.html#cb127-3" tabindex="-1"></a>                 <span class="at">data =</span> elbe1998_02)</span>
<span id="cb127-4"><a href="diferença-em-diferenças.html#cb127-4" tabindex="-1"></a><span class="fu">summary</span>(did_short)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: spd_z_vs
## Observations: 598
## Fixed-effects: wkr: 299,  year: 2
## Standard-errors: Clustered (wkr) 
##         Estimate Std. Error t value  Pr(&gt;|t|)    
## Flooded  7.14401   0.468184  15.259 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 1.80615     Adj. R2: 0.905029
##                 Within R2: 0.255154</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="diferença-em-diferenças.html#cb129-1" tabindex="-1"></a>did_din <span class="ot">=</span> <span class="fu">feols</span>(spd_z_vs <span class="sc">~</span> <span class="fu">i</span>(year, Flooded, <span class="at">ref=</span><span class="dv">1998</span>) <span class="sc">|</span> wkr <span class="sc">+</span> year, elbe)</span>
<span id="cb129-2"><a href="diferença-em-diferenças.html#cb129-2" tabindex="-1"></a><span class="fu">summary</span>(did_din)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: spd_z_vs
## Observations: 1,254
## Fixed-effects: wkr: 328,  year: 4
## Standard-errors: Clustered (wkr) 
##                     Estimate Std. Error   t value  Pr(&gt;|t|)    
## year::2002:Flooded  0.458643    1.52364  0.301018 0.7635917    
## year::2005:Flooded -4.806790    1.34447 -3.575220 0.0004027 ***
## ... 1 variable was removed because of collinearity (year::1994:Flooded)
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 4.71647     Adj. R2: 0.591674
##                 Within R2: 0.017113</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="diferença-em-diferenças.html#cb131-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">RGL_USE_NULL =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-2"><a href="diferença-em-diferenças.html#cb131-2" tabindex="-1"></a><span class="fu">library</span>(DIDmultiplegtDYN)</span>
<span id="cb131-3"><a href="diferença-em-diferenças.html#cb131-3" tabindex="-1"></a></span>
<span id="cb131-4"><a href="diferença-em-diferenças.html#cb131-4" tabindex="-1"></a>elbe_het <span class="ot">&lt;-</span> elbe <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="diferença-em-diferenças.html#cb131-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Y =</span> spd_z_vs,</span>
<span id="cb131-6"><a href="diferença-em-diferenças.html#cb131-6" tabindex="-1"></a>         <span class="at">G =</span> wkr,</span>
<span id="cb131-7"><a href="diferença-em-diferenças.html#cb131-7" tabindex="-1"></a>         <span class="at">D =</span> Flooded,</span>
<span id="cb131-8"><a href="diferença-em-diferenças.html#cb131-8" tabindex="-1"></a>         <span class="at">T =</span> year)</span>
<span id="cb131-9"><a href="diferença-em-diferenças.html#cb131-9" tabindex="-1"></a></span>
<span id="cb131-10"><a href="diferença-em-diferenças.html#cb131-10" tabindex="-1"></a>did_het <span class="ot">&lt;-</span> <span class="fu">did_multiplegt_dyn</span>(</span>
<span id="cb131-11"><a href="diferença-em-diferenças.html#cb131-11" tabindex="-1"></a>    <span class="at">df =</span> elbe,</span>
<span id="cb131-12"><a href="diferença-em-diferenças.html#cb131-12" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="st">&quot;spd_z_vs&quot;</span>,</span>
<span id="cb131-13"><a href="diferença-em-diferenças.html#cb131-13" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">&quot;wkr&quot;</span>,</span>
<span id="cb131-14"><a href="diferença-em-diferenças.html#cb131-14" tabindex="-1"></a>    <span class="at">time =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb131-15"><a href="diferença-em-diferenças.html#cb131-15" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;Flooded&quot;</span>,</span>
<span id="cb131-16"><a href="diferença-em-diferenças.html#cb131-16" tabindex="-1"></a>    <span class="at">effects =</span> <span class="dv">2</span>,</span>
<span id="cb131-17"><a href="diferença-em-diferenças.html#cb131-17" tabindex="-1"></a>    <span class="at">placebo =</span> <span class="dv">2</span>,</span>
<span id="cb131-18"><a href="diferença-em-diferenças.html#cb131-18" tabindex="-1"></a>    <span class="at">cluster =</span> <span class="st">&quot;wkr&quot;</span></span>
<span id="cb131-19"><a href="diferença-em-diferenças.html#cb131-19" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/elbe-did-het-1.png" width="672" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="diferença-em-diferenças.html#cb132-1" tabindex="-1"></a><span class="fu">summary</span>(did_het)</span></code></pre></div>
<pre><code>## 
## ----------------------------------------------------------------------
##        Estimation of treatment effects: Event-study effects
## ----------------------------------------------------------------------
##              Estimate SE      LB CI    UB CI    N   Switchers
## Effect_1     0.20036  0.69213 -1.15620 1.55692  874 65       
## Effect_2     -3.75276 1.14577 -5.99843 -1.50709 557 40       
## 
## Test of joint nullity of the effects : p-value = 0.0000
## ----------------------------------------------------------------------
##     Average cumulative (total) effect per treatment unit
## ----------------------------------------------------------------------
##  Estimate        SE     LB CI     UB CI         N Switchers 
##  -1.47405   0.95447  -3.34478   0.39667       914       105 
## Average number of time periods over which a treatment effect is accumulated: 1.6882
## 
## ----------------------------------------------------------------------
##      Testing the parallel trends and no anticipation assumptions
## ----------------------------------------------------------------------
##  Estimate        SE     LB CI     UB CI         N Switchers 
##   0.37683   0.40786  -0.42256   1.17622       546        29 
## 
## 
## 
## 
## The development of this package was funded by the European Union.
## ERC REALLYCREDIBLE - GA N. 101043899</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="diferença-em-diferenças.html#cb134-1" tabindex="-1"></a>did_short <span class="ot">&lt;-</span> <span class="fu">feols</span>(spd_z_vs <span class="sc">~</span> Flooded<span class="sc">|</span> wkr <span class="sc">+</span> year,</span>
<span id="cb134-2"><a href="diferença-em-diferenças.html#cb134-2" tabindex="-1"></a>                 <span class="at">cluster =</span> <span class="st">&quot;wkr&quot;</span>,</span>
<span id="cb134-3"><a href="diferença-em-diferenças.html#cb134-3" tabindex="-1"></a>                 <span class="at">data =</span> elbe1998_02)</span>
<span id="cb134-4"><a href="diferença-em-diferenças.html#cb134-4" tabindex="-1"></a><span class="fu">summary</span>(did_short)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: spd_z_vs
## Observations: 598
## Fixed-effects: wkr: 299,  year: 2
## Standard-errors: Clustered (wkr) 
##         Estimate Std. Error t value  Pr(&gt;|t|)    
## Flooded  7.14401   0.468184  15.259 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 1.80615     Adj. R2: 0.905029
##                 Within R2: 0.255154</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="diferença-em-diferenças.html#cb136-1" tabindex="-1"></a>did_din <span class="ot">=</span> <span class="fu">feols</span>(spd_z_vs <span class="sc">~</span> <span class="fu">i</span>(year, Flooded, <span class="at">ref=</span><span class="dv">1998</span>) <span class="sc">|</span> wkr <span class="sc">+</span> year, elbe)</span>
<span id="cb136-2"><a href="diferença-em-diferenças.html#cb136-2" tabindex="-1"></a><span class="fu">summary</span>(did_din)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: spd_z_vs
## Observations: 1,254
## Fixed-effects: wkr: 328,  year: 4
## Standard-errors: Clustered (wkr) 
##                     Estimate Std. Error   t value  Pr(&gt;|t|)    
## year::2002:Flooded  0.458643    1.52364  0.301018 0.7635917    
## year::2005:Flooded -4.806790    1.34447 -3.575220 0.0004027 ***
## ... 1 variable was removed because of collinearity (year::1994:Flooded)
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 4.71647     Adj. R2: 0.591674
##                 Within R2: 0.017113</code></pre>
</div>
<div id="referências-5" class="section level2 hasAnchor" number="8.12">
<h2><span class="header-section-number">8.12</span> Referências<a href="diferença-em-diferenças.html#referências-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>de Chaisemartin, C., &amp; D’Haultfœuille, X. (2023). Credible answers to hard questions: Differences-in-differences for natural experiments. Available at SSRN.</p>
<p>Rambachan, A., &amp; Roth, J. (2023). A more credible approach to parallel trends. Review of Economic Studies, 90(5), 2555-2591.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="desenho-de-regresão-discontínua.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series-cross-section-tscs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mgaldino/Causalidade/edit/main/08-DiD.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mgaldino/Causalidade/blob/main/08-DiD.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
