<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Experimentos | Curso de Inferência Causal</title>
  <meta name="description" content="Capítulo 4 Experimentos | Curso de Inferência Causal" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Experimentos | Curso de Inferência Causal" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Experimentos | Curso de Inferência Causal" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2026-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dags.html"/>
<link rel="next" href="propensity-score-e-matching.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causalidade</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>1</b> Introdução</a>
<ul>
<li class="chapter" data-level="1.1" data-path="04-Experimentos.html"><a href="#revis%C3%A3o-de-regress%C3%A3o"><i class="fa fa-check"></i><b>1.1</b> Revisão de Regressão</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="04-Experimentos.html"><a href="#teorema-da-anatomia-da-regress%C3%A3o"><i class="fa fa-check"></i><b>1.1.1</b> Teorema da Anatomia da Regressão</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="04-Experimentos.html"><a href="#infer%C3%AAncia"><i class="fa fa-check"></i><b>1.2</b> Inferência</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="04-Experimentos.html"><a href="#generaliza%C3%A7%C3%A3o-amostral-vs.-generaliza%C3%A7%C3%A3o-causal"><i class="fa fa-check"></i><b>1.2.1</b> Generalização amostral vs. generalização causal</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1.2.2</b> Incerteza com o universo dos casos</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#validade-externa"><i class="fa fa-check"></i><b>1.2.3</b> Validade externa</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos"><i class="fa fa-check"></i><b>1.3</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="1.4" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias"><i class="fa fa-check"></i><b>1.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html"><i class="fa fa-check"></i><b>2</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="2.1" data-path="04-Experimentos.html"><a href="#da-intui%C3%A7%C3%A3o-comparativa-ao-modelo-formal"><i class="fa fa-check"></i><b>2.1</b> Da intuição comparativa ao modelo formal</a></li>
<li class="chapter" data-level="2.2" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#resultados-potenciais-potential-outcomes"><i class="fa fa-check"></i><b>2.2</b> Resultados Potenciais (<em>Potential Outcomes</em>)</a></li>
<li class="chapter" data-level="2.3" data-path="04-Experimentos.html"><a href="#nota%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.3</b> Notação</a></li>
<li class="chapter" data-level="2.4" data-path="04-Experimentos.html"><a href="#problema-fundamental-da-infer%C3%AAncia-causal"><i class="fa fa-check"></i><b>2.4</b> Problema Fundamental da Inferência Causal</a></li>
<li class="chapter" data-level="2.5" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#estimando"><i class="fa fa-check"></i><b>2.5</b> Estimando</a></li>
<li class="chapter" data-level="2.6" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#estimandos-mais-comuns"><i class="fa fa-check"></i><b>2.6</b> Estimandos Mais Comuns</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#ate"><i class="fa fa-check"></i><b>2.6.1</b> ATE</a></li>
<li class="chapter" data-level="2.6.2" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#att"><i class="fa fa-check"></i><b>2.6.2</b> ATT</a></li>
<li class="chapter" data-level="2.6.3" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#cate"><i class="fa fa-check"></i><b>2.6.3</b> CATE</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#nota-sobre-estimandos"><i class="fa fa-check"></i><b>2.7</b> Nota sobre estimandos</a></li>
<li class="chapter" data-level="2.8" data-path="04-Experimentos.html"><a href="#exerc%C3%ADcio---qual-o-estimando-e-o-estimador-se-poss%C3%ADvel"><i class="fa fa-check"></i><b>2.8</b> Exercício - Qual o estimando e o estimador (se possível)?</a></li>
<li class="chapter" data-level="2.9" data-path="04-Experimentos.html"><a href="#identifica%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.9</b> Identificação</a></li>
<li class="chapter" data-level="2.10" data-path="04-Experimentos.html"><a href="#identifica%C3%A7%C3%A3o-do-ate"><i class="fa fa-check"></i><b>2.10</b> Identificação do ATE</a></li>
<li class="chapter" data-level="2.11" data-path="04-Experimentos.html"><a href="#equa%C3%A7%C3%B5es-estruturais"><i class="fa fa-check"></i><b>2.11</b> Equações estruturais</a></li>
<li class="chapter" data-level="2.12" data-path="resultados-potenciais.html"><a href="resultados-potenciais.html#modelo-versus-desenho"><i class="fa fa-check"></i><b>2.12</b> Modelo versus Desenho</a></li>
<li class="chapter" data-level="2.13" data-path="04-Experimentos.html"><a href="#exerc%C3%ADcio-em-sala"><i class="fa fa-check"></i><b>2.13</b> Exercício em sala</a></li>
<li class="chapter" data-level="2.14" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos-1"><i class="fa fa-check"></i><b>2.14</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="2.15" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-1"><i class="fa fa-check"></i><b>2.15</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dags.html"><a href="dags.html"><i class="fa fa-check"></i><b>3</b> DAGs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dags.html"><a href="dags.html#causalidade"><i class="fa fa-check"></i><b>3.1</b> Causalidade</a></li>
<li class="chapter" data-level="3.2" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-1"><i class="fa fa-check"></i><b>3.2</b> Introdução</a></li>
<li class="chapter" data-level="3.3" data-path="04-Experimentos.html"><a href="#os-tipos-b%C3%A1sicos-de-dags"><i class="fa fa-check"></i><b>3.3</b> Os Tipos Básicos de DAGs</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dags.html"><a href="dags.html#chains"><i class="fa fa-check"></i><b>3.3.1</b> 1. Chains</a></li>
<li class="chapter" data-level="3.3.2" data-path="dags.html"><a href="dags.html#forks"><i class="fa fa-check"></i><b>3.3.2</b> 2. Forks</a></li>
<li class="chapter" data-level="3.3.3" data-path="dags.html"><a href="dags.html#colliders"><i class="fa fa-check"></i><b>3.3.3</b> 3. Colliders</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="04-Experimentos.html"><a href="#simula%C3%A7%C3%A3o-no-r-ilustrando-o-collider-bias"><i class="fa fa-check"></i><b>3.4</b> Simulação no R: Ilustrando o Collider Bias</a></li>
<li class="chapter" data-level="3.5" data-path="04-Experimentos.html"><a href="#defini%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>3.5</b> Definições</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="04-Experimentos.html"><a href="#rela%C3%A7%C3%B5es-entre-vari%C3%A1veis-n%C3%B3s"><i class="fa fa-check"></i><b>3.5.1</b> Relações entre Variáveis (nós):</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dags.html"><a href="dags.html#controle-e-ajuste"><i class="fa fa-check"></i><b>3.6</b> Controle e Ajuste</a></li>
<li class="chapter" data-level="3.7" data-path="04-Experimentos.html"><a href="#fatoriza%C3%A7%C3%A3o-da-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.7</b> Fatorização da Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.8" data-path="04-Experimentos.html"><a href="#fatoriza%C3%A7%C3%A3o-e-dags"><i class="fa fa-check"></i><b>3.8</b> Fatorização e DAGs</a></li>
<li class="chapter" data-level="3.9" data-path="04-Experimentos.html"><a href="#fatoriza%C3%A7%C3%A3o-dags-e-causalidade"><i class="fa fa-check"></i><b>3.9</b> Fatorização, DAGs e Causalidade</a></li>
<li class="chapter" data-level="3.10" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos-2"><i class="fa fa-check"></i><b>3.10</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="3.11" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-2"><i class="fa fa-check"></i><b>3.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="experimentos.html"><a href="experimentos.html"><i class="fa fa-check"></i><b>4</b> Experimentos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-2"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="04-Experimentos.html"><a href="#experimentos-aleat%C3%B3rios"><i class="fa fa-check"></i><b>4.2</b> Experimentos aleatórios</a></li>
<li class="chapter" data-level="4.3" data-path="04-Experimentos.html"><a href="#restri%C3%A7%C3%A3o-de-exclus%C3%A3o"><i class="fa fa-check"></i><b>4.3</b> Restrição de Exclusão</a></li>
<li class="chapter" data-level="4.4" data-path="experimentos.html"><a href="experimentos.html#tipos-de-experimentos"><i class="fa fa-check"></i><b>4.4</b> Tipos de experimentos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="04-Experimentos.html"><a href="#aleatoriza%C3%A7%C3%A3o-de-bernoulli"><i class="fa fa-check"></i><b>4.4.1</b> Aleatorização de Bernoulli</a></li>
<li class="chapter" data-level="4.4.2" data-path="04-Experimentos.html"><a href="#aleatoriza%C3%A7%C3%A3o-completa"><i class="fa fa-check"></i><b>4.4.2</b> Aleatorização Completa</a></li>
<li class="chapter" data-level="4.4.3" data-path="04-Experimentos.html"><a href="#aleatoriza%C3%A7%C3%A3o-condicional-block-random-assignment"><i class="fa fa-check"></i><b>4.4.3</b> Aleatorização Condicional (Block Random Assignment)</a></li>
<li class="chapter" data-level="4.4.4" data-path="04-Experimentos.html"><a href="#pensando-aleatoriza%C3%A7%C3%A3o-em-bloco"><i class="fa fa-check"></i><b>4.4.4</b> Pensando aleatorização em bloco</a></li>
<li class="chapter" data-level="4.4.5" data-path="04-Experimentos.html"><a href="#ate-com-aleatoriza%C3%A7%C3%A3o-condicional-bloco"><i class="fa fa-check"></i><b>4.4.5</b> ATE com Aleatorização Condicional (Bloco)</a></li>
<li class="chapter" data-level="4.4.6" data-path="04-Experimentos.html"><a href="#aleatoriza%C3%A7%C3%A3o-em-bloco"><i class="fa fa-check"></i><b>4.4.6</b> Aleatorização em bloco</a></li>
<li class="chapter" data-level="4.4.7" data-path="04-Experimentos.html"><a href="#precis%C3%A3o-da-aleatoriza%C3%A7%C3%A3o-em-bloco"><i class="fa fa-check"></i><b>4.4.7</b> Precisão da aleatorização em bloco</a></li>
<li class="chapter" data-level="4.4.8" data-path="04-Experimentos.html"><a href="#compara%C3%A7%C3%A3o-de-ses"><i class="fa fa-check"></i><b>4.4.8</b> Comparação de SEs</a></li>
<li class="chapter" data-level="4.4.9" data-path="experimentos.html"><a href="experimentos.html#cluster-randomization"><i class="fa fa-check"></i><b>4.4.9</b> Cluster randomization</a></li>
<li class="chapter" data-level="4.4.10" data-path="experimentos.html"><a href="experimentos.html#tabelas-em-artigos"><i class="fa fa-check"></i><b>4.4.10</b> Tabelas em artigos</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="experimentos.html"><a href="experimentos.html#estimador-ate"><i class="fa fa-check"></i><b>4.5</b> Estimador ATE</a></li>
<li class="chapter" data-level="4.6" data-path="04-Experimentos.html"><a href="#resumo-do-cap%C3%ADtulo"><i class="fa fa-check"></i><b>4.6</b> Resumo do Capítulo</a></li>
<li class="chapter" data-level="4.7" data-path="experimentos.html"><a href="experimentos.html#declare-design"><i class="fa fa-check"></i><b>4.7</b> Declare Design</a></li>
<li class="chapter" data-level="4.8" data-path="04-Experimentos.html"><a href="#exerc%C3%ADcio"><i class="fa fa-check"></i><b>4.8</b> Exercício</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="04-Experimentos.html"><a href="#experimento-com-envio-de-cart%C3%B5es-postais-e-participa%C3%A7%C3%A3o-eleitoral"><i class="fa fa-check"></i><b>4.8.1</b> Experimento com envio de cartões-postais e participação eleitoral</a></li>
<li class="chapter" data-level="4.8.2" data-path="04-Experimentos.html"><a href="#experimento-com-an%C3%BAncios-de-tv-e-participa%C3%A7%C3%A3o-eleitoral"><i class="fa fa-check"></i><b>4.8.2</b> Experimento com anúncios de TV e participação eleitoral</a></li>
<li class="chapter" data-level="4.8.3" data-path="04-Experimentos.html"><a href="#exclus%C3%A3o-de-participantes-em-experimentos-de-survey"><i class="fa fa-check"></i><b>4.8.3</b> Exclusão de participantes em experimentos de survey</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html"><i class="fa fa-check"></i><b>5</b> Propensity Score e Matching</a>
<ul>
<li class="chapter" data-level="5.1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-3"><i class="fa fa-check"></i><b>5.1</b> Introdução</a></li>
<li class="chapter" data-level="5.2" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#propensity-score"><i class="fa fa-check"></i><b>5.2</b> Propensity Score</a></li>
<li class="chapter" data-level="5.3" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching"><i class="fa fa-check"></i><b>5.3</b> Matching</a></li>
<li class="chapter" data-level="5.4" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%B5es-de-identifica%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>5.4</b> Suposições de identificação</a></li>
<li class="chapter" data-level="5.5" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-1"><i class="fa fa-check"></i><b>5.5</b> Matching</a></li>
<li class="chapter" data-level="5.6" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-exato"><i class="fa fa-check"></i><b>5.6</b> Matching exato</a></li>
<li class="chapter" data-level="5.7" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-aproximado"><i class="fa fa-check"></i><b>5.7</b> Matching aproximado</a></li>
<li class="chapter" data-level="5.8" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#estimando-1"><i class="fa fa-check"></i><b>5.8</b> Estimando</a></li>
<li class="chapter" data-level="5.9" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#declare-design-e-matching"><i class="fa fa-check"></i><b>5.9</b> Declare Design e Matching</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="propensity-score-e-matching.html"><a href="propensity-score-e-matching.html#matching-e-propensity-scores"><i class="fa fa-check"></i><b>5.9.1</b> Matching e Propensity scores</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="04-Experimentos.html"><a href="#recomenda%C3%A7%C3%B5es-pr%C3%A1ticas-sobre-matching"><i class="fa fa-check"></i><b>5.10</b> Recomendações Práticas sobre Matching</a></li>
<li class="chapter" data-level="5.11" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-3"><i class="fa fa-check"></i><b>5.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="04-Experimentos.html"><a href="#vari%C3%A1veis-instrumentais"><i class="fa fa-check"></i><b>6</b> Variáveis Instrumentais</a>
<ul>
<li class="chapter" data-level="6.1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-4"><i class="fa fa-check"></i><b>6.1</b> Introdução</a></li>
<li class="chapter" data-level="6.2" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html"><i class="fa fa-check"></i><b>6.2</b> IV com modelo estrutural</a></li>
<li class="chapter" data-level="6.3" data-path="04-Experimentos.html"><a href="#mqo-em-2-est%C3%A1gios"><i class="fa fa-check"></i><b>6.3</b> MQO em 2 Estágios</a></li>
<li class="chapter" data-level="6.4" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#principais-usos-de-iv"><i class="fa fa-check"></i><b>6.4</b> Principais usos de IV</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#experimentos-1"><i class="fa fa-check"></i><b>6.4.1</b> Experimentos</a></li>
<li class="chapter" data-level="6.4.2" data-path="04-Experimentos.html"><a href="#regras-com-varia%C3%A7%C3%A3o-quasi-aleat%C3%B3ria"><i class="fa fa-check"></i><b>6.4.2</b> Regras com variação quasi-aleatória</a></li>
<li class="chapter" data-level="6.4.3" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#teoria"><i class="fa fa-check"></i><b>6.4.3</b> Teoria</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="04-Experimentos.html"><a href="#efeito-heterog%C3%AAneo"><i class="fa fa-check"></i><b>6.5</b> Efeito heterogêneo</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%B5es-para-estimar-o-late"><i class="fa fa-check"></i><b>6.5.1</b> Suposições para estimar o LATE</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="04-Experimentos.html"><a href="#restri%C3%A7%C3%A3o-de-exclus%C3%A3o-1"><i class="fa fa-check"></i><b>6.6</b> Restrição de Exclusão</a></li>
<li class="chapter" data-level="6.7" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#monotonicidade"><i class="fa fa-check"></i><b>6.7</b> Monotonicidade</a></li>
<li class="chapter" data-level="6.8" data-path="04-Experimentos.html"><a href="#estima%C3%A7%C3%A3o-aka-estat%C3%ADstica-f"><i class="fa fa-check"></i><b>6.8</b> Estimação (aka estatística F)</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="variáveis-instrumentais.html"><a href="variáveis-instrumentais.html#f-stat"><i class="fa fa-check"></i><b>6.8.1</b> F stat</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos-3"><i class="fa fa-check"></i><b>6.9</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="6.10" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-4"><i class="fa fa-check"></i><b>6.10</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="04-Experimentos.html"><a href="#desenho-de-regress%C3%A3o-descont%C3%ADnua"><i class="fa fa-check"></i><b>7</b> Desenho de Regressão Descontínua</a>
<ul>
<li class="chapter" data-level="7.1" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html"><i class="fa fa-check"></i><b>7.1</b> Outline da aula</a></li>
<li class="chapter" data-level="7.2" data-path="04-Experimentos.html"><a href="#caracter%C3%ADsticas-chave-da-rdd"><i class="fa fa-check"></i><b>7.2</b> Características-chave da RDD</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="04-Experimentos.html"><a href="#determina%C3%A7%C3%A3o-do-tratamento"><i class="fa fa-check"></i><b>7.2.1</b> Determinação do Tratamento</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#fuzzy-rdd"><i class="fa fa-check"></i><b>7.3</b> Fuzzy RDD</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="04-Experimentos.html"><a href="#observa%C3%A7%C3%A3o-e-corte"><i class="fa fa-check"></i><b>7.3.1</b> Observação e Corte</a></li>
<li class="chapter" data-level="7.3.2" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#estimativa-dos-efeitos-do-tratamento"><i class="fa fa-check"></i><b>7.3.2</b> Estimativa dos Efeitos do Tratamento</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%A3o-de-continuidade"><i class="fa fa-check"></i><b>7.4</b> Suposição de continuidade</a></li>
<li class="chapter" data-level="7.5" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%B5es-na-rdd"><i class="fa fa-check"></i><b>7.5</b> Suposições na RDD</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%A3o-de-n%C3%A3o-manipula%C3%A7%C3%A3o-com-precis%C3%A3o"><i class="fa fa-check"></i><b>7.5.1</b> Suposição de Não-manipulação com Precisão</a></li>
<li class="chapter" data-level="7.5.2" data-path="04-Experimentos.html"><a href="#problemas-de-manipula%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7.5.2</b> Problemas de Manipulação</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="04-Experimentos.html"><a href="#testabilidade-da-suposi%C3%A7%C3%A3o-de-n%C3%A3o-manipula%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7.6</b> Testabilidade da Suposição de não-Manipulação</a></li>
<li class="chapter" data-level="7.7" data-path="04-Experimentos.html"><a href="#estima%C3%A7%C3%A3o-em-rdd"><i class="fa fa-check"></i><b>7.7</b> Estimação em RDD</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#problema-de-complete-overlapping"><i class="fa fa-check"></i><b>7.7.1</b> Problema de Complete Overlapping</a></li>
<li class="chapter" data-level="7.7.2" data-path="04-Experimentos.html"><a href="#depend%C3%AAncia-de-extrapola%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7.7.2</b> Dependência de Extrapolação</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="04-Experimentos.html"><a href="#m%C3%A9todos-de-estima%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7.8</b> Métodos de Estimação</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="04-Experimentos.html"><a href="#identifica%C3%A7%C3%A3o-no-limite"><i class="fa fa-check"></i><b>7.8.1</b> Identificação no Limite</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="04-Experimentos.html"><a href="#trade-off-de-vi%C3%A9s-vari%C3%A2ncia"><i class="fa fa-check"></i><b>7.9</b> Trade-off de Viés-Variância</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="04-Experimentos.html"><a href="#m%C3%A9todos-de-largura-de-banda-%C3%B3tima"><i class="fa fa-check"></i><b>7.9.1</b> Métodos de Largura de Banda Ótima</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="04-Experimentos.html"><a href="#regras-arbitr%C3%A1rias"><i class="fa fa-check"></i><b>7.10</b> Regras arbitrárias</a></li>
<li class="chapter" data-level="7.11" data-path="04-Experimentos.html"><a href="#simula%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7.11</b> Simulação</a></li>
<li class="chapter" data-level="7.12" data-path="04-Experimentos.html"><a href="#simula%C3%A7%C3%A3o---potential-outcomes-y0"><i class="fa fa-check"></i><b>7.12</b> Simulação - Potential Outcomes Y0</a></li>
<li class="chapter" data-level="7.13" data-path="04-Experimentos.html"><a href="#simula%C3%A7%C3%A3o---potential-outcomes-y1"><i class="fa fa-check"></i><b>7.13</b> Simulação - Potential Outcomes Y1</a></li>
<li class="chapter" data-level="7.14" data-path="04-Experimentos.html"><a href="#simula%C3%A7%C3%A3o---potential-outcomes-y1-e-y0"><i class="fa fa-check"></i><b>7.14</b> Simulação - Potential Outcomes Y1 e Y0</a></li>
<li class="chapter" data-level="7.15" data-path="04-Experimentos.html"><a href="#simula%C3%A7%C3%A3o---y-observado"><i class="fa fa-check"></i><b>7.15</b> Simulação - Y observado</a></li>
<li class="chapter" data-level="7.16" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#quando-o-rdd-funciona"><i class="fa fa-check"></i><b>7.16</b> Quando o RDD funciona?</a></li>
<li class="chapter" data-level="7.17" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#raw-data-versus-bin"><i class="fa fa-check"></i><b>7.17</b> Raw Data versus Bin</a></li>
<li class="chapter" data-level="7.18" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#permutation-tests-balancing"><i class="fa fa-check"></i><b>7.18</b> Permutation tests (balancing)</a></li>
<li class="chapter" data-level="7.19" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#mccrary-test"><i class="fa fa-check"></i><b>7.19</b> McCrary test</a></li>
<li class="chapter" data-level="7.20" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#robustez"><i class="fa fa-check"></i><b>7.20</b> Robustez</a></li>
<li class="chapter" data-level="7.21" data-path="04-Experimentos.html"><a href="#densidade-descont%C3%ADnua---results"><i class="fa fa-check"></i><b>7.21</b> Densidade descontínua - results</a></li>
<li class="chapter" data-level="7.22" data-path="04-Experimentos.html"><a href="#regress%C3%A3o-rdd"><i class="fa fa-check"></i><b>7.22</b> Regressão RDD</a></li>
<li class="chapter" data-level="7.23" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#placebo-tests"><i class="fa fa-check"></i><b>7.23</b> Placebo Tests</a></li>
<li class="chapter" data-level="7.24" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#pcrd"><i class="fa fa-check"></i><b>7.24</b> PCRD</a></li>
<li class="chapter" data-level="7.25" data-path="desenho-de-regressão-descontínua.html"><a href="desenho-de-regressão-descontínua.html#checklist-para-um-paper-de-rdd"><i class="fa fa-check"></i><b>7.25</b> Checklist para um paper de RDD</a></li>
<li class="chapter" data-level="7.26" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-5"><i class="fa fa-check"></i><b>7.26</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="04-Experimentos.html"><a href="#diferen%C3%A7a-em-diferen%C3%A7as"><i class="fa fa-check"></i><b>8</b> Diferença em Diferenças</a>
<ul>
<li class="chapter" data-level="8.1" data-path="04-Experimentos.html"><a href="#modelo-b%C3%A1sico-2x2"><i class="fa fa-check"></i><b>8.1</b> Modelo básico 2x2</a></li>
<li class="chapter" data-level="8.2" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html"><i class="fa fa-check"></i><b>8.2</b> TWFE</a></li>
<li class="chapter" data-level="8.3" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#pressupostos"><i class="fa fa-check"></i><b>8.3</b> Pressupostos</a></li>
<li class="chapter" data-level="8.4" data-path="04-Experimentos.html"><a href="#aplica%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>8.4</b> Aplicação</a></li>
<li class="chapter" data-level="8.5" data-path="04-Experimentos.html"><a href="#m%C3%BAltiplos-per%C3%ADodos"><i class="fa fa-check"></i><b>8.5</b> Múltiplos períodos</a></li>
<li class="chapter" data-level="8.6" data-path="04-Experimentos.html"><a href="#tend%C3%AAncias-paralelas"><i class="fa fa-check"></i><b>8.6</b> Tendências Paralelas</a></li>
<li class="chapter" data-level="8.7" data-path="04-Experimentos.html"><a href="#m%C3%BAltiplos-per%C3%ADodos-p%C3%B3s-tratamento"><i class="fa fa-check"></i><b>8.7</b> Múltiplos períodos pós-tratamento</a></li>
<li class="chapter" data-level="8.8" data-path="04-Experimentos.html"><a href="#an%C3%A1lise-de-sensibilidade-em-did"><i class="fa fa-check"></i><b>8.8</b> Análise de sensibilidade em DiD</a></li>
<li class="chapter" data-level="8.9" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#did-generalizado"><i class="fa fa-check"></i><b>8.9</b> DiD generalizado</a></li>
<li class="chapter" data-level="8.10" data-path="04-Experimentos.html"><a href="#did-com-ado%C3%A7%C3%A3o-escalonada-staggered-timing"><i class="fa fa-check"></i><b>8.10</b> DID com adoção escalonada (staggered timing)</a></li>
<li class="chapter" data-level="8.11" data-path="diferença-em-diferenças.html"><a href="diferença-em-diferenças.html#paper-voter-gratitude-last-long"><i class="fa fa-check"></i><b>8.11</b> Paper Voter Gratitude Last Long?</a></li>
<li class="chapter" data-level="8.12" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos-4"><i class="fa fa-check"></i><b>8.12</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="8.13" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-6"><i class="fa fa-check"></i><b>8.13</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html"><i class="fa fa-check"></i><b>9</b> Time-Series Cross-Section (TSCS)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-5"><i class="fa fa-check"></i><b>9.1</b> Introdução</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#within-versus-between"><i class="fa fa-check"></i><b>9.1.1</b> Within versus Between</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#ovb"><i class="fa fa-check"></i><b>9.2</b> OVB</a></li>
<li class="chapter" data-level="9.3" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#estimandos"><i class="fa fa-check"></i><b>9.3</b> Estimandos</a></li>
<li class="chapter" data-level="9.4" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#resultados-potenciais-1"><i class="fa fa-check"></i><b>9.4</b> Resultados Potenciais</a></li>
<li class="chapter" data-level="9.5" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#modelo-ar1"><i class="fa fa-check"></i><b>9.5</b> Modelo AR(1)</a></li>
<li class="chapter" data-level="9.6" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#sequential-ignorability"><i class="fa fa-check"></i><b>9.6</b> Sequential ignorability</a></li>
<li class="chapter" data-level="9.7" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#resumo"><i class="fa fa-check"></i><b>9.7</b> Resumo</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#remark"><i class="fa fa-check"></i><b>9.7.1</b> Remark</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%B5es-para-infer%C3%AAncia"><i class="fa fa-check"></i><b>9.8</b> Suposições para Inferência</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="time-series-cross-section-tscs.html"><a href="time-series-cross-section-tscs.html#remark-1"><i class="fa fa-check"></i><b>9.8.1</b> Remark</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="04-Experimentos.html"><a href="#efeitos-aleat%C3%B3rios"><i class="fa fa-check"></i><b>9.9</b> Efeitos aleatórios</a></li>
<li class="chapter" data-level="9.10" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-7"><i class="fa fa-check"></i><b>9.10</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="synthetic-control.html"><a href="synthetic-control.html"><i class="fa fa-check"></i><b>10</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="synthetic-control.html"><a href="synthetic-control.html#tratamento"><i class="fa fa-check"></i><b>10.0.1</b> Tratamento</a></li>
<li class="chapter" data-level="10.1" data-path="04-Experimentos.html"><a href="#implementa%C3%A7%C3%A3o-no-r"><i class="fa fa-check"></i><b>10.1</b> Implementação no R</a></li>
<li class="chapter" data-level="10.2" data-path="synthetic-control.html"><a href="synthetic-control.html#synthetic-did"><i class="fa fa-check"></i><b>10.2</b> Synthetic DiD</a></li>
<li class="chapter" data-level="10.3" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos-5"><i class="fa fa-check"></i><b>10.3</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="10.4" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-8"><i class="fa fa-check"></i><b>10.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="llms-e-outras.html"><a href="llms-e-outras.html"><i class="fa fa-check"></i><b>11</b> LLMs e outras</a>
<ul>
<li class="chapter" data-level="11.1" data-path="llms-e-outras.html"><a href="llms-e-outras.html#google-colab"><i class="fa fa-check"></i><b>11.1</b> Google Colab</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-6"><i class="fa fa-check"></i><b>12.1</b> Introdução</a></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#terminologia"><i class="fa fa-check"></i><b>12.2</b> Terminologia</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="machine-learning.html"><a href="machine-learning.html#lasso"><i class="fa fa-check"></i><b>12.2.1</b> LASSO</a></li>
<li class="chapter" data-level="12.2.2" data-path="machine-learning.html"><a href="machine-learning.html#double-lasso"><i class="fa fa-check"></i><b>12.2.2</b> Double Lasso</a></li>
<li class="chapter" data-level="12.2.3" data-path="04-Experimentos.html"><a href="#outras-solu%C3%A7%C3%B5es-ineficazes"><i class="fa fa-check"></i><b>12.2.3</b> Outras soluções ineficazes</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#dl---algoritmo"><i class="fa fa-check"></i><b>12.3</b> DL - Algoritmo</a></li>
<li class="chapter" data-level="12.4" data-path="04-Experimentos.html"><a href="#termos-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.4</b> Termos de Interação</a></li>
<li class="chapter" data-level="12.5" data-path="04-Experimentos.html"><a href="#aplica%C3%A7%C3%A3o-1"><i class="fa fa-check"></i><b>12.5</b> Aplicação</a></li>
<li class="chapter" data-level="12.6" data-path="machine-learning.html"><a href="machine-learning.html#dml"><i class="fa fa-check"></i><b>12.6</b> DML</a></li>
<li class="chapter" data-level="12.7" data-path="machine-learning.html"><a href="machine-learning.html#double-debiasing"><i class="fa fa-check"></i><b>12.7</b> Double Debiasing</a></li>
<li class="chapter" data-level="12.8" data-path="machine-learning.html"><a href="machine-learning.html#cross-fitting"><i class="fa fa-check"></i><b>12.8</b> Cross-fitting</a></li>
<li class="chapter" data-level="12.9" data-path="04-Experimentos.html"><a href="#quest%C3%B5es-pr%C3%A1ticas"><i class="fa fa-check"></i><b>12.9</b> Questões Práticas</a></li>
<li class="chapter" data-level="12.10" data-path="04-Experimentos.html"><a href="#resumo-e-pr%C3%B3ximos-passos-6"><i class="fa fa-check"></i><b>12.10</b> Resumo e próximos passos</a></li>
<li class="chapter" data-level="12.11" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-9"><i class="fa fa-check"></i><b>12.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="resumo-1.html"><a href="resumo-1.html"><i class="fa fa-check"></i><b>13</b> Resumo</a>
<ul>
<li class="chapter" data-level="13.1" data-path="resumo-1.html"><a href="resumo-1.html#matching-2"><i class="fa fa-check"></i><b>13.1</b> Matching</a></li>
<li class="chapter" data-level="13.2" data-path="resumo-1.html"><a href="resumo-1.html#iv"><i class="fa fa-check"></i><b>13.2</b> IV</a></li>
<li class="chapter" data-level="13.3" data-path="resumo-1.html"><a href="resumo-1.html#rdd"><i class="fa fa-check"></i><b>13.3</b> RDD</a></li>
<li class="chapter" data-level="13.4" data-path="resumo-1.html"><a href="resumo-1.html#did"><i class="fa fa-check"></i><b>13.4</b> DiD</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="resumo-1.html"><a href="resumo-1.html#tscs"><i class="fa fa-check"></i><b>13.4.1</b> TSCS</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="resumo-1.html"><a href="resumo-1.html#scm"><i class="fa fa-check"></i><b>13.5</b> SCM</a></li>
<li class="chapter" data-level="13.6" data-path="04-Experimentos.html"><a href="#did-sint%C3%A9tico"><i class="fa fa-check"></i><b>13.6</b> DiD Sintético</a></li>
<li class="chapter" data-level="13.7" data-path="resumo-1.html"><a href="resumo-1.html#double-lasso-1"><i class="fa fa-check"></i><b>13.7</b> Double LASSO</a></li>
<li class="chapter" data-level="13.8" data-path="resumo-1.html"><a href="resumo-1.html#dml-1"><i class="fa fa-check"></i><b>13.8</b> DML</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shift-share.html"><a href="shift-share.html"><i class="fa fa-check"></i><b>14</b> Shift-share</a>
<ul>
<li class="chapter" data-level="14.1" data-path="04-Experimentos.html"><a href="#introdu%C3%A7%C3%A3o-7"><i class="fa fa-check"></i><b>14.1</b> Introdução</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="04-Experimentos.html"><a href="#aplica%C3%A7%C3%A3o-pib-por-estado-e-setor"><i class="fa fa-check"></i><b>14.1.1</b> Aplicação: PIB por estado e setor</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="04-Experimentos.html"><a href="#exemplos-da-pol%C3%ADtica"><i class="fa fa-check"></i><b>14.2</b> Exemplos da Política</a></li>
<li class="chapter" data-level="14.3" data-path="04-Experimentos.html"><a href="#varia%C3%A7%C3%A3o-temporal"><i class="fa fa-check"></i><b>14.3</b> Variação temporal</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="04-Experimentos.html"><a href="#aplica%C3%A7%C3%A3o-elei%C3%A7%C3%B5es-presidenciais-20142018"><i class="fa fa-check"></i><b>14.3.1</b> Aplicação: Eleições presidenciais 2014→2018</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="04-Experimentos.html"><a href="#o-instrumento-shift-share-como-vari%C3%A1vel-instrumental"><i class="fa fa-check"></i><b>14.4</b> O instrumento shift-share como variável instrumental</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="04-Experimentos.html"><a href="#constru%C3%A7%C3%A3o-formal"><i class="fa fa-check"></i><b>14.4.1</b> Construção formal</a></li>
<li class="chapter" data-level="14.4.2" data-path="shift-share.html"><a href="shift-share.html#voltando-ao-exemplo-construindo-w_ik-g_k-e-b_i-com-dados-eleitorais"><i class="fa fa-check"></i><b>14.4.2</b> Voltando ao exemplo: construindo <span class="math inline">\(w_{ik}\)</span>, <span class="math inline">\(g_k\)</span> e <span class="math inline">\(B_i\)</span> com dados eleitorais</a></li>
<li class="chapter" data-level="14.4.3" data-path="shift-share.html"><a href="shift-share.html#o-modelo-estrutural-e-o-iv"><i class="fa fa-check"></i><b>14.4.3</b> O modelo estrutural e o IV</a></li>
<li class="chapter" data-level="14.4.4" data-path="shift-share.html"><a href="shift-share.html#interpretando-o-modelo-com-o-exemplo-eleitoral"><i class="fa fa-check"></i><b>14.4.4</b> Interpretando o modelo com o exemplo eleitoral</a></li>
<li class="chapter" data-level="14.4.5" data-path="04-Experimentos.html"><a href="#por-que-o-instrumento-seria-v%C3%A1lido-uma-discuss%C3%A3o-intuitiva"><i class="fa fa-check"></i><b>14.4.5</b> Por que o instrumento seria válido? Uma discussão intuitiva</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="04-Experimentos.html"><a href="#duas-estrat%C3%A9gias-de-identifica%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>14.5</b> Duas estratégias de identificação</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="04-Experimentos.html"><a href="#estrat%C3%A9gia-1-exogeneidade-das-shares-gpss-2020"><i class="fa fa-check"></i><b>14.5.1</b> Estratégia 1: Exogeneidade das shares (GPSS 2020)</a></li>
<li class="chapter" data-level="14.5.2" data-path="04-Experimentos.html"><a href="#estrat%C3%A9gia-2-exogeneidade-dos-shifts-bhj-2022"><i class="fa fa-check"></i><b>14.5.2</b> Estratégia 2: Exogeneidade dos shifts (BHJ 2022)</a></li>
<li class="chapter" data-level="14.5.3" data-path="04-Experimentos.html"><a href="#resumo-das-duas-estrat%C3%A9gias"><i class="fa fa-check"></i><b>14.5.3</b> Resumo das duas estratégias</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="04-Experimentos.html"><a href="#o-problema-de-infer%C3%AAncia"><i class="fa fa-check"></i><b>14.6</b> O problema de inferência</a></li>
<li class="chapter" data-level="14.7" data-path="04-Experimentos.html"><a href="#implementa%C3%A7%C3%A3o-em-r"><i class="fa fa-check"></i><b>14.7</b> Implementação em R</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="04-Experimentos.html"><a href="#constru%C3%A7%C3%A3o-do-instrumento"><i class="fa fa-check"></i><b>14.7.1</b> Construção do instrumento</a></li>
<li class="chapter" data-level="14.7.2" data-path="04-Experimentos.html"><a href="#estima%C3%A7%C3%A3o-iv"><i class="fa fa-check"></i><b>14.7.2</b> Estimação IV</a></li>
<li class="chapter" data-level="14.7.3" data-path="04-Experimentos.html"><a href="#erros-padr%C3%A3o-corrigidos-pacote-shiftsharese"><i class="fa fa-check"></i><b>14.7.3</b> Erros-padrão corrigidos: pacote <code>ShiftShareSE</code></a></li>
<li class="chapter" data-level="14.7.4" data-path="04-Experimentos.html"><a href="#agrega%C3%A7%C3%A3o-ao-n%C3%ADvel-do-choque-pacote-ssaggregate"><i class="fa fa-check"></i><b>14.7.4</b> Agregação ao nível do choque: pacote <code>ssaggregate</code></a></li>
<li class="chapter" data-level="14.7.5" data-path="shift-share.html"><a href="shift-share.html#ecossistema-r-vs.-stata"><i class="fa fa-check"></i><b>14.7.5</b> Ecossistema R vs. Stata</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="04-Experimentos.html"><a href="#aplica%C3%A7%C3%B5es-em-ci%C3%AAncia-pol%C3%ADtica"><i class="fa fa-check"></i><b>14.8</b> Aplicações em Ciência Política</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="04-Experimentos.html"><a href="#com%C3%A9rcio-e-voto-nos-eua"><i class="fa fa-check"></i><b>14.8.1</b> Comércio e voto nos EUA</a></li>
<li class="chapter" data-level="14.8.2" data-path="04-Experimentos.html"><a href="#com%C3%A9rcio-e-nacionalismo-na-europa"><i class="fa fa-check"></i><b>14.8.2</b> Comércio e nacionalismo na Europa</a></li>
<li class="chapter" data-level="14.8.3" data-path="04-Experimentos.html"><a href="#valores-autorit%C3%A1rios"><i class="fa fa-check"></i><b>14.8.3</b> Valores autoritários</a></li>
<li class="chapter" data-level="14.8.4" data-path="04-Experimentos.html"><a href="#welfare-state-hist%C3%B3rico"><i class="fa fa-check"></i><b>14.8.4</b> Welfare state histórico</a></li>
<li class="chapter" data-level="14.8.5" data-path="04-Experimentos.html"><a href="#automa%C3%A7%C3%A3o-e-redistribui%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>14.8.5</b> Automação e redistribuição</a></li>
<li class="chapter" data-level="14.8.6" data-path="shift-share.html"><a href="shift-share.html#brasil"><i class="fa fa-check"></i><b>14.8.6</b> Brasil</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="04-Experimentos.html"><a href="#aplica%C3%A7%C3%B5es-em-rela%C3%A7%C3%B5es-internacionais"><i class="fa fa-check"></i><b>14.9</b> Aplicações em Relações Internacionais</a>
<ul>
<li class="chapter" data-level="14.9.1" data-path="04-Experimentos.html"><a href="#com%C3%A9rcio-e-pol%C3%ADtica-externa"><i class="fa fa-check"></i><b>14.9.1</b> Comércio e política externa</a></li>
<li class="chapter" data-level="14.9.2" data-path="04-Experimentos.html"><a href="#comportamento-legislativo-em-pol%C3%ADtica-comercial"><i class="fa fa-check"></i><b>14.9.2</b> Comportamento legislativo em política comercial</a></li>
<li class="chapter" data-level="14.9.3" data-path="shift-share.html"><a href="shift-share.html#temas-com-potencial-inexplorado-em-ri"><i class="fa fa-check"></i><b>14.9.3</b> Temas com potencial inexplorado em RI</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="04-Experimentos.html"><a href="#refer%C3%AAncias-10"><i class="fa fa-check"></i><b>14.10</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="04-Experimentos.html"><a href="#interfer%C3%AAncia-spillover-e-din%C3%A2mica"><i class="fa fa-check"></i><b>15</b> Interferência, spillover e dinâmica</a>
<ul>
<li class="chapter" data-level="15.1" data-path="04-Experimentos.html"><a href="#suposi%C3%A7%C3%B5es-simplificadoras"><i class="fa fa-check"></i><b>15.1</b> Suposições simplificadoras</a></li>
<li class="chapter" data-level="15.2" data-path="04-Experimentos.html"><a href="#po-com-tratamento-de-m%C3%BAltiplos-valores-multi-valued"><i class="fa fa-check"></i><b>15.2</b> PO com tratamento de múltiplos valores (multi-valued)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="interferência-spillover-e-dinâmica.html"><a href="interferência-spillover-e-dinâmica.html"><i class="fa fa-check"></i><b>15.2.1</b> Multi-valued discreto</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="04-Experimentos.html"><a href="#din%C3%A2mica"><i class="fa fa-check"></i><b>15.3</b> Dinâmica</a></li>
<li class="chapter" data-level="15.4" data-path="04-Experimentos.html"><a href="#interfer%C3%AAncia"><i class="fa fa-check"></i><b>15.4</b> Interferência</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curso de Inferência Causal</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="experimentos" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Experimentos<a href="experimentos.html#experimentos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introdução-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introdução<a href="#introdu%C3%A7%C3%A3o-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Um experimento é o desenho de pesquisa no qual a pesquisadora controla o mecanismo de atribuição do tratamento e controle</li>
<li>Seja <span class="math inline">\(p_i = P(T_i=1)\)</span>. Então <span class="math inline">\(p_i\)</span> é conhecido e controlado pela pesquisadora.</li>
<li>Em contraposição, um estudo observacional é quando a pesquisadora não controla o mecanismo (natureza ou realidade social)</li>
<li>Quando uma quantidade potencial (estimando) pode ser descrita em função da distribuição de dados observáveis, dizemos que o estimando é identificável. De outro modo, não identificado.</li>
<li>Veremos por que experimentos produzem desenhos críveis de identificação causal</li>
<li>Vamos supor experimentos ideais (sem attrition ou non-compliance)</li>
</ul>
<p>Nós já vimos que uma suposição crítica é a SUTVA.</p>
<ul>
<li><p>Stable Unit Treatment Values Assumption</p></li>
<li><p>Não interferência e sem variação escondida no tratamento</p>
<ul>
<li>PO não varia com o tratamento atribuído a outras unidades</li>
<li>PO de uma unidade não é impactado pelo nível de tratamento de outras unidades</li>
</ul></li>
<li><p>Para cada unidade, não há formas distintas ou versões de cada nível de tratamento</p></li>
<li><p>Definição não-ambígua do tratamento</p></li>
<li><p>Supondo SUTVA, Diferença Simples de Média pode ser decomposta em ATE + viés de seleção</p></li>
<li><p><span class="math inline">\(\underbrace{\mathbb{E}[Y_i|T_i=1] - \mathbb{E}[Y_i|T_i=0]}_{\text{Simple Difference in Outcomes (SDO)}} = \mathbb{E}[Y_i^1|T_i=1] - \mathbb{E}[Y_i^0|T_i=0]\)</span></p></li>
<li><p>Podemos adicionar e subtrair os resultados contrafactuais para os tratados</p></li>
<li><p><span class="math inline">\(= \mathbb{E}[Y_i^1|T_i=1] - \color{blue}{\mathbb{E}[Y_i^0|T_i=1]} + \color{red}{\mathbb{E}[Y_i^0|T_i=1]} - \mathbb{E}[Y_i^0|T_i=0]\)</span></p></li>
<li><p><span class="math inline">\(= \underbrace{\mathbb{E}[Y_i^1 - Y_i^0|T_i=1]}_{\text{ATT}} + \underbrace{\mathbb{E}[Y_i^0|T_i=1] - \mathbb{E}[Y_i^0|T_i=0]}_{\text{Viés de Seleção}}\)</span></p></li>
</ul>
</div>
<div id="experimentos-aleatórios" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Experimentos aleatórios<a href="#experimentos-aleat%C3%B3rios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Mecanismo de atribuição de tratamento é probabilístico (Positividade): <span class="math inline">\(0 &lt; p_i &lt; 1\)</span>.</li>
<li>Unconfoundedness ou Permutabilidade (ou <em>assignment mechanism–ignorability</em>): <span class="math inline">\(P(T_i=1|y^1, y^0) = P(T_i)\)</span>.</li>
</ul>
<p>O que é Permutabilidade (unconfoundedness)?</p>
<ul>
<li><p>A distribuição dos resultados potenciais é independente do tratamento.</p></li>
<li><p><span class="math inline">\(\mathbb{E}[Y^1|T=1] = \mathbb{E}[Y^1|T=0]\)</span></p></li>
<li><p><span class="math inline">\(\mathbb{E}[Y^0|T=1] = \mathbb{E}[Y^0|T=0]\)</span></p></li>
<li><p>Resultados potenciais são independentes do tratamento, dadas as covariáveis.</p></li>
<li><p>Se a condição de tratamento fosse hipoteticamente trocada, os resultados esperados permaneceriam os mesmos.</p></li>
<li><p>Isso significa que em um experimento com permutabilidade, não temos viés de seleção (Por quê?).</p></li>
<li><p>Independência entre tratamento e resultados potenciais implica que <span class="math inline">\(\mathbb{E}[Y^0_i|T_i=1] = \mathbb{E}[Y^0_i|T_i=0] = \mathbb{E}[Y^0_i]\)</span></p></li>
<li><p>Portanto, o viés de seleção, dado por <span class="math inline">\(\mathbb{E}[Y_i^0|T_i=1] - \mathbb{E}[Y_i^0|T_i=0]\)</span>, fica:</p></li>
<li><p><span class="math inline">\(\mathbb{E}[Y_i^0|T_i=1] - \mathbb{E}[Y_i^0|T_i=0] = \mathbb{E}[Y_i^0] - \mathbb{E}[Y_i^0] = 0\)</span></p></li>
<li><p>Ou seja, SDO estima o ATE (via ATT).</p></li>
<li><p><span class="math inline">\(\underbrace{\mathbb{E}[Y_i|T_i=1] - \mathbb{E}[Y_i|T_i=0]}_{\text{Simple Difference in Outcomes (SDO)}} =  \underbrace{\mathbb{E}[Y_i^1 - Y_i^0|T_i=1]}_{\text{ATT}} = ATE\)</span></p></li>
</ul>
</div>
<div id="restrição-de-exclusão" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Restrição de Exclusão<a href="#restri%C3%A7%C3%A3o-de-exclus%C3%A3o" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Formalmente, podemos separar a alocação do tratamento e o tratamento efetivamente recebido. Seja <span class="math inline">\(Z_i\)</span> a alocação do tratamento e <span class="math inline">\(T_i\)</span> o tratamento recebido.</p></li>
<li><p>Então, a restrição de exclusão quer dizer que o que importa é o tratamento efetivamente recebido <span class="math inline">\(T_i\)</span>, e não a variável que aloca o tratamento <span class="math inline">\(Z_i\)</span>.</p></li>
<li><p>Formalmente, isso quer dizer que: <span class="math inline">\(Y^{1,z=1, T}_i = Y^{1,z=0, T}_i = Y^{1,T}_i\)</span> e similarmente, <span class="math inline">\(Y^{0,z=1,T}_i = Y^{0,z=0,T}_i = Y^{0,T}_i\)</span></p></li>
<li><p>Quando não ocorre isso? Se o mecanismo de atribuição do tratamento dispara outras causas</p></li>
<li><p>Suponha que um experimento é sobre efeito de transferência de dinheiro em bem-estar</p></li>
<li><p>Se ongs, sabendo do experimento, forem ajudar quem não tiver sido alocado para receber dinheiro</p></li>
<li><p>Se houver erro de mensuração assimétrico?</p></li>
<li><p>Pesquisadores distintos entrevistam recipientes e não-recipientes da transferência de dinheiro, com habilidades distintas</p></li>
<li><p>Ou questionários diferentes. Erro de mensuração assimétrico</p></li>
<li><p>Nova <em>switching equation</em>.</p></li>
<li><p>Seja <span class="math inline">\(e_{i1}\)</span> o erro de mensuração cometido se uma observação é atribuída para o tratamento, e, analogamente, <span class="math inline">\(e_{i0}\)</span> o erro para o controle.</p></li>
<li><p>De <span class="math inline">\(Y_i = T_iY^1_i + (1- T_i)Y^0_i\)</span> para <span class="math inline">\(Y_i = T_i(Y^1_i + e_{i1}) + (1- T_i)(Y^0_i + e_{i0})\)</span>.</p></li>
<li><p>Novo SDO: <span class="math inline">\(\mathbb{E}[Y_i|T_i=1] - \mathbb{E}[Y_i|T_i=0] = \mathbb{E}[Y^1_i + e_{i1}|T_i=1] - \mathbb{E}[Y^0_i + e_{i0}|T_i=0] = \mathbb{E}[Y^1_i|T_i=1] + \mathbb{E}[e_{i1}|T_i=1] - \mathbb{E}[Y^0_i|T_i=0] - \mathbb{E}[e_{i0}|T_i=0]\)</span></p></li>
<li><p>Novo SDO pode se rearranjado: <span class="math inline">\(\underbrace{\mathbb{E}[Y^1_i|T_i=1] - \mathbb{E}[Y^0_i|T_i=0]}_{\text{antigo SDO}} + \underbrace{\mathbb{E}[e_{i1}|T_i=1]  - \mathbb{E}[e_{i0}|T_i=0]}_{\text{Dif média no erro de mensuração}}\)</span></p></li>
<li><p>Se <span class="math inline">\(\mathbb{E}[e_{i1}|T_i=1] \neq \mathbb{E}[e_{i0}|T_i=0]\)</span>, então SDO será viesado.</p></li>
</ul>
<p>Como Garantir a restrição de Exclusão?</p>
<ul>
<li>Double blindness (duplo cego)</li>
<li>Paralelismo na administração do experimento (mesmo questionário e mesmos entrevistadores)</li>
<li>Na pior das hipóteses, aleatorização dos entrevistadores.</li>
</ul>
</div>
<div id="tipos-de-experimentos" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Tipos de experimentos<a href="experimentos.html#tipos-de-experimentos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="aleatorização-de-bernoulli" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Aleatorização de Bernoulli<a href="#aleatoriza%C3%A7%C3%A3o-de-bernoulli" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>É o experimento com aleatorização simples (basicamente, lançamento de moeda)</li>
<li>Matematicamente, <span class="math inline">\(p_i(T_i=1) = p\)</span>.</li>
<li>Problema: Possível “má aleatorização” (todo mundo no controle ou tratamento)</li>
<li>ps.: toda aleatorização realizada é matematicamente equivalente.</li>
<li>Possui <span class="math inline">\(2^n\)</span> configurações possíveis de alocação entre tratamento e controle</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="experimentos.html#cb18-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb18-2"><a href="experimentos.html#cb18-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb18-3"><a href="experimentos.html#cb18-3" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">sum</span>(<span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>))), </span>
<span id="cb18-4"><a href="experimentos.html#cb18-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;aleatorização de Bernoulli&quot;</span>,</span>
<span id="cb18-5"><a href="experimentos.html#cb18-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Número de tratados&quot;</span>,</span>
<span id="cb18-6"><a href="experimentos.html#cb18-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-4-1.png" alt="" width="672" /></p>
</div>
<div id="aleatorização-completa" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Aleatorização Completa<a href="#aleatoriza%C3%A7%C3%A3o-completa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Seleciono aleatoriamente um número fixo de pessoas para tratamento e controle</li>
<li>Ex.: 25 para tratamento e 25 para controle</li>
<li>Basta numerar cada unidade (de 1 a 50) e amostrar 25 aleatoriamente para tratamento (e restante para controle)</li>
<li>Vantagem: garanto número de obs em cada condição</li>
<li>Possui <span class="math inline">\({N \choose \frac{n}{2}}\)</span> configurações possíveis de alocação entre tratamento e controle.</li>
<li>Intuição: estamos jogando fora as aleatorizações “indesejáveis”.</li>
<li>Cálculo da variância é mais complexo</li>
</ul>
</div>
<div id="aleatorização-condicional-block-random-assignment" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Aleatorização Condicional (Block Random Assignment)<a href="#aleatoriza%C3%A7%C3%A3o-condicional-block-random-assignment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Definição</strong>: Experimento é condicionalmente aleatório se a aleatorização depende de variáveis pré-tratamento <span class="math inline">\(X\)</span>.</p></li>
<li><p><strong>Exemplo Binário</strong>: Duas moedas, uma para <span class="math inline">\(X=1\)</span> e outra para <span class="math inline">\(X=0\)</span>.</p></li>
<li><p><strong>Aleatorização Marginal vs. Condicional</strong>:</p>
<ul>
<li>Marginal: Aleatorização uniforme para todos os indivíduos.</li>
<li>Condicional: Aleatorização depende de <span class="math inline">\(X\)</span>, gerando permutabilidade condicional a <span class="math inline">\(X\)</span>.</li>
</ul></li>
<li><p><strong>Permutabilidade Condicional</strong>: <span class="math inline">\((Y^1, Y^0 | X=x) \perp T\)</span>.</p></li>
<li><p>Não gera permutabilidade (não-condicional).</p></li>
<li><p>Permutabilidade condicional a <span class="math inline">\(X\)</span> é crucial para inferência em contextos com variáveis pré-tratamento.</p></li>
</ul>
</div>
<div id="pensando-aleatorização-em-bloco" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Pensando aleatorização em bloco<a href="#pensando-aleatoriza%C3%A7%C3%A3o-em-bloco" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Ex.: digamos que em uma amostra de 100 pessoas, queremos 25 homens e 25 mulheres no tratamento e controle</li>
<li>Sorteio 25 homens para tratamento e depois 25 mulheres.</li>
<li>Cada bloco possui tamanho 25, neste exemplo.</li>
<li>Blocos de tamanho <span class="math inline">\(2\)</span> são chamados de <em>pair-matched design</em>.</li>
<li>Em geral, estudos com <em>matching</em> em muitas variáveis</li>
<li>Útil para amostras pequenas</li>
</ul>
</div>
<div id="ate-com-aleatorização-condicional-bloco" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> ATE com Aleatorização Condicional (Bloco)<a href="#ate-com-aleatoriza%C3%A7%C3%A3o-condicional-bloco" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Estratificação</li>
<li>Efeito heterogêneo por estrato?</li>
<li>Podemos calcular o ATE por estrato, já que é aleatório no interior de cada estrato.</li>
<li>Efeito geral na população.</li>
<li>Podemos calcular ponderando os ATEs.</li>
<li>Seja <span class="math inline">\(J\)</span> o número de estratos, indexados por <span class="math inline">\(j\)</span>. Seja <span class="math inline">\(N\)</span> o número de unidades e <span class="math inline">\(N_j\)</span> o número de unidades no bloco <span class="math inline">\(j\)</span>. Então:</li>
<li><span class="math inline">\(ATE = \sum_{j=1}^J \frac{N_j}{N}ATE_j\)</span></li>
</ul>
</div>
<div id="aleatorização-em-bloco" class="section level3 hasAnchor" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Aleatorização em bloco<a href="#aleatoriza%C3%A7%C3%A3o-em-bloco" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Pela Lei dos Grandes números, tende a gerar balanceamento entre blocos</li>
<li>Balanceamento quer dizer que blocos são similares</li>
<li>Em variáveis observadas e não-observadas</li>
<li>Probabilidade de tratamento pode variar por bloco.</li>
<li>Chamada de propensity score.</li>
</ul>
</div>
<div id="precisão-da-aleatorização-em-bloco" class="section level3 hasAnchor" number="4.4.7">
<h3><span class="header-section-number">4.4.7</span> Precisão da aleatorização em bloco<a href="#precis%C3%A3o-da-aleatoriza%C3%A7%C3%A3o-em-bloco" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Em geral a precisão aumenta (erro padrão diminui) com aleatorização em bloco.</li>
<li>Intuição é que removemos parte da variância (amostras possíveis), condicionando nos estratos</li>
<li>Vamos checar uma simulação no R para ver um exemplo do ganho na precisão</li>
<li>Lembrem-se que se <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> são independentes, então <span class="math inline">\(Var(aX + bY) = a^2Var(X) + b^2Var(Y)\)</span>.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="experimentos.html#cb19-1" tabindex="-1"></a><span class="co"># Set up Potential outcomes and units and blocks</span></span>
<span id="cb19-2"><a href="experimentos.html#cb19-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb19-3"><a href="experimentos.html#cb19-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb19-4"><a href="experimentos.html#cb19-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb19-5"><a href="experimentos.html#cb19-5" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb19-6"><a href="experimentos.html#cb19-6" tabindex="-1"></a>index_block <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">2</span>, n2), <span class="fu">rep</span>(<span class="dv">1</span>, n1))</span>
<span id="cb19-7"><a href="experimentos.html#cb19-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb19-8"><a href="experimentos.html#cb19-8" tabindex="-1"></a><span class="co"># potential outcome control</span></span>
<span id="cb19-9"><a href="experimentos.html#cb19-9" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n1, <span class="dv">2</span>, <span class="dv">1</span>),<span class="fu">rnorm</span>(n2, <span class="dv">6</span>, <span class="dv">1</span>)) </span>
<span id="cb19-10"><a href="experimentos.html#cb19-10" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> y0 <span class="sc">+</span> <span class="fl">1.5</span> <span class="co"># potential outcome treatment</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="experimentos.html#cb20-1" tabindex="-1"></a><span class="co"># block assignment</span></span>
<span id="cb20-2"><a href="experimentos.html#cb20-2" tabindex="-1"></a>t_bloco1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n1, n1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="experimentos.html#cb20-3" tabindex="-1"></a>c_bloco1 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n1)[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span>n1 <span class="sc">%in%</span> t_bloco1)]</span>
<span id="cb20-4"><a href="experimentos.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="experimentos.html#cb20-5" tabindex="-1"></a>t_bloco2 <span class="ot">&lt;-</span> <span class="fu">sample</span>((n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2), n2<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-6"><a href="experimentos.html#cb20-6" tabindex="-1"></a>c_bloco2 <span class="ot">&lt;-</span> ((n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2))[<span class="sc">!</span>((n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2) <span class="sc">%in%</span> t_bloco2)]</span>
<span id="cb20-7"><a href="experimentos.html#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="experimentos.html#cb20-8" tabindex="-1"></a>y1_obs_bloco1 <span class="ot">&lt;-</span> y1[t_bloco1]</span>
<span id="cb20-9"><a href="experimentos.html#cb20-9" tabindex="-1"></a>y1_obs_bloco2 <span class="ot">&lt;-</span> y1[t_bloco2]</span>
<span id="cb20-10"><a href="experimentos.html#cb20-10" tabindex="-1"></a>y0_obs_bloco1 <span class="ot">&lt;-</span> y0[c_bloco1]</span>
<span id="cb20-11"><a href="experimentos.html#cb20-11" tabindex="-1"></a>y0_obs_bloco2 <span class="ot">&lt;-</span> y0[c_bloco2]</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="experimentos.html#cb21-1" tabindex="-1"></a><span class="co"># random assignment</span></span>
<span id="cb21-2"><a href="experimentos.html#cb21-2" tabindex="-1"></a>units_simple_treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(t_bloco1, t_bloco2)</span>
<span id="cb21-3"><a href="experimentos.html#cb21-3" tabindex="-1"></a>units_simple_control <span class="ot">&lt;-</span> <span class="fu">c</span>(c_bloco1, c_bloco2)</span>
<span id="cb21-4"><a href="experimentos.html#cb21-4" tabindex="-1"></a>y1_obs <span class="ot">&lt;-</span> y1[units_simple_treatment]</span>
<span id="cb21-5"><a href="experimentos.html#cb21-5" tabindex="-1"></a>y0_obs <span class="ot">&lt;-</span> y0[units_simple_control]</span>
<span id="cb21-6"><a href="experimentos.html#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="experimentos.html#cb21-7" tabindex="-1"></a><span class="co"># erro padrão</span></span>
<span id="cb21-8"><a href="experimentos.html#cb21-8" tabindex="-1"></a>erro_pad_simple <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y1_obs, y0_obs)<span class="sc">$</span>stderr </span>
<span id="cb21-9"><a href="experimentos.html#cb21-9" tabindex="-1"></a>simple_p_value <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y1_obs, y0_obs)<span class="sc">$</span>p.value</span>
<span id="cb21-10"><a href="experimentos.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="experimentos.html#cb21-11" tabindex="-1"></a>my_t <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1_obs <span class="sc">-</span> y0_obs)<span class="sc">/</span>erro_pad_simple</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="experimentos.html#cb22-1" tabindex="-1"></a>erro_pad1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y1_obs_bloco1, y0_obs_bloco1)<span class="sc">$</span>stderr</span>
<span id="cb22-2"><a href="experimentos.html#cb22-2" tabindex="-1"></a>erro_pad2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y1_obs_bloco2, y0_obs_bloco2)<span class="sc">$</span>stderr</span>
<span id="cb22-3"><a href="experimentos.html#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="experimentos.html#cb22-4" tabindex="-1"></a>erro_padrao_geral <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(erro_pad1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n1<span class="sc">/</span>N)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> erro_pad2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n2<span class="sc">/</span>N)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-5"><a href="experimentos.html#cb22-5" tabindex="-1"></a>ate1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1_obs_bloco1 <span class="sc">-</span> y0_obs_bloco1)<span class="sc">*</span>(n1<span class="sc">/</span>N)</span>
<span id="cb22-6"><a href="experimentos.html#cb22-6" tabindex="-1"></a>ate2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1_obs_bloco2 <span class="sc">-</span> y0_obs_bloco2)<span class="sc">*</span>(n2<span class="sc">/</span>N)</span>
<span id="cb22-7"><a href="experimentos.html#cb22-7" tabindex="-1"></a>ate <span class="ot">&lt;-</span> ate1 <span class="sc">+</span> ate2</span>
<span id="cb22-8"><a href="experimentos.html#cb22-8" tabindex="-1"></a>my_t <span class="ot">&lt;-</span> ate<span class="sc">/</span>erro_padrao_geral</span>
<span id="cb22-9"><a href="experimentos.html#cb22-9" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(my_t), <span class="at">df =</span> <span class="fl">23.76567</span>))</span>
<span id="cb22-10"><a href="experimentos.html#cb22-10" tabindex="-1"></a><span class="fu">print</span>(erro_pad1)</span></code></pre></div>
<pre><code>## [1] 0.646563</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="experimentos.html#cb24-1" tabindex="-1"></a><span class="fu">print</span>(erro_pad2)</span></code></pre></div>
<pre><code>## [1] 0.4502482</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="experimentos.html#cb26-1" tabindex="-1"></a><span class="fu">print</span>(erro_padrao_geral)</span></code></pre></div>
<pre><code>## [1] 0.3723061</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="experimentos.html#cb28-1" tabindex="-1"></a><span class="fu">print</span>(p_value)</span></code></pre></div>
<pre><code>## [1] 0.0006818314</code></pre>
</div>
<div id="comparação-de-ses" class="section level3 hasAnchor" number="4.4.8">
<h3><span class="header-section-number">4.4.8</span> Comparação de SEs<a href="#compara%C3%A7%C3%A3o-de-ses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="experimentos.html#cb30-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<pre><code>## Warning: pacote &#39;knitr&#39; foi compilado no R versão 4.4.3</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="experimentos.html#cb32-1" tabindex="-1"></a>comparison_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-2"><a href="experimentos.html#cb32-2" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Simple Randomization&quot;</span>, <span class="st">&quot;Block 1&quot;</span>, <span class="st">&quot;Block 2&quot;</span>, <span class="st">&quot;General Block Randomization&quot;</span>),</span>
<span id="cb32-3"><a href="experimentos.html#cb32-3" tabindex="-1"></a>  <span class="at">Standard_Error =</span> <span class="fu">c</span>(erro_pad_simple, erro_pad1, erro_pad2, erro_padrao_geral)</span>
<span id="cb32-4"><a href="experimentos.html#cb32-4" tabindex="-1"></a>)</span>
<span id="cb32-5"><a href="experimentos.html#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="experimentos.html#cb32-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(comparison_table, <span class="at">caption =</span> <span class="st">&quot;Comparação de Erros padrão&quot;</span>, <span class="at">align =</span> <span class="st">&#39;c&#39;</span>, <span class="at">format =</span> <span class="st">&quot;latex&quot;</span>)</span></code></pre></div>
</div>
<div id="cluster-randomization" class="section level3 hasAnchor" number="4.4.9">
<h3><span class="header-section-number">4.4.9</span> Cluster randomization<a href="experimentos.html#cluster-randomization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Quando aleatorizo o cluster, em vez das unidades.</li>
<li>Ex.: Se não for possível aleatorizar um tratamento entre estudantes, aleatorizo escolas</li>
<li>No interior de cada escola, todo mundo é tratado ou não-tratado. Não há variação <em>within</em> escolas, apenas entre (between) escolas.</li>
<li>Grande perda de variabilidade nos dados, reduzindo precisão (aumento no erro padrão)</li>
<li>Às vezes é a única aleatorização possível.</li>
</ul>
</div>
<div id="tabelas-em-artigos" class="section level3 hasAnchor" number="4.4.10">
<h3><span class="header-section-number">4.4.10</span> Tabelas em artigos<a href="experimentos.html#tabelas-em-artigos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="estimador-ate" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Estimador ATE<a href="experimentos.html#estimador-ate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>estimativa: <span class="math inline">\(\frac{\sum_{i=1}^{n}Y_iT_i}{n_1} - \frac{\sum_{i=1}^{n}Y_i(1-T_i)}{n_0} = .0608 - .0353 = 0.0255\)</span></li>
<li>Erro padrão: <span class="math inline">\(\sqrt{\frac{\hat{\sigma_1^2}}{n_1} + \frac{\hat{\sigma_0^2}}{n_0}} = \sqrt{\frac{.0608\cdot(1-.0608)}{1217} + \frac{.0353\cdot (1-.0353)}{1217}} = 0.00865\)</span></li>
<li>Pequena diferença com os coeficientes da tabela</li>
<li>Typo? Alguma informação não reproduz exatamente? Fizemos algo errado?</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="experimentos.html#cb33-1" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">74</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1217</span> <span class="sc">-</span> <span class="dv">74</span>))</span>
<span id="cb33-2"><a href="experimentos.html#cb33-2" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">43</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1217</span> <span class="sc">-</span> <span class="dv">43</span>))</span>
<span id="cb33-3"><a href="experimentos.html#cb33-3" tabindex="-1"></a>var_treat <span class="ot">&lt;-</span> <span class="fu">var</span>(treatment) </span>
<span id="cb33-4"><a href="experimentos.html#cb33-4" tabindex="-1"></a>var_control <span class="ot">&lt;-</span> <span class="fu">var</span>(control)</span>
<span id="cb33-5"><a href="experimentos.html#cb33-5" tabindex="-1"></a>erro_padrao <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_treat<span class="sc">/</span><span class="dv">1217</span> <span class="sc">+</span> var_control<span class="sc">/</span><span class="dv">1217</span>)</span>
<span id="cb33-6"><a href="experimentos.html#cb33-6" tabindex="-1"></a><span class="fu">round</span>(erro_padrao, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00866</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="experimentos.html#cb35-1" tabindex="-1"></a><span class="fu">t.test</span>(treatment, control)      </span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  treatment and control
## t = 2.9414, df = 2286.3, p-value = 0.0033
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.008490408 0.042454539
## sample estimates:
##  mean of x  mean of y 
## 0.06080526 0.03533279</code></pre>
</div>
<div id="resumo-do-capítulo" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Resumo do Capítulo<a href="#resumo-do-cap%C3%ADtulo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Neste capítulo, vimos como experimentos aleatórios eliminam o viés de seleção sob a suposição de SUTVA. Os principais pontos são:</p>
<ul>
<li>A aleatorização garante que tratamento e controle sejam comparáveis em expectativa, eliminando o viés de seleção.</li>
<li>A validade do experimento depende também da restrição de exclusão (o que importa é o tratamento efetivamente recebido) e da simetria na administração.</li>
<li>Existem vários tipos de aleatorização — Bernoulli, completa, em bloco e por cluster — cada qual com vantagens e limitações. A aleatorização em bloco tende a aumentar a precisão das estimativas.</li>
<li>Com amostras grandes, as diferenças entre os tipos de aleatorização diminuem.</li>
<li>Ao longo do capítulo, sempre supusemos condições ideais (sem attrition, compliance perfeito etc.). No próximo capítulo, veremos o que acontece quando não temos aleatorização e precisamos recorrer a estratégias observacionais como matching.</li>
</ul>
</div>
<div id="declare-design" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Declare Design<a href="experimentos.html#declare-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma ferramenta muito útil para experimentos (mas também para estudos observacionais) é o pacote do R Declare Design.</p>
<p>Blair, Coppock e Humphreys criaram um framework para definir e avaliar um desenho de pesquisa. Com o resultado, escreveram um livro “Research Design in the Social Sciences”, e um pacote no R para implementar os conceitos desenvolvidos no livro, chamado “DeclareDesign”. Para instalar (junto com os datasets usados no livro), basta rodar .</p>
<p>O framework é baseado no acrônimo MIDA, que contempla os quatro elementos básicos de um desenho de pesquisa: models, inquiries, data strategies, and answer strategies.</p>
<p>Ou seja, você deve especificar um modelo, qual pergunta de pesquisa (aka estimando), quais dados vai utilizar e como vai estimar o estimando.</p>
<p>Um modelo descreve o que causa o que e como. Tipicamente especifica as unidades, o tamanho da amostra e a equação de resultados potenciais.
Suponha que quero rodar um experimento aleatório com um tratamento e controle (two-arm randomized experiment). Assim, podemos declarar um modelo com:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="experimentos.html#cb37-1" tabindex="-1"></a><span class="fu">library</span>(DeclareDesign)</span>
<span id="cb37-2"><a href="experimentos.html#cb37-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">declare_model</span>(</span>
<span id="cb37-3"><a href="experimentos.html#cb37-3" tabindex="-1"></a>    <span class="at">N =</span> <span class="dv">500</span>,</span>
<span id="cb37-4"><a href="experimentos.html#cb37-4" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> N <span class="sc">/</span> <span class="dv">2</span>), <span class="co"># tratamento e controle</span></span>
<span id="cb37-5"><a href="experimentos.html#cb37-5" tabindex="-1"></a>    <span class="at">U =</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="fl">0.25</span>), <span class="co"># heterogeneidade exógena</span></span>
<span id="cb37-6"><a href="experimentos.html#cb37-6" tabindex="-1"></a>    <span class="fu">potential_outcomes</span>(Y <span class="sc">~</span> <span class="fl">0.2</span> <span class="sc">*</span> Z <span class="sc">+</span> X <span class="sc">+</span> U)</span>
<span id="cb37-7"><a href="experimentos.html#cb37-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Vamos entender o que fizemos.</p>
<ol style="list-style-type: decimal">
<li><p>Declaramos que nossa população terá <span class="math inline">\(500\)</span> observações: . Nesse exemplo, a amostra será igual à população, mas poderíamos amostrar da população se quiséssemos.</p></li>
<li><p>Declaramos que <span class="math inline">\(X\)</span>, uma covariável, pode assumir dois valores (0,1), e atribuímos a primeira metade para <span class="math inline">\(0\)</span> e a outra metade para <span class="math inline">\(1\)</span>: .</p></li>
<li><p>Declaramos que existe uma variável <span class="math inline">\(U\)</span> que tem distribuição normal, com <span class="math inline">\(N\)</span> observações e média <span class="math inline">\(0\)</span> e desvio-padrão <span class="math inline">\(.25\)</span>:.</p></li>
<li><p>Declaramos que os resultados potenciais diferem em <span class="math inline">\(20\%\)</span> entre tratamento e controle (<span class="math inline">\(Z\)</span>) para cada unidade. Uma forma alternativa e talvez mais clara de declarar a relação entre tratamento/controle e resultados potenciais seria escrever .</p></li>
</ol>
<p>4.1. Além disso, <span class="math inline">\(X\)</span> tem efeito de <span class="math inline">\(1\)</span> para todas as unidades.</p>
<p>Vamos passar agora ao nosso estimando ou <em>inquiry</em>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="experimentos.html#cb38-1" tabindex="-1"></a>inquiry <span class="ot">&lt;-</span> <span class="fu">declare_inquiry</span>(<span class="at">ATE =</span> <span class="fu">mean</span>(Y_Z_1 <span class="sc">-</span> Y_Z_0))</span></code></pre></div>
<p>Se estamos interessados no ATE, é só declarar que é a média da diferença entre os resultados potenciais. Podemos também usar a função
Outras possibilidades incluem o ATT e CATE: , por exemplo. Formulação equivalente para o ATT seria .</p>
<p>Estratégia de dados</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="experimentos.html#cb39-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">declare_assignment</span>(<span class="at">Z =</span> <span class="fu">complete_ra</span>(<span class="at">N =</span> N, <span class="at">m =</span> <span class="dv">250</span>)) <span class="sc">+</span> <span class="co"># assigment mechanism</span></span>
<span id="cb39-2"><a href="experimentos.html#cb39-2" tabindex="-1"></a>  <span class="fu">declare_measurement</span>(<span class="at">Y =</span> <span class="fu">reveal_outcomes</span>(Y <span class="sc">~</span> Z)) <span class="co"># reveal_outcomes é a switching equation</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="experimentos.html#cb40-1" tabindex="-1"></a>estimator <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z, <span class="at">inquiry =</span> <span class="st">&quot;ATE&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="experimentos.html#cb41-1" tabindex="-1"></a>two_arm_trial <span class="ot">&lt;-</span> model <span class="sc">+</span></span>
<span id="cb41-2"><a href="experimentos.html#cb41-2" tabindex="-1"></a>  inquiry <span class="sc">+</span></span>
<span id="cb41-3"><a href="experimentos.html#cb41-3" tabindex="-1"></a>  data <span class="sc">+</span></span>
<span id="cb41-4"><a href="experimentos.html#cb41-4" tabindex="-1"></a>  estimator</span>
<span id="cb41-5"><a href="experimentos.html#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="experimentos.html#cb41-6" tabindex="-1"></a><span class="co"># Draw a simulated dataset </span></span>
<span id="cb41-7"><a href="experimentos.html#cb41-7" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">draw_data</span>(two_arm_trial), <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##     ID X            U        Y_Z_0       Y_Z_1 Z            Y
## 1  001 0  0.013136040  0.013136040  0.21313604 1  0.213136040
## 2  002 0  0.306059991  0.306059991  0.50605999 0  0.306059991
## 3  003 0  0.248393137  0.248393137  0.44839314 1  0.448393137
## 4  004 0  0.037319115  0.037319115  0.23731912 0  0.037319115
## 5  005 0  0.352668514  0.352668514  0.55266851 0  0.352668514
## 6  006 0  0.364146534  0.364146534  0.56414653 1  0.564146534
## 7  007 0  0.366437409  0.366437409  0.56643741 1  0.566437409
## 8  008 0 -0.280273943 -0.280273943 -0.08027394 1 -0.080273943
## 9  009 0 -0.007617163 -0.007617163  0.19238284 0 -0.007617163
## 10 010 0  0.195182802  0.195182802  0.39518280 1  0.395182802</code></pre>
<p>Após declarar um desenho de pesquisa, podemos diagnosticar se nosso desenho de pesquisa pode ser respondido adequadamente (isto é, se é identificável, se possui poder para estimar com precisão o efeito de interesse etc.). Podemos inclusive modificar o desenho para responder a outras perguntas (é generalizável para outras populações, diferentes estimadores desempenham melhor etc.)</p>
<p>Eis um exemplo de diagnóstico:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="experimentos.html#cb43-1" tabindex="-1"></a><span class="fu">diagnose_design</span>(two_arm_trial, <span class="at">sims =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## 
## Research design diagnosis based on 100 simulations. Diagnosis completed in 1 secs. Diagnosand estimates with bootstrapped standard errors in parentheses (100 replicates).
## 
##         Design Inquiry Estimator Outcome Term N Sims Mean Estimand
##  two_arm_trial     ATE estimator       Y    Z    100          0.20
##                                                             (0.00)
##  Mean Estimate   Bias SD Estimate   RMSE  Power Coverage
##           0.20   0.00        0.05   0.05   0.99     0.95
##         (0.00) (0.00)      (0.00) (0.00) (0.01)   (0.02)</code></pre>
<p>Podemos ajustar o desenho de pesquisa</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="experimentos.html#cb45-1" tabindex="-1"></a>designs <span class="ot">&lt;-</span> <span class="fu">redesign</span>(two_arm_trial, <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>))</span>
<span id="cb45-2"><a href="experimentos.html#cb45-2" tabindex="-1"></a><span class="fu">diagnose_design</span>(designs)</span></code></pre></div>
<pre><code>## 
## Research design diagnosis based on 500 simulations. Diagnosis completed in 7 secs. Diagnosand estimates with bootstrapped standard errors in parentheses (100 replicates).
## 
##    Design   N Inquiry Estimator Outcome Term N Sims Mean Estimand Mean Estimate
##  design_1 100     ATE estimator       Y    Z    500          0.20          0.20
##                                                            (0.00)        (0.00)
##  design_2 200     ATE estimator       Y    Z    500          0.20          0.20
##                                                            (0.00)        (0.00)
##  design_3 300     ATE estimator       Y    Z    500          0.20          0.20
##                                                            (0.00)        (0.00)
##  design_4 400     ATE estimator       Y    Z    500          0.20          0.20
##                                                            (0.00)        (0.00)
##  design_5 500     ATE estimator       Y    Z    500          0.20          0.20
##                                                            (0.00)        (0.00)
##    Bias SD Estimate   RMSE  Power Coverage
##   -0.00        0.05   0.05   0.97     0.94
##  (0.00)      (0.00) (0.00) (0.01)   (0.01)
##    0.00        0.05   0.05   0.98     0.95
##  (0.00)      (0.00) (0.00) (0.01)   (0.01)
##   -0.00        0.05   0.05   0.97     0.95
##  (0.00)      (0.00) (0.00) (0.01)   (0.01)
##   -0.00        0.05   0.05   0.98     0.95
##  (0.00)      (0.00) (0.00) (0.01)   (0.01)
##   -0.00        0.05   0.05   0.98     0.96
##  (0.00)      (0.00) (0.00) (0.01)   (0.01)</code></pre>
</div>
<div id="exercício" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Exercício<a href="#exerc%C3%ADcio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O exercício abaixo é uma tradução de questões que estavam presentes no exame de qualificação (prelims) da área de métodos do programa de doutorado em ciência política de Yale.</p>
<div id="experimento-com-envio-de-cartões-postais-e-participação-eleitoral" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Experimento com envio de cartões-postais e participação eleitoral<a href="#experimento-com-envio-de-cart%C3%B5es-postais-e-participa%C3%A7%C3%A3o-eleitoral" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Você conduz um experimento aleatório para testar o efeito de um cartão-postal sobre a participação eleitoral, sorteando independentemente uma moeda para cada sujeito com probabilidade <span class="math inline">\(0 &lt; p &lt; 1\)</span> de receber o tratamento. Assuma o pressuposto de SUTVA (Stable Unit Treatment Value Assumption). Você estima o seguinte modelo por Mínimos Quadrados Ordinários (OLS):</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 T_i + \beta_2 S_i + \beta_3 T_i S_i + u_i
\]</span></p>
<p>em que:
- <span class="math inline">\(Y_i\)</span> indica se o indivíduo votou (variável dependente);
- <span class="math inline">\(T_i\)</span> é o indicador binário de tratamento (receber ou não o cartão-postal);
- <span class="math inline">\(S_i\)</span> é um indicador binário que vale 1 se o indivíduo vive em um estado eleitoralmente competitivo (battleground state) e 0 caso contrário;
- <span class="math inline">\(T_i S_i\)</span> é a interação entre o tratamento e o contexto competitivo.</p>
<div id="a-interprete-os-quatro-coeficientes-beta" class="section level4 hasAnchor" number="4.8.1.1">
<h4><span class="header-section-number">4.8.1.1</span> (a) Interprete os quatro coeficientes <span class="math inline">\(\beta\)</span><a href="experimentos.html#a-interprete-os-quatro-coeficientes-beta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: média de <span class="math inline">\(Y_i\)</span> (taxa de votação) para o grupo controle (<span class="math inline">\(T_i = 0\)</span>) em estados não competitivos (<span class="math inline">\(S_i = 0\)</span>).</li>
<li><span class="math inline">\(\beta_1\)</span>: efeito médio do tratamento (cartão-postal) em estados <strong>não competitivos</strong>. Como o tratamento foi atribuído aleatoriamente, <span class="math inline">\(\beta_1\)</span> tem interpretação causal.</li>
<li><span class="math inline">\(\beta_2\)</span>: diferença na taxa média de votação entre estados competitivos e não competitivos <strong>no grupo controle</strong>. Não tem interpretação causal.</li>
<li><span class="math inline">\(\beta_3\)</span>: diferença no efeito do tratamento entre estados competitivos e não competitivos. Se <span class="math inline">\(\beta_3 \neq 0\)</span>, o efeito do cartão-postal depende do tipo de estado. Como o tratamento é aleatório, <span class="math inline">\(\beta_3\)</span> também tem interpretação causal.</li>
</ul>
</div>
<div id="b-como-testar-a-hipótese-de-que-o-efeito-do-tratamento-é-igual-entre-os-dois-tipos-de-estado" class="section level4 hasAnchor" number="4.8.1.2">
<h4><span class="header-section-number">4.8.1.2</span> (b) Como testar a hipótese de que o efeito do tratamento é igual entre os dois tipos de estado?<a href="#b-como-testar-a-hip%C3%B3tese-de-que-o-efeito-do-tratamento-%C3%A9-igual-entre-os-dois-tipos-de-estado" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Testa-se a hipótese nula <span class="math inline">\(H_0: \beta_3 = 0\)</span>. Isso pode ser feito diretamente a partir do resultado da regressão usando um teste t para o coeficiente da interação <span class="math inline">\(T_i S_i\)</span>.</p>
</div>
</div>
<div id="experimento-com-anúncios-de-tv-e-participação-eleitoral" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Experimento com anúncios de TV e participação eleitoral<a href="#experimento-com-an%C3%BAncios-de-tv-e-participa%C3%A7%C3%A3o-eleitoral" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Você quer testar se anúncios de TV aumentam a participação eleitoral. O experimento pode ser conduzido em até 16 mercados de mídia, dos quais até 8 podem ser sorteados para o grupo de tratamento. Os anúncios só podem ser exibidos para o mercado de mídia como um todo.</p>
<p>Você tem informações individuais para todos os eleitores elegíveis nesses mercados: mercado de mídia, idade, sexo, raça/etnia e participação nas duas eleições anteriores. Após a eleição, você receberá os dados atualizados sobre participação no pleito atual.</p>
<div id="a-como-alocar-aleatoriamente-os-mercados-ao-tratamento" class="section level4 hasAnchor" number="4.8.2.1">
<h4><span class="header-section-number">4.8.2.1</span> (a) Como alocar aleatoriamente os mercados ao tratamento?<a href="experimentos.html#a-como-alocar-aleatoriamente-os-mercados-ao-tratamento" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sorteie aleatoriamente 8 dos 16 mercados de mídia para o grupo de tratamento. Como o tratamento é atribuído no nível do mercado, essa é a unidade de aleatorização. Recomenda-se balancear o sorteio usando pareamento ou estratificação com base em características agregadas dos mercados (por exemplo, participação passada, composição demográfica), se houver variação relevante entre eles.</p>
</div>
<div id="b-como-analisar-esse-experimento" class="section level4 hasAnchor" number="4.8.2.2">
<h4><span class="header-section-number">4.8.2.2</span> (b) Como analisar esse experimento?<a href="experimentos.html#b-como-analisar-esse-experimento" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A análise deve ser feita no nível do mercado de mídia, que é a unidade de tratamento. Uma abordagem válida é calcular a média da taxa de votação em cada mercado e rodar uma regressão simples:</p>
<p><span class="math display">\[
\bar{Y}_j = \alpha + \tau D_j + \varepsilon_j
\]</span></p>
<p>em que:
- <span class="math inline">\(\bar{Y}_j\)</span> é a média da taxa de votação no mercado <span class="math inline">\(j\)</span>;
- <span class="math inline">\(D_j\)</span> é um indicador de tratamento para o mercado;
- <span class="math inline">\(\tau\)</span> estima o efeito médio do tratamento.</p>
<p>É possível incluir covariáveis no nível do mercado para aumentar a precisão, mas não é necessário para validade causal.</p>
<hr />
</div>
</div>
<div id="exclusão-de-participantes-em-experimentos-de-survey" class="section level3 hasAnchor" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> Exclusão de participantes em experimentos de survey<a href="#exclus%C3%A3o-de-participantes-em-experimentos-de-survey" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pesquisadores às vezes excluem participantes de um experimento de survey por:
1. Não passarem em uma checagem de atenção pré-tratamento;
2. Não passarem em uma checagem de atenção pós-tratamento;
3. Completarem o survey muito rapidamente (por exemplo, 3 desvios-padrão abaixo da média de tempo).</p>
<div id="a-se-o-interesse-é-no-efeito-médio-do-tratamento-entre-os-sujeitos-que-não-foram-excluídos-qual-dessas-estratégias-é-não-viesada" class="section level4 hasAnchor" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> (a) Se o interesse é no efeito médio do tratamento <strong>entre os sujeitos que não foram excluídos</strong>, qual dessas estratégias é não-viesada?<a href="#a-se-o-interesse-%C3%A9-no-efeito-m%C3%A9dio-do-tratamento-entre-os-sujeitos-que-n%C3%A3o-foram-exclu%C3%ADdos-qual-dessas-estrat%C3%A9gias-%C3%A9-n%C3%A3o-viesada" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Todas essas estratégias podem fornecer estimativas <strong>não viesadas</strong> para o efeito médio do tratamento entre os sujeitos que <strong>permanecem</strong> na amostra, desde que os critérios de exclusão sejam <strong>pré-tratamento</strong> ou <strong>não afetem diferencialmente</strong> os grupos de tratamento e controle. A exclusão baseada em variáveis observadas <strong>antes do tratamento</strong> (como checagem pré-tratamento ou tempo de resposta) é menos problemática.</p>
<p>Já a exclusão com base em comportamentos <strong>após</strong> o tratamento (como falha em atenção pós-tratamento) pode introduzir viés, pois pode estar correlacionada com a resposta ao tratamento.</p>
</div>
<div id="b-se-o-interesse-é-no-efeito-médio-do-tratamento-entre-todos-os-participantes-que-iniciaram-o-experimento-qual-dessas-estratégias-é-não-viesada" class="section level4 hasAnchor" number="4.8.3.2">
<h4><span class="header-section-number">4.8.3.2</span> (b) Se o interesse é no efeito médio do tratamento <strong>entre todos os participantes que iniciaram o experimento</strong>, qual dessas estratégias é não-viesada?<a href="#b-se-o-interesse-%C3%A9-no-efeito-m%C3%A9dio-do-tratamento-entre-todos-os-participantes-que-iniciaram-o-experimento-qual-dessas-estrat%C3%A9gias-%C3%A9-n%C3%A3o-viesada" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nenhuma das exclusões garante uma estimativa não viesada nesse caso. Excluir participantes com base em qualquer critério — mesmo que relacionado à atenção ou tempo de resposta — altera a composição da amostra em relação ao universo original. Para estimar o efeito médio para todos os participantes que começaram o experimento, é necessário <strong>manter todos os sujeitos</strong>, independentemente do desempenho em checagens ou tempo de resposta.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dags.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="propensity-score-e-matching.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mgaldino/Causalidade/edit/main/04-Experimentos.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mgaldino/Causalidade/blob/main/04-Experimentos.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
