[["index.html", "Curso de Inferência Causal Capítulo 1 Introdução 1.1 Revisão de Regressão 1.2 Inferência 1.3 Referências", " Curso de Inferência Causal Manoel Galdino 2025-03-26 Capítulo 1 Introdução Aqui pretendo guardar minhas notas de aula para meu curso de causalidade na pós-graduação. É uma forma de organizar e sistematizar meu estudo sobre o tema. 1.1 Revisão de Regressão Comecemos pelo modelo de regressão populacional dado por: \\[y = \\beta_0 + \\beta_1 x + u\\] As suposições básicas do modelo são: Média do erro é zero (sem perda de generalidade): \\(\\mathbb{E}[u] = 0\\) Independência na média do erro: \\(\\mathbb{E}[u|x] = \\mathbb{E}[u]\\). Essa é a suposição mais consequente do modelo de regressão. Como é sobre o termo de erro, não é testável. Um exemplo é útil para entender o que significa essa suposição. Suponha que estamos interessados no efeito do gasto de campanha (\\(x\\)) sobre o voto (\\(y\\)). O termo de erro \\(e\\) seria a qualidade da candidata, não observável. A suposição implica então que a qualidade média das candidatas que gastam 100 mil reais é a mesma das que gastam 500 mil e um milhão (e assim por diante). Se candidatas melhores arrecadam mais dinheiro e, portanto, gastam mais, a suposição foi violada. Conectando 1 e 2, temos: \\(\\mathbb{E}[u|x] = 0\\). Essa suposição é chamada de “média condicional zero” ou “esperança condicional zero” do termo de erro. Ela implica que: \\(\\mathbb{E}[y|x] = \\beta_0 + \\beta_1 x\\). Essa equação é chamada de Conditional Expectation Function, ou CEF. De posse de uma amostra aleatória simples, podemos derivar os estimadores de mínimos quadrados (MQO ou OLS na sigla em inglês). Vou pular os passos da derivação. Para nós, o importante é lembrar a fórmula do \\(\\hat{\\beta_1}\\): \\(\\hat{\\beta_1} = \\frac{\\text{covariância amostral}}{\\text{variância amostral}} = \\frac{\\sum_{i=1}^n(x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n(x_i - \\bar{x})^2}\\) E \\(\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}\\). Podemos então demonstrar que o estimador é não-viesado. Para isso, é necessário supor que o modelo é linear nos parâmetros (não nas variáveis), temos uma amostra aleatória simples da população, existe variância no preditor (para não dividir por zero na fórmula do estimador de OLS) e a média condicional zero. 1.1.1 Teorema da Anatomia da Regressão Esse teorema, também conhecido como teorema de Frisch, Waugh e Lovell ou Frisch-Waugh-Lovell, é útil para ajudar a entender regressão múltipla. Suponha que nosso modelo possui \\(2\\) preditores: \\(y_i=\\beta_0+\\beta_1 x_{1i}+ \\beta_2 x_{2i}+ e_i\\). Agora, suponha que, em vez de rodar a regressão acima, eu rodo uma regressão (chamada de auxiliar) em que \\(x_1\\) é a variável dependente, e \\(x_2\\) o único preditor. \\(x_{1i}=\\gamma_0+\\gamma_{1}x_{2i} + f_i\\). E os resíduos são dados por: \\(\\tilde{x}{1i}=x{1i} - \\widehat{x}{1i}\\). Então, é possível mostrar que: \\(\\beta_1 = \\frac{C(y_i, \\tilde{x}{1i})}{V(\\tilde{x}_{1i})}\\). O que essa fórmula nos diz é que o efeito de \\(\\beta_1\\) é a covariância entre a variável dependente e o resíduo da regressão auxiliar, isto é, a parte de \\(x_1\\) não explicada pelos demais preditores. Vamos visualizar essa relação com um exemplo do livro do Scott Cunningham: library(tidyverse) library(haven) read_data &lt;- function(df) { full_path &lt;- paste0(&quot;https://github.com/scunning1975/mixtape/raw/master/&quot;, df) haven::read_dta(full_path) } auto &lt;- read_data(&quot;auto.dta&quot;) %&gt;% mutate(length = length - mean(length)) lm1 &lt;- lm(price ~ length, auto) lm2 &lt;- lm(price ~ length + weight + headroom + mpg, auto) lm_aux &lt;- lm(length ~ weight + headroom + mpg, auto) auto &lt;- auto %&gt;% mutate(length_resid = residuals(lm_aux)) lm2_alt &lt;- lm(price ~ length_resid, auto) coef_lm1 &lt;- lm1$coefficients coef_lm2_alt &lt;- lm2_alt$coefficients resid_lm2 &lt;- lm2$residuals y_single &lt;- tibble(price = coef_lm2_alt[1] + coef_lm1[2]*auto$length_resid, length_resid = auto$length_resid) y_multi &lt;- tibble(price = coef_lm2_alt[1] + coef_lm2_alt[2]*auto$length_resid, length_resid = auto$length_resid) auto %&gt;% ggplot(aes(x=length_resid, y = price)) + geom_point() + geom_smooth(data = y_multi, color = &quot;blue&quot;) + geom_smooth(data = y_single, color = &quot;red&quot;) ## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; ## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; 1.2 Inferência Como sabemos, inferência lida com a generalização da amostra para a população e, portanto, com a variabilidade inerente de amostra para amostra. Eu não vou revisar aqui os cálculos para derivar o erro padrão. Quero apenas enfatizar dois pontos que não são usualmente abordados em cursos de regressão. Em primeiro lugar, generalização da amostra para a população é diferente de generalização causal, também conhecida como validade externa. Esse ponto foi confundido por muitos autores, em particular o livro conhecido como KKV, e levou muitos pesquisadores a acreditarem que uma regressão possuía maior capacidade de generalização causal do que estudos de caso. Uma regressão (supondo que o erro padrão foi calculado corretamente) permite generalizar as estimativas para uma população. Porém, o que significa falar em generalização quando temos o universo de casos (por exemplo, todos os deputados, ou todos os candidatos, ou todos os municípios)? Quando temos o universo, não é diferente de estudos de caso que possuem todos os casos relevantes e, portanto, a noção de generalização da amostra para população não se aplica. O que me leva ao segundo ponto: na inferência causal, em particular nesses casos em que temos o universo dos casos, ainda assim há incerteza. O trabalho de Abadie et. al (2020) discute a ideia de design-based inference. Nós vamos explicar no curso em mais detalhes o que é uma pesquisa design-based (em oposição a model-based). A ideia desse tipo de incerteza (e seu correspondente erro-padrão) é a seguinte. Imagine que estamos interessados em estimar o efeito causal da reeleição de prefeitos sobre a corrupção municipal. Suponha que tenho todos os municípios na amostra. Por fim, suponha que temos um experimento natural de forma que podemos supor que (talvez condicional a algumas variáveis) a reeleição é aleatória. Não há incerteza amostral para a população, mas há incerteza sobre o que aconteceria com a corrupção para os prefeitos reeleitos, caso não fossem reeleitos (e para os que perderam, como seria a corrupção caso fossem reeleitos). Em particular, se acreditamos que a reeleição foi aleatória, então uma nova rodada de amostragem (em um universo alternativo?) produziria outra configuração de prefeitos reeleitos e não-reeleitos e alguma variação na estimativa do efeito causal. Isso antecipa nossa discussão sobre causalidade da próxima aula, mas o ponto é que existe incerteza na variação do efeito causal, que não deriva de variação amostral propriamente, mas da aleatoriedade da intervenção. Nas palavras dos autores: “it will be useful to distinguish between descriptive estimands, where uncertainty stems solely from not observing all units in the population of interest, and causal estimands, where the uncertainty stems, at least partially, from unobservability of some of the potential outcome” (p. 267). Meu ponto é que KKV e cia confundiram incerteza de estimandos descritivos com estimandos causais. O que me leva de volta ao ponto anterior sobre a comparação entre estudos de caso e métodos quantitativos, quando o objetivo é inferência causal. A incerteza inerente é sobre o efeito da intervenção, não sobre variações amostrais. Além disso, em ambos os casos não sabemos (a princípio) se os estudos possuem validade externa, isto é, se os resultados valem para outras populações, no tempo e espaço. É preciso avançar nessa agenda, tanto em métodos quali como quanti. É um problema em aberto e que tem atraído muitas pesquisas novas, que não iremos cobrir no curso (até por desconhecimento meu de boa parte dessa literatura). 1.3 Referências Abadie, Alberto, Susan Athey, Guido W. Imbens, and Jeffrey M. Wooldridge. 2020. “Sampling-Based Versus Design-Based Uncertainty in Regression Analysis.” Econometrica 88 (0): 265–96. "],["resultados-potenciais.html", "Capítulo 2 Resultados Potenciais 2.1 Causalidade e o Método Comparativo 2.2 Potential Outcomes 2.3 Notação 2.4 Problema Fundamental da Inferência Causal 2.5 Estimando 2.6 Estimandos Mais Comuns 2.7 Nota sobre estimandos 2.8 Exercício - Qual o estimando e o estimador (se possível)? 2.9 Identificação 2.10 Identificação do ATE 2.11 Equações estruturais 2.12 Modelo versus Desenho 2.13 Referências", " Capítulo 2 Resultados Potenciais Durante muito tempo, inferência causal com regressão era caracterizada por recomendações vagas, ad hoc e inconsistências. O debate sobre o efeito causal do cigarro sobre câncer de pulmão é ilustrativo a esse respeito. Durante décadas, pesquisadores enfrentaram dificuldades para diferenciar correlação de causalidade em estudos epidemiológicos sobre tabagismo. Muitos estudos iniciais baseados apenas em correlação eram contestados por não apresentarem mecanismos claros ou critérios objetivos para validar inferências causais. Fisher (1958), por exemplo, questionou os resultados iniciais que ligavam o cigarro ao câncer por falta de critérios explícitos para identificar uma relação causal, argumentando que a correlação observada poderia decorrer de fatores confundidores, causalidade reversa ou problemas de mensuração. A situação mudou gradualmente com contribuições metodológicas importantes, como os critérios de causalidade propostos por Hill (1965). Os critérios de Bradford Hill ofereceram uma lista explícita e sistemática para avaliar a plausibilidade causal em estudos observacionais: O efeito deveria ser grande reproduzível em estudos independentes possuir uma relação monotônica com “dose” (isto é, aumento na dose não pode reduzir o efeito se o efeito é positivo e vice-versa se for negativo). corresponde a um “experimento natural”” se comporta apropriadamente quando a causa é aplicada, removida e então reinstalada. é consistente com o conhecimento especializado do tema é, por exemplo, predita por alguma teoria bem estabelecida. Nós temos amplas evidências de que muitas intervenções são causais, mesmo na ausência de qualquer experimento aleatório controlado. Sabemos, por exemplo, que defribilação, manobra de Heimlinch e uso de paraquedas são eficazes para prevenir mortes [@howick_etal_2009]. Em um artigo clássico dos primórdios da estatística escrito por Yule [@yule_1989], temos um dos primeiros exemplos de utilização da regressão para estudar o efeito causal do efeito de uma política (ajuda sobre pobreza). E a despeito do título do artigo falar em causalidade (“An investigation into the causes of changes in pauperism in england, chiefly during the last two intercensal decades”), a certa altura ele diz, em nota de rodapé, que “due to” deve ser lido como “associated to”. Quase cem anos depois, o grande estatístico Cox afirmaria em um artigo sobre causalidade: “it is remarkable how relatively little causality is mentioned in the general statistics literature, except in a social science context”[@cox_1992, p. 292]. Exemplo da perspectiva de que falava Cox quando, por exemplo, @muthen_1987 chegou a afirmar que “It would be very healthy if more researchers abandon thinking of and using terms such as cause and effect” (p. 180). Algo ecoado em uma entrevista com um dos líderes da evolução causal desde os anos 70/80, Jamie Robins, que relata que seus papers (en journals de estatística) eram rejeitados por usar linguagem causal, algo rejeitado na época [@robins_2022]. Então parece bastante seguro dizer que a sensação geral na estatística até os anos 80 é que não se deveria usar linguagem causal fora de estudos experimentais, isto é, em estudos não-observacionais. 2.1 Causalidade e o Método Comparativo A ideia de causalidade é bastante presente na ciência política na literatura de polític comparada qualitativa. Empregando os métodos advogados por Stuart Mill, a ideia de causalidade sempre estive presente e associada a ideias de relações necessárias e ou suficientes. Nesse sentido, causalidade seria determiniística. A moderna forma de pensar causalidade abandona esse paradigma de relações necessárias e/ou suficientes, para pensar em termos de contrafactual, o que no fundo é próximo do que a pesquisa comparada fazia. Tomemos um exemplo clássico dessa literatura. [inserirautor] estava interessado em estudar o efeito ccausal de [inserir variável de tratamento] sobre [variável de resultado], e comparou [unidade de tratamento] com [unidade de controle]. 2.2 Potential Outcomes Objetivos de aporendizado da aula: Aprender a diferença entre esimando, estimador e estimativa. Aprender as condições de identificação do ATE (Average Treatment Effect) 2.3 Notação Vamos assumir que existe um tratamento binário, que recebe o valor \\(1\\) se a unidade \\(i\\) recebe o tratamento, e \\(0\\) caso contrário, dado por: \\(D_i \\in \\{1,0\\}\\). Suponha que eu tenha \\(N\\) unidades que podem receber o tratamento ou controle. Então, o resultado potencial para a unidade \\(i\\) é \\(Y_i(\\mathbf{D})\\), ou seja, o resultado (potencial) da unidade \\(i\\) dado o conjunto de tratamento recebido por todas as \\(N\\) unidades. Em outras palavras, o resultado potencial depende do status de tratamento de todas as unidades. O que nos leva à primeira suposição simplificadoras: Assumption 1 (Stable Unit Treatment Value Assumption) Se \\(D_i = D{&#39;}_i\\), então \\(Y_i(\\mathbf{D}) = Y_i(\\mathbf{D}^{&#39;})\\). Em palavras, se mudarmos o tratamento de \\(i\\) de \\(D\\) para \\(D&#39;\\), então o resultado potencial depende apenas dessa mudança, e não dos demais tratamentos. Ou seja, o resultado potencial depende apenas do próprio tratamento, não dos demais. Essa suposição també é chamada de não-interferência. Então podemos escrever o resultado potencial apenas como função de \\(D_i\\): \\(Y_i(D_i)\\). Entretanto, os resultados potenciais não são observáveis. O que nós observamos é o resultado se a pessoa foi ou não tratada. O que nos leva à “switching equation”: \\(Y_i = Y_i(1)D_i + (1-D_i)Y_i(0)\\) Podemos agora definir o efeito causal do tratamento ao nível da unidade: \\(\\tau_i = Y_i(1) - Y_i(0)\\) A switching equation conecta o observado aos resultados potenciais e vice-versa. Esse modelo é chamado de Modelo Causal de Neyman-Rubin. 2.4 Problema Fundamental da Inferência Causal Barizado por Holland (1986) de Problema Fundamental da Inferência Causal (PFIC) diz que não podemos observar, simultanemente, ambos os resultados potenciais \\(Y_i(1)\\) e \\(Y_i(0)\\). Possívels soluções para o PFIC: Assumir homogeneidade temporal (comparação antes de depois da mesma unidade) Assumir homogeneidade da unidade (comparar dois indivíduos, um tratado, outro no controle) Método estatístico (foco na esperança) 2.5 Estimando O que nós estamos interessados em estimar é o nosso Estimando. Lundberg et al. (2021), definem de maneira bem completa o que é um estimando. Informalmente, é a quantidade causal que queremos estimar. Os autores separam o estimando teórico do estimando estatístico. O estimando teórico especifica a unidade teórica de interesse (ex.: o efeito de instituicões inclusivas sobre o desenvolvimento economômico do país \\(i\\); “A Dilma teria sofrido impeachment se a lava-jato não existisse?”). O segundo componente é a população-alvo. Se formos agregar essa unidade, é sobre quem ou quê? No primeiro caso, é a categoria de países em desenvolvimento em 1990? Todos os países independentes do globo no seçulo XX? No segundo caso, é mais difícil pensar qual é a população alvo. Talv ez já seja a população e, nesse caso, nao cabe se perguntar sobre qume agregaríamos a quantidade. Ou talvez a pergunta de pesquisa seja sobre crises econômicas e impeachment, e o Brasil é só um caso. Daí a população alvo pode ser, talvez, países latino-americanos. Nesse caso, a pesquisadora deverá argumentar sobre como o estudo de caso é informativo sobre a população-alvo. Estimando estatístico ou empírico é a quantidade que pode ser estimada estatisticamente (a princípio). Estimativa: a aproximação do estimando usando uma amostra finita de dados Estimador: o método ou fórmula para se chegar a uma estimativa para um estimando. 2.6 Estimandos Mais Comuns 2.6.1 ATE Vamos definir o ATE e mostrar condições suficientes para identificação desse estimando. O ATT é simplesmente o efeito causal médio entre todos os indivíduos de uma população. Às vezes chamado de PATE, de Populational Averate Treatment Effect. Definição 2.1. Chamamos de ATE na população: \\[\\tau_{\\text{ATE}} = \\mathbb{E}[\\tau_i] = \\mathbb{E}[Y_i(1) - Y_i(0)] = \\mathbb{E}[Y_i(1)] - \\mathbb{E}[Y_i(0)]\\] O ATE nos dá o efeito do tratamento em toda a população de interesse. 2.6.2 ATT Definição 2.2. Chamamos de Average Treatment Effect on the Treated (ATT): \\[\\tau_{\\text{ATT}} = \\mathbb{E}[\\tau_i|D_i=1] = \\mathbb{E}[Y_i(1) - Y_i(0)|D_i=1] = \\underbrace{\\mathbb{E}[Y_i(1)|D_i=1]}_{\\text{observado}} - \\mathbb{E}[Y_i(0)|D_i=1]\\] Note que \\(\\mathbb{E}[Y_i(1)|D_i=1]\\) é um resultado potencial que podemos observar, já que é igual ao resultado realizado dos tratados. Esse estimando estima o efeito do tratamento apenas entre os tratados. Essa quantidade é, tipicamente, a mais relevante em políticas públicas. Considere a política pública de vacinação. O que é mais importante, saber o efeito causal da vacina em toda a população, ou em toda a população que tomaria a vacina (tratados)? Ou para dar um exemplo mais claro ainda. Não é relevante o efeito do bolsa-famnília sobre redução da pobreza em toda a população, nem mesmo se considerarmos que a população alvo é toda a população pobre. Pessoas que não vão participar do programa não importam muito. Importam as que efetivamente irão receber o programa. 2.6.3 CATE Vamos definir o Conditional Average Treatment Effect (CATE). Seja \\(X_i\\) um conjunto de co-variáveis pré-determinadas (não causadas pelo tratamento). Então, podemos definir o CATE como: \\[\\tau_{\\text{CATE}} = \\mathbb{E}[\\tau_i|X_i=x] = \\mathbb{E}[Y_i(1) - Y_i(0)|X_i=x] = \\mathbb{E}[Y_i(1) - \\mathbb{E}[Y_i(1)|X_i=x]\\] Retornando ao nosso exemplo da introdução da urna eletrônica em um município sobre a pobreza municipal. ATE: O efeito médio de um município ter urna eletrônica sobre a pobreza municipal comparado a voto em papel. ATT: O efeito médio da urna eletrônica nos municípios que receberam urna eletrônica sobre a pobreza municial comparado a voto em papel. CATE: O efeito médio de urna eletrônica sobre a pobreza municipal, em um determinado grupos de municípios (ex. do semiá-rido do Nordeste), comparado a voto em papel. Se \\(X\\) for discreto, podemos estabelecer a seguinte relação entre ATE e CATE: \\[\\tau_{\\text{ATE}} = \\sum_{x \\in X} \\tau_{\\text{CATE}}(x) p(X_i = x)\\] Há outros estimandos possíveis, mas esses são os mais comuns. 2.7 Nota sobre estimandos A rigor, podemos caracterizar ao nível da população dois contrastes: a distribuição de probabilidade de resultados potenciais do tratamento com a do controle, para um dado conjunto de covariáeis de pré-tratamento \\(\\mathbf{X}\\). Formalmente, sejam \\(f(Y(1)|\\mathbf{X})\\) e \\(f(Y(0)|\\mathbf{X})\\) as densidades dos dois resultados potenciais, então \\(f(Y(1)|\\mathbf{X} - f(Y(0)|\\mathbf{X})\\) configura uma nova distribuição, da diferença entre os dois resultados potenciais. Nossa ênfase na esperança, portanto, é tanto uma questão de conveniência matemática quanto potencial interesse de pesquisa em um estimando em torno da média da diferença dessas duas distribuições, mas nada impede, a princípio, que estimarmos toda a distribuição da diferença. Outra observação: como veremos mais para frente no curso, dados longitudinais não possuem estimandos claros. Alguns pesquisadores mais rigorosos em política comparada, por exemplo, falam em efeito de país-ano, pois esta é a unidade de análise e o estimando é definido nesse nível. Como veremos também mais para frente (e é um tema de pesquisa meu), também é complicado definir as condições de identificação em dados longitudinais. Voltaremos a isso. 2.8 Exercício - Qual o estimando e o estimador (se possível)? Abstract 1 Abstract 2 Abstract 3 2.9 Identificação “Econometric identification really means just one thing: model parameters or features being uniquely determined from the observable population that generates the data”(Lwebel, apud Paul GP). Ou seja, se você tiver acesso a uma amostra infinita, isto é, não há problemas inferenciais de amostra pequena, é possível estimar precisamente o parâmetro de interesse? Dizemos que, nesse caso, o estimando é identificável. O que seria um estimando não-identificável? Digamos que estou interessado em estimar o efeito causal da segunda dose de uma vacina sobre internação por uma doença. Para a pessoa receber a segunda dose, obviamente ela precisa receber a primeira. Suponha que a primeira dose ajuda a reduzir a internação. É impossível estimar o efeito causal da segunda dose. Para mostrar que o ATE é identificado, vamos supor o que chamamos de ignorabilidade forte (strong ignorability). Definição. Dizemos que \\(D_i\\) é fortemente ignorável condicional a um vetor \\(\\mathbf{X_i}\\) se: 1. \\(Y_i(1), Y_i(0) \\perp D_i\\) 2. \\(\\exists \\epsilon &gt; 0 \\text{ tal que } \\epsilon &lt; Pr(D_i = 1 | \\mathbf{X_i}) &lt; 1 - \\epsilon\\) Em palavras, a primeira condição diz que os resultados potenciais são independentes de receber ou não o tratamento. Quando pensamos em modelos com seres humanos ou unidades com agência, a principal preocupação é que as unidades não se auto-selecionam no tratamento que lhes é mais benéfico (ou que acreditam sê-lo). Às vezes na literatura essa condição aparece como permutabilidade (exchangeability): Como dizem Hernan e Robins em seu livro, “the treated and the untreated are exchangeable because the treated, had they remained untreated, would have experienced the same average outcome as the untreated did, and vice versa.”(p. 29). A segunda condição, conhecida como commmon support ou overlaping condition, diz que não existe unidade que não possa receber o tratamento ou controle. Essa condição é mais forte do que a positividade (toda unidade tem probabilidade positiva de receber o tratamento). Quero explorar aqui essa condição por meio de uma simulação. Vamos supor que um efeito causal \\(\\tau_i\\) tem distribuição normal com média \\(2\\) e desvio-padrão \\(2\\). E vamos supor que pessoas com \\(\\tau_i &gt;6\\) não podem receber o tratatamento, apenas o controle. Veremos que o efeito causal para esse subgrupo não é identificado e mesmo o ATE não é identificado. ## d1 ## d 0 1 ## 0 5019 0 ## 1 396 4585 ## [1] 2.013731 ## [1] 1.37696 Um último comentário: ignorability às vezes aparece como “tratamento é exógeno”. Porém, exogeneidade ignora a segunda condição e trata apenas da primeira. Em uma audiência de ciência política, dizemos que o tratamento é condicionalmente aleatório ou exógeno (o que é impreciso). 2.10 Identificação do ATE Teorema 1: Se \\(D_i\\) é fortemente ignorável condicional a \\(\\mathbf{X_i}\\), então: \\[\\mathbb{E}[\\tau_i] = \\sum_{x \\in X}(\\mathbb{E}[(Y_i|D_i=1, \\mathbf{X_i} = x)] - \\mathbb{E}[(Y_i|D_i=0, \\mathbf{X_i} = x)])Pr(\\mathbf{X_i = x})\\] Prova: O ATE foi definido como: \\[\\mathbb{E}[\\tau_{\\text{ATE}}] = \\mathbb{E}[\\tau_i] = \\mathbb{E}[Y_i(1)] - \\mathbb{E}[Y_i(0)]\\] Pela LIE, temos que: \\[\\mathbb{E}[Y_i(1)] = \\mathbb{E}[\\mathbb{E}[Y_i(1)|\\mathbf{X_i}]\\] \\[\\mathbb{E}[Y_i(0)] = \\mathbb{E}[\\mathbb{E}[Y_i(0)|\\mathbf{X_i}]\\] Com ignorabilidade forte, \\(\\mathbb{E}[(Y_i(0)|\\mathbf{X_i}] = \\mathbb{E}[Y_i(0)|D_i=0, \\mathbf{X_i}] = \\mathbb{E}[Y_i|D_i=0, \\mathbf{X_i}]\\). Similarmente, \\(\\mathbb{E}[(Y_i(1)|\\mathbf{X_i}] = \\mathbb{E}[Y_i(1)|D_i=1, \\mathbf{X_i}] = \\mathbb{E}[Y_i|D_i=1, \\mathbf{X_i}]\\). Juntando tudo, chegamos à proposição do teorema. Ou seja, com ignorabilidade forte, podemos estimar o ATE não-parametricamente apenas a partir de observáveis. O CATE também é identificado, como corolário. 2.11 Equações estruturais Normalmente nós temos um modelo que queremos estimar o efeito causal, e não algo sobre o mecanismo de assignment do tratamento. Vamos conectar as duas abordagens. Seja o modelo: \\(Y_i = \\alpha + \\beta D_i + \\epsilon_i\\). Nós intrepretamos \\(\\beta\\) como a diferença média no \\(y\\) de uma unidade no tratamento, formalmente: \\(\\mathbb{E}[Y|D_i=1] - \\mathbb{E}[Y|D_i=0] = \\mathbb{E}[\\alpha + \\beta D_i + \\epsilon_i|D_i=1] - \\mathbb{E}[\\alpha + \\beta D_i + \\epsilon_i|D_i=0] = \\beta + \\mathbb{E}[\\epsilon_i|D_i=1] - \\mathbb{E}[\\epsilon_i|D_i=0]\\). E dizemos que, sob a suposição de esperança condicional zero do erro, ou seja, \\(\\mathbb{E}[\\epsilon_i|D_i=1] = \\mathbb{E}[\\epsilon_i|D_i=0] = 0\\). Portanto, temos que \\(\\mathbb{E}[Y|D_i=1] - \\mathbb{E}[Y|D_i=0] = \\beta\\). E o estimador de MQO é não-viesado. E de forma geral, temos que \\(\\mathbb{E}[Y|D_i] = \\alpha + \\beta\\), sob a suposição de esperança condicional zero do erro. Vamos mapeá-lo ao modelo de resultados potenciais com a switching equation. \\[ \\begin{aligned} Y_i &amp;= Y_i(0)(1-D_i) + Y_i(1)D_i \\\\ &amp;= Y_i(0) + \\tau_i D_i \\\\ &amp;= Y_i(0) + \\tau_i D_i + \\tau D_i - \\tau D_i\\\\ &amp;= Y_i(0) + \\tau D_i + (\\tau_i - \\tau)D_i \\\\ &amp;= \\mathbb{E}[Y_i(0)|D_i=0] - \\mathbb{E}[Y_i(0)|D_i=0] + Y_i(0) + \\tau D_i + (\\tau_i - \\tau)D_i \\\\ &amp;= \\underbrace{\\mathbb{E}[Y_i(0)|D_i=0]}_{\\alpha} + \\underbrace{\\tau}_{\\beta} D_i + \\underbrace{(\\tau_i - \\tau)D_i + (Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])}_{\\epsilon_i} \\\\ \\end{aligned} \\] Nós sabemos que em uma regressão estamos estimando \\(\\mathbb{E}[Y_i|D_i]\\). Podemos agora ver com clareza o que de fato estamos estimamos em termos causais. \\[ \\begin{aligned} \\mathbb{E}[Y_i|D_i=1] &amp;= \\alpha + \\tau + \\mathbb{E}[\\epsilon_i|D_i=1] \\\\ \\mathbb{E}[Y_i|D_i=0] &amp;= \\alpha + \\mathbb{E}[\\epsilon_i|D_i=0] \\\\ \\mathbb{E}[\\epsilon_i|D_i=1] &amp;= \\mathbb{E}[(\\tau_i - \\tau)D_i + (Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])|D_i=1] \\\\ &amp;= \\mathbb{E}[(\\tau_i - \\tau)D_i|D_i=1] + \\mathbb{E}[(Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])|D_i=1] \\\\ &amp;= \\mathbb{E}[\\tau_i D_i|D_i=1] -\\tau\\mathbb{E}[ D_i|D_i=1] + \\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[\\mathbb{E}[Y_i(0)|D_i=0]|D_i=1] \\\\ &amp;= (\\mathbb{E}[\\tau_i|D_i=1] -\\tau) + \\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] \\\\ \\mathbb{E}[\\epsilon_i|D_i=0] &amp;= \\mathbb{E}[(\\tau_i - \\tau)D_i + (Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])|D_i=1] \\\\ &amp;= \\mathbb{E}[Y_i(0)|D_i=0] - \\mathbb{E}[\\mathbb{E}[Y_i(0)|D_i=0]|D_i=0] \\\\ &amp;= 0 \\end{aligned} \\] Portanto, \\(\\mathbb{E}[Y_i|D_i=1] - \\mathbb{E}[Y_i|D_i=0] = \\tau + (\\mathbb{E}[\\tau_i|D_i=1] -\\tau) + \\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0]\\) Em palavras, estimamos o efeito causal médio, \\(\\tau\\), mais um componente que tem a ver com os efeitos causais heterogêneos mais um componente que é a diferença no resultado potencial do controle entre os tratados e o controle. Se \\(\\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] \\neq 0\\), o efeito estimado é viesado. Similarmente, se \\(\\mathbb{E}[\\tau_i|D_i=1] \\neq \\tau\\), também teremos viés, ou seja, se o efeito causal dos tratados for diferente do efeito médio da população, também temos uma estimativa viesada do ATE. Porém, nesse caso, note que estamos viesando para estimar o efeito médio dos tratados, que é o ATT. Para ver isso, suponha que não há diferença nos resultados potenciais de não receber o tratamento entre os tratados e os no grupo controle, de modo que \\(\\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] = \\tau + (\\mathbb{E}[\\tau_i|D_i=1] -\\tau) = \\mathbb{E}[\\tau_i|D_i=1]\\), que é o ATT. 2.12 Modelo versus Desenho Há na literatura (mais de economia) uma distinção entre estimando baseado em modelos e baseado em designs (desenho). Model-based: O estimando é identificado a partir de um modelo dos resultados potenciais, condicional ao tratamento e co-variáveis. O exemplo arquetípico é modelo de diferença em diferenças ou controle sintético, em que estimamos o efeito causal a partir de estimativa do contrafactual a partir de dados observados. Design-based: O estimando é identificado a partir de suposições sobre o mecanismo de atribuição do tratamento e co-variáveis. O exemplo arquetípico desse tipo de pesquisa é o experimento aleatório controlado. 2.13 Referências Lundberg, I., Johnson, R., &amp; Stewart, B. M. (2021). What is your estimand? Defining the target quantity connects statistical evidence to theory. American Sociological Review, 86(3), 532-565. Paul W Holland. Statistics and causal inference. Journal of the American statistical Association, 81(396):945–960, 1986. "],["dags.html", "Capítulo 3 DAGs", " Capítulo 3 DAGs "],["experimentos.html", "Capítulo 4 Experimentos", " Capítulo 4 Experimentos "],["matching.html", "Capítulo 5 Matching", " Capítulo 5 Matching "],["variáveis-instrumentais.html", "Capítulo 6 Variáveis Instrumentais", " Capítulo 6 Variáveis Instrumentais "],["desenho-de-regresão-discontínua.html", "Capítulo 7 Desenho de Regresão Discontínua", " Capítulo 7 Desenho de Regresão Discontínua "],["diferença-em-diferenças.html", "Capítulo 8 Diferença em Diferenças", " Capítulo 8 Diferença em Diferenças "],["synthetic-control.html", "Capítulo 9 Synthetic Control 9.1 Implementação no R", " Capítulo 9 Synthetic Control Suponha que obtivemos dados para \\(J+1\\) unidades para unidades \\(j = 1, 2, ..., J+1\\), e sem perda de generalidade, a primeira unidade \\(j=1\\) é a de tratamento ou sob intervenção. O potencial de unidades para comparação é dado por \\(j = 2, ..., J+1\\), uma coleção de unidade não-tratadas. Os dados sõa observados por \\(T\\) períodos \\(1, 2, ..., t_0, t_1, t_2, ..., T\\), em que de \\(1\\) até \\(t_0\\) nenhuma unidade foi tratada ou sofreu intervenção. Para cada unidade \\(j\\), observamos também um conjunto de \\(k\\) preditores, \\(X_{1j}, X_{2j}, ..., X_{kj}\\), que pode incluir vaores pré-intervenção da variável resposta \\(y_{jt}\\). 9.1 Implementação no R # install.packages(&#39;scpi&#39;) "],["interferência-spillover-e-dinâmica.html", "Capítulo 10 Interferência, spillover e dinâmica 10.1 Suposições simplifcadoras 10.2 PO com tratamento de múltiplos valores (multi-valued) 10.3 Dinâmica 10.4 Interferência", " Capítulo 10 Interferência, spillover e dinâmica Agora iremos relaxar algumas simplifcações do modelo de Resultados potenciais que vimos até agora. 10.1 Suposições simplifcadoras Tratamento binário Único período de tempo (um tratamento “within unit” ) SUTVA 10.2 PO com tratamento de múltiplos valores (multi-valued) 10.2.1 Multi-valued discreto Vamos estender o modelo de tratamewnto binário começando por tratamentos discretos. Digamos que temos \\(D_i \\in \\{0, 1, ..., d\\}\\), isto é, tratamentos ordenados. Por exemplo, múltiplas categorias de uma política pública (100 reais, 200 reais, 300 reais etc.). Definimos o resultado potencial da unidade \\(i\\) para qualquer \\(d \\in D\\) como \\(Y_i(d)\\) Nós vamos precisar da suposição de ignorability forte. \\(\\tau_i(D, D&#39;) = Y_i(d) - Y_i(d&#39;)\\), ou seja, o efeito causal entre dois níveis do tratamento. Como antes, podemos computar a esperança: \\(\\mathbb{E}[\\tau_i(D, D&#39;)] = \\mathbb{E}[Y_i(d) - Y_i(d&#39;)]\\). E se ignorability forte vale, então \\(\\mathbb{E}[\\tau_i(D, D&#39;)] = \\mathbb{E}[Y_i|D_i = d] - \\mathbb{E}[Y_i|D_i = d&#39;]\\) Se quisermos, podemos trabalhar também com tratamentos não-ordenados. Por exemplo, dois tratamentos binários. Por exemplo, um tratamento é informação sobre corrupção de um candidato (recebe ou não a informação) e outro tratamento é informação sobre a raça do candidato (é branco ou não). \\(D_i \\in \\{0,1}^2\\}\\). Podemos modelar os resultados potenciais como dependendo do status dos dois tratamentos: \\(Y_i(D_{i1}, D_{i2})\\) que geram quatro possibilidades ou resultados potenciais: \\(Y(0,0)\\), \\(Y(1,0)\\), \\(Y(0,1)\\), \\(Y(1,1)\\). Exemplo onde mesmo com atribuição aleatória, há efeitos não-identificados. Aleatoriamente atribuir \\(D_1\\) e, para os que receberam \\(D_1\\), aleatoriamente atribui \\(D-2\\). Onde isso poderia acontecer? Primeira e segunda dose de vacina! Por definição, a segunda dose só é dada para quem recebeu a primeira dose. Nunca é possível estimar efeito relativo a \\(Y_i(0,1)\\), isto é, o resultado potencial de quem não recebeu a primeira dose, mas recebeu a segunda. Essa é uma pessoa que recebeu a primeira dose quando a segunda estava sendo aplicada. 10.3 Dinâmica Considere que agora nós observamos \\(T\\) períodos de tempo para uma unidade: \\(Y_i\\) = (Y_{i1}, Y_{i2}, …, Y_{iT}). Para cada período, há um tratamento \\(D_{it} \\in \\{0,1\\}\\), isto é, sempre binário. Chamamos de \\(\\mathbf{D_i} = (D_{i1}, D_{i2}, ..., D_{iT})\\) o vetor de tratamentos em todos os \\(T\\) períodos. Implicitamente, muitas pessoas abordam modelos dinâmicos supondo que podemos olhar apenas para o resultado pontencial para a unidade \\(i\\) no período \\(t\\), ou seja, \\(Y_{it}(D_{it})\\). Porém, isso significa que apenas o tratamento do período \\(t\\) impacta o resultado potencial do período \\(t\\). De maneira mais geral, teríamos: \\(\\mathbf{D_i} = (D_{i1}, D_{i2}, ..., D_{iT})\\) e definiríamos o resultado potencial no período \\(t\\) como \\(Y_{it}(\\mathbf{D_i})\\). \\(Y(\\mathbf{D})\\). Nesse caso, fomos para o lado oposto: tratamentos futuros impactando o resultado potencial do presente. Isso não necessariamente significa que o futuro afeta o passado. Pode ocorrer por antecipação de tratamentos futuros. De todo modo, também parece extremo. Ainda assim, continuamos evitando a possibilidade de spillovers. Uma suposição comum, portanto, é a de não-antecipação, que pode ser representada por: \\(Y_{it}(d_1, d_2, ..., d_t, d_{t+1}, ..., d_T) = Y_{it}(d_1, d_2, ..., d_t)\\). Ou seja, os resultados potenciais até \\(t\\) não dependem dos resultados potenciais após essa data. Outra suposição comum é: ausência de efeitos dinâmicos: \\[Y_{it}(d_1, d_2, ..., d_t) = Y_{it}(d_t)\\] Em palavras, essa suposição requer que o resultado potencial do presente não dependa dos tratamentos passados. Essa suposição é também chamada de “no carry-over-effects hypothesis”. Ela é bem restritiva. Mesmo um desenho em que a aleatorização é executada a cada período de maneira independente pode ter “carry-over-effects” se o resultado do período anterior impactar o resultado do período presente. Modelos de “impulse response function” estão interessados em estimar justamente “carry over effects”. ver https://donskerclass.github.io/CausalEconometrics/TimeSeries.html Considere um modelo de regressão tradicional para dados dinâmicos: \\(y_{it} = \\alpha + \\beta x_{it} + e_{it}\\). Nós já sabemos que uma forma de de pensar a identificação causal é imaginar um experimento aleatório controlado. O que significa, em primeiro lugar, escolher aleatoriamente o tratamento nesse caso? Uma possibilidade é imaginar que a cada período o tratamento é aleatoriamente atribuído, independentemente dos períodos anteriores. No fundo, é como uma multi-valued treatment. Qual condição de ignorability estamos satisfazendo nesse caso? Se apenas o tratamento presente impacta o resultado potencial, isto é, \\(Y_{it}(D_{it})\\), então temos: Baseline randomization: \\(Y(D_{it}) \\perp D_{it}\\). Ou seja, o resultado potencial no período \\(t\\) é independente do mecanismo de atribuição do tratamento. Essa suposição implica exogeneidade estrita. Ignorability sequencial (Sequential Unconfoundedness). Assume que, conditional à história passada observada de tratamentos e co-variáveis, o tratamento corrente é independente de resultados potenciais. Nós iremos aprofundar essas questões nas aulas sobre DiD e Efeitos Fixos. Por ora, quero notar que no fundo estamos falando de spillovers no tempo, isto é, tratamento no tempo \\(t\\) impatacando resultados potenciais de períodos furutos \\(t+(1:k)\\), em que \\(k &gt;0\\). 10.4 Interferência Interferência ocorre quando o resultado potencial de uma unidade depende do tratamento de outra unidade. Tipicamente, em ciências sociais, spillovers podem envolver: Efeitos de pares Spillovers espaciais Interações políticas (restrições orçamentárias) Para modelar interferência, é necessário enriquecer nosso framework, introduzindo definições adicionais e alterando os pressupostos chave. Tipicamente nós modelamos com a suposição de que a interferência ocorre apenas em um subgrupo de unidades, isto é, o resultado potencial não depende do status de tratamento de todas as unidades, mas tão somente de um grupo específico. Além disso, também é comum ser necessário a suposição de anonimidade, isto é, os pares de um grupo importam, mas não quem são os pares, no sentido de que cada par teria um efeito esepcífico e único sobre uma unidade. Essa é uma área de pesqquisa ativa na inferência causal, mas ainda pouco incorporada na ciência política, em particular nas RIs, mas não só. Referências chave são: Charles F Manski. Identification of treatment response with social interactions. The Econometrics Journal, 16(1):S1–S23, 2013. Peter M Aronow and Cyrus Samii. Estimating average causal effects under general interference, with application to a social network experiment. Annals of Applied Statistics, 11(4):1912–1947, 2017. Bowers J, Fredrickson MM, Panagopoulos C. Reasoning about Interference Between Units: A General Framework. Political Analysis. 2013;21(1):97-124. doi:10.1093/pan/mps038 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
