[["resultados-potenciais.html", "Capítulo 2 Resultados Potenciais 2.1 Causalidade e o Método Comparativo 2.2 Potential Outcomes 2.3 Notação 2.4 Problema Fundamental da Inferência Causal 2.5 Estimando 2.6 Estimandos Mais Comuns 2.7 Nota sobre estimandos 2.8 Exercício - Qual o estimando e o estimador (se possível)? 2.9 Identificação 2.10 Identificação do ATE 2.11 Equações estruturais 2.12 Referências", " Capítulo 2 Resultados Potenciais Durante muito tempo, inferência causal com regressão era caracterizada por recomendações vagas, ad hoc e inconsistências. O debate sobre o efeito causal do cigarro sobre câncer de pulmão é ilustrativo a esse respeito. Durante décadas, pesquisadores enfrentaram dificuldades para diferenciar correlação de causalidade em estudos epidemiológicos sobre tabagismo. Muitos estudos iniciais baseados apenas em correlação eram contestados por não apresentarem mecanismos claros ou critérios objetivos para validar inferências causais. Fisher (1958), por exemplo, questionou os resultados iniciais que ligavam o cigarro ao câncer por falta de critérios explícitos para identificar uma relação causal, argumentando que a correlação observada poderia decorrer de fatores confundidores, causalidade reversa ou problemas de mensuração. A situação mudou gradualmente com contribuições metodológicas importantes, como os critérios de causalidade propostos por Hill (1965). Os critérios de Bradford Hill ofereceram uma lista explícita e sistemática para avaliar a plausibilidade causal em estudos observacionais: O efeito deveria ser grande reproduzível em estudos independentes possuir uma relação monotônica com “dose” (isto é, aumento na dose não pode reduzir o efeito se o efeito é positivo e vice-versa se for negativo). corresponde a um “experimento natural”” se comporta apropriadamente quando a causa é aplicada, removida e então reinstalada. é consistente com o conhecimento especializado do tema é, por exemplo, predita por alguma teoria bem estabelecida. Nós temos amplas evidências de que muitas intervenções são causais, mesmo na ausência de qualquer experimento aleatório controlado. Sabemos, por exemplo, que defribilação, manobra de Heimlinch e uso de paraquedas são eficazes para prevenir mortes [@howick_etal_2009]. Em um artigo clássico dos primórdios da estatística escrito por Yule [@yule_1989], temos um dos primeiros exemplos de utilização da regressão para estudar o efeito causal do efeito de uma política (ajuda sobre pobreza). E a despeito do título do artigo falar em causalidade (“An investigation into the causes of changes in pauperism in england, chiefly during the last two intercensal decades”), a certa altura ele diz, em nota de rodapé, que “due to” deve ser lido como “associated to”. Quase cem anos depois, o grande estatístico Cox afirmaria em um artigo sobre causalidade: “it is remarkable how relatively little causality is mentioned in the general statistics literature, except in a social science context”[@cox_1992, p. 292]. Exemplo da perspectiva de que falava Cox quando, por exemplo, @muthen_1987 chegou a afirmar que “It would be very healthy if more researchers abandon thinking of and using terms such as cause and effect” (p. 180). Algo ecoado em uma entrevista com um dos líderes da evolução causal desde os anos 70/80, Jamie Robins, que relata que seus papers (en journals de estatística) eram rejeitados por usar linguagem causal, algo rejeitado na época [@robins_2022]. Então parece bastante seguro dizer que a sensação geral na estatística até os anos 80 é que não se deveria usar linguagem causal fora de estudos experimentais, isto é, em estudos não-observacionais. 2.1 Causalidade e o Método Comparativo A ideia de causalidade é bastante presente na ciência política na literatura de polític comparada qualitativa. Empregando os métodos advogados por Stuart Mill, a ideia de causalidade sempre estive presente e associada a ideias de relações necessárias e ou suficientes. Nesse sentido, causalidade seria determiniística. A moderna forma de pensar causalidade abandona esse paradigma de relações necessárias e/ou suficientes, para pensar em termos de contrafactual, o que no fundo é próximo do que a pesquisa comparada fazia. Tomemos um exemplo clássico dessa literatura. [inserirautor] estava interessado em estudar o efeito ccausal de [inserir variável de tratamento] sobre [variável de resultado], e comparou [unidade de tratamento] com [unidade de controle]. 2.2 Potential Outcomes Objetivos de aporendizado da aula: Aprender a diferença entre esimando, estimador e estimativa. Aprender as condições de identificação do ATE (Average Treatment Effect) 2.3 Notação Vamos assumir que existe um tratamento binário, que recebe o valor \\(1\\) se a unidade \\(i\\) recebe o tratamento, e \\(0\\) caso contrário, dado por: \\(D_i \\in \\{1,0\\}\\). Suponha que eu tenha \\(N\\) unidades que podem receber o tratamento ou controle. Então, o resultado potencial para a unidade \\(i\\) é \\(Y_i(\\mathbf{D})\\), ou seja, o resultado (potencial) da unidade \\(i\\) dado o conjunto de tratamento recebido por todas as \\(N\\) unidades. Em outras palavras, o resultado potencial depende do status de tratamento de todas as unidades. O que nos leva à primeira suposição simplificadoras: Assumption 1 (Stable Unit Treatment Value Assumption) Se \\(D_i = D{&#39;}_i\\), então \\(Y_i(\\mathbf{D}) = Y_i(\\mathbf{D}^{&#39;})\\). Em palavras, se mudarmos o tratamento de \\(i\\) de \\(D\\) para \\(D&#39;\\), então o resultado potencial depende apenas dessa mudança, e não dos demais tratamentos. Ou seja, o resultado potencial depende apenas do próprio tratamento, não dos demais. Essa suposição també é chamada de não-interferência. Então podemos escrever o resultado potencial apenas como função de \\(D_i\\): \\(Y_i(D_i)\\). Entretanto, os resultados potenciais não são observáveis. O que nós observamos é o resultado se a pessoa foi ou não tratada. O que nos leva à “switching equation”: \\(Y_i = Y_i(1)D_i + (1-D_i)Y_i(0)\\) Podemos agora definir o efeito causal do tratamento ao nível da unidade: \\(\\tau_i = Y_i(1) - Y_i(0)\\) A switching equation conecta o observado aos resultados potenciais e vice-versa. Esse modelo é chamado de Modelo Causal de Neyman-Rubin. 2.4 Problema Fundamental da Inferência Causal Barizado por Holland (1986) de Problema Fundamental da Inferência Causal (PFIC) diz que não podemos observar, simultanemente, ambos os resultados potenciais \\(Y_i(1)\\) e \\(Y_i(0)\\). Possívels soluções para o PFIC: Assumir homogeneidade temporal (comparação antes de depois da mesma unidade) Assumir homogeneidade da unidade (comparar dois indivíduos, um tratado, outro no controle) Método estatístico (foco na esperança) 2.5 Estimando O que nós estamos interessados em estimar é o nosso Estimando. Lundberg et al. (2021), definem de maneira bem completa o que é um estimando. Informalmente, é a quantidade causal que queremos estimar. Os autores separam o estimando teórico do estimando estatístico. O estimando teórico especifica a unidade teórica de interesse (ex.: o efeito de instituicões inclusivas sobre o desenvolvimento economômico do país \\(i\\); “A Dilma teria sofrido impeachment se a lava-jato não existisse?”). O segundo componente é a população-alvo. Se formos agregar essa unidade, é sobre quem ou quê? No primeiro caso, é a categoria de países em desenvolvimento em 1990? Todos os países independentes do globo no seçulo XX? No segundo caso, é mais difícil pensar qual é a população alvo. Talv ez já seja a população e, nesse caso, nao cabe se perguntar sobre qume agregaríamos a quantidade. Ou talvez a pergunta de pesquisa seja sobre crises econômicas e impeachment, e o Brasil é só um caso. Daí a população alvo pode ser, talvez, países latino-americanos. Nesse caso, a pesquisadora deverá argumentar sobre como o estudo de caso é informativo sobre a população-alvo. Estimando estatístico ou empírico é a quantidade que pode ser estimada estatisticamente (a princípio). Estimativa: a aproximação do estimando usando uma amostra finita de dados Estimador: o método ou fórmula para se chegar a uma estimativa para um estimando. 2.6 Estimandos Mais Comuns 2.6.1 ATE Vamos definir o ATE e mostrar condições suficientes para identificação desse estimando. O ATT é simplesmente o efeito causal médio entre todos os indivíduos de uma população. Às vezes chamado de PATE, de Populational Averate Treatment Effect. Definição 2.1. Chamamos de ATE na população: \\[\\tau_{\\text{ATE}} = \\mathbb{E}[\\tau_i] = \\mathbb{E}[Y_i(1) - Y_i(0)] = \\mathbb{E}[Y_i(1)] - \\mathbb{E}[Y_i(0)]\\] O ATE nos dá o efeito do tratamento em toda a população de interesse. 2.6.2 ATT Definição 2.2. Chamamos de Average Treatment Effect on the Treated (ATT): \\[\\tau_{\\text{ATT}} = \\mathbb{E}[\\tau_i|D_i=1] = \\mathbb{E}[Y_i(1) - Y_i(0)|D_i=1] = \\underbrace{\\mathbb{E}[Y_i(1)|D_i=1]}_{\\text{observado}} - \\mathbb{E}[Y_i(0)|D_i=1]\\] Note que \\(\\mathbb{E}[Y_i(1)|D_i=1]\\) é um resultado potencial que podemos observar, já que é igual ao resultado realizado dos tratados. Esse estimando estima o efeito do tratamento apenas entre os tratados. Essa quantidade é, tipicamente, a mais relevante em políticas públicas. Considere a política pública de vacinação. O que é mais importante, saber o efeito causal da vacina em toda a população, ou em toda a população que tomaria a vacina (tratados)? Ou para dar um exemplo mais claro ainda. Não é relevante o efeito do bolsa-famnília sobre redução da pobreza em toda a população, nem mesmo se considerarmos que a população alvo é toda a população pobre. Pessoas que não vão participar do programa não importam muito. Importam as que efetivamente irão receber o programa. 2.6.3 CATE Vamos definir o Conditional Average Treatment Effect (CATE). Seja \\(X_i\\) um conjunto de co-variáveis pré-determinadas (não causadas pelo tratamento). Então, podemos definir o CATE como: \\[\\tau_{\\text{CATE}} = \\mathbb{E}[\\tau_i|X_i=x] = \\mathbb{E}[Y_i(1) - Y_i(0)|X_i=x] = \\mathbb{E}[Y_i(1) - \\mathbb{E}[Y_i(1)|X_i=x]\\] Retornando ao nosso exemplo da introdução da urna eletrônica em um município sobre a pobreza municipal. ATE: O efeito médio de um município ter urna eletrônica sobre a pobreza municipal comparado a voto em papel. ATT: O efeito médio da urna eletrônica nos municípios que receberam urna eletrônica sobre a pobreza municial comparado a voto em papel. CATE: O efeito médio de urna eletrônica sobre a pobreza municipal, em um determinado grupos de municípios (ex. do semiá-rido do Nordeste), comparado a voto em papel. Se \\(X\\) for discreto, podemos estabelecer a seguinte relação entre ATE e CATE: \\[\\tau_{\\text{ATE}} = \\sum_{x \\in X} \\tau_{\\text{CATE}}(x) p(X_i = x)\\] Há outros estimandos possíveis, mas esses são os mais comuns. 2.7 Nota sobre estimandos A rigor, podemos caracterizar ao nível da população dois contrastes: a distribuição de probabilidade de resultados potenciais do tratamento com a do controle, para um dado conjunto de covariáeis de pré-tratamento \\(\\mathbf{X}\\). Formalmente, sejam \\(f(Y(1)|\\mathbf{X})\\) e \\(f(Y(0)|\\mathbf{X})\\) as densidades dos dois resultados potenciais, então \\(f(Y(1)|\\mathbf{X} - f(Y(0)|\\mathbf{X})\\) configura uma nova distribuição, da diferença entre os dois resultados potenciais. Nossa ênfase na esperança, portanto, é tanto uma questão de conveniência matemática quanto potencial interesse de pesquisa em um estimando em torno da média da diferença dessas duas distribuições, mas nada impede, a princípio, que estimarmos toda a distribuição da diferença. 2.7.1 Estimandos Exemplo: Estimando teórico: Qual o efeito do presidencialismo no país \\(i\\), quando comparado ao parlamentarismo, sobre o déficit fiscal, para países desenvolvidos? Estimando estatístico: Conditional Averate Treatment Effect (CATE) Estimativa: -0.01 (reduz em 1pp o déficit em média) Estimador: Regressão de mínimos quadrados ordinários para o subconjunto de países da OCDE. 2.8 Exercício - Qual o estimando e o estimador (se possível)? Abstract 1 Abstract 2 Abstract 3 2.9 Identificação “Econometric identification really means just one thing: model parameters or features being uniquely determined from the observable population that generates the data”(Lwebel, apud Paul GP). Ou seja, se você tiver acesso a uma amostra infinita, isto é, não há problemas inferenciais de amostra pequena, é possível estimar precisamente o parâmetro de interesse? Dizemos que, nesse caso, o estimando é identificável. O que seria um estimando não-identificável? Digamos que estou interessado em estimar o efeito causal da segunda dose de uma vacina sobre internação por uma doença. Para a pessoa receber a segunda dose, obviamente ela precisa receber a primeira. Suponha que a primeira dose ajuda a reduzir a internação. É impossível estimar o efeito causal da segunda dose. Para mostrar que o ATE é identificado, vamos supor o que chamamos de ignorabilidade forte (strong ignorability). Definição. Dizemos que \\(D_i\\) é fortemente ignorável condicional a um vetor \\(\\mathbf{X_i}\\) se: 1. \\(Y_i(1), Y_i(0) \\perp D_i\\) 2. \\(\\exists \\epsilon &gt; 0 \\text{ tal que } \\epsilon &lt; Pr(D_i = 1 | \\mathbf{X_i}) &lt; 1 - \\epsilon\\) Em palavras, a primeira condição diz que os resultados potenciais são independentes de receber ou não o tratamento. Quando pensamos em modelos com seres humanos ou unidades com agência, a principal preocupação é que as unidades não se auto-selecionam no tratamento que lhes é mais benéfico (ou que acreditam sê-lo). Às vezes na literatura essa condição aparece como permutabilidade (exchangeability): Como dizem Hernan e Robins em seu livro, “the treated and the untreated are exchangeable because the treated, had they remained untreated, would have experienced the same average outcome as the untreated did, and vice versa.”(p. 29). A segunda condição, conhecida como commmon support ou overlaping condition, diz que não existe unidade que não possa receber o tratamento ou controle. Essa condição é mais forte do que a positividade (toda unidade tem probabilidade positiva de receber o tratamento). Quero explorar aqui essa condição por meio de uma simulação. Vamos supor que um efeito causal \\(\\tau_i\\) tem distribuição normal com média \\(2\\) e desvio-padrão \\(2\\). E vamos supor que pessoas com \\(\\tau_i &gt;6\\) não podem receber o tratatamento, apenas o controle. Veremos que o efeito causal para esse subgrupo não é identificado e mesmo o ATE não é identificado. ## d1 ## d 0 1 ## 0 5019 0 ## 1 396 4585 ## [1] 2.013731 ## [1] 1.37696 Um último comentário: ignorability às vezes aparece como “tratamento é exógeno”. Porém, exogeneidade ignora a segunda condição e trata apenas da primeira. Em uma audiência de ciência política, dizemos que o tratamento é condicionalmente aleatório ou exógeno (o que é impreciso). 2.10 Identificação do ATE Teorema 1: Se \\(D_i\\) é fortemente ignorável condicional a \\(\\mathbf{X_i}\\), então: \\[\\mathbb{E}[\\tau_i] = \\sum_{x \\in X}(\\mathbb{E}[(Y_i|D_i=1, \\mathbf{X_i} = x)] - \\mathbb{E}[(Y_i|D_i=0, \\mathbf{X_i} = x)])Pr(\\mathbf{X_i = x})\\] Prova: O ATE foi definido como: \\[\\mathbb{E}[\\tau_{\\text{ATE}}] = \\mathbb{E}[\\tau_i] = \\mathbb{E}[Y_i(1)] - \\mathbb{E}[Y_i(0)]\\] Pela LIE, temos que: \\[\\mathbb{E}[Y_i(1)] = \\mathbb{E}[\\mathbb{E}[Y_i(1)|\\mathbf{X_i}]\\] \\[\\mathbb{E}[Y_i(0)] = \\mathbb{E}[\\mathbb{E}[Y_i(0)|\\mathbf{X_i}]\\] Com ignorabilidade forte, \\(\\mathbb{E}[(Y_i(0)|\\mathbf{X_i}] = \\mathbb{E}[Y_i(0)|D_i=0, \\mathbf{X_i}] = \\mathbb{E}[Y_i|D_i=0, \\mathbf{X_i}]\\). Similarmente, \\(\\mathbb{E}[(Y_i(1)|\\mathbf{X_i}] = \\mathbb{E}[Y_i(1)|D_i=1, \\mathbf{X_i}] = \\mathbb{E}[Y_i|D_i=1, \\mathbf{X_i}]\\). Juntando tudo, chegamos à proposição do teorema. Ou seja, com ignorabilidade forte, podemos estimar o ATe não-parametricamente apenas a partir de observáveis. O CATE também é identificado, como corolário. 2.11 Equações estruturais Normalmente nós temos um modelo que queremos estimar o efeito causal, e não algo sobre o mecanismo de assignment do tratamento. Vamos conectar as duas abordagens. Seja o modelo: \\(Y_i = \\alpha + \\beta D_i + \\epsilon_i\\). Vamos mapeá-lo ao modelo de resultados potenciais com a switching equation. \\[ \\begin{aligned} Y_i &amp;= Y_i(0)(1-D_i) + Y_i(1)D_i \\\\ &amp;= Y_i(0) + \\tau_i D_i \\\\ &amp;= Y_i(0) + \\tau_i D_i + \\tau D_i - \\tau D_i\\\\ &amp;= Y_i(0) + \\tau D_i + (\\tau_i - \\tau)D_i \\\\ &amp;= \\mathbb{E}[Y_i(0)|D_i=0] - \\mathbb{E}[Y_i(0)|D_i=0] + Y_i(0) + \\tau D_i + (\\tau_i - \\tau)D_i \\\\ &amp;= \\underbrace{\\mathbb{E}[Y_i(0)|D_i=0]}_{\\alpha} + \\underbrace{\\tau}_{\\beta} D_i + \\underbrace{(\\tau_i - \\tau)D_i + (Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])}_{\\epsilon_i} \\\\ \\end{aligned} \\] Nós sabemos que em uma regressão, estamos estimando \\(\\mathbb{E}[Y_i|D_i]\\). Podemos agora ver com clareza o que de fato estamos estimamos em termos causais. \\[ \\begin{aligned} \\mathbb{E}[Y_i|D_i=1] &amp;= \\alpha + \\tau + \\mathbb{E}[\\epsilon_i|D_i=1] \\\\ \\mathbb{E}[Y_i|D_i=0] &amp;= \\alpha + \\mathbb{E}[\\epsilon_i|D_i=0] \\\\ \\mathbb{E}[\\epsilon_i|D_i=1] &amp;= \\mathbb{E}[(\\tau_i - \\tau)D_i + (Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])|D_i=1] \\\\ &amp;= \\mathbb{E}[(\\tau_i - \\tau)D_i|D_i=1] + \\mathbb{E}[(Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])|D_i=1] \\\\ &amp;= \\mathbb{E}[\\tau_i D_i|D_i=1] -\\tau\\mathbb{E}[ D_i|D_i=1] + \\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[\\mathbb{E}[Y_i(0)|D_i=0]|D_i=1] \\\\ &amp;= (\\mathbb{E}[\\tau_i|D_i=1] -\\tau) + \\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] \\\\ \\mathbb{E}[\\epsilon_i|D_i=0] &amp;= \\mathbb{E}[(\\tau_i - \\tau)D_i + (Y_i(0) - \\mathbb{E}[Y_i(0)|D_i=0])|D_i=1] \\\\ &amp;= \\mathbb{E}[Y_i(0)|D_i=0] - \\mathbb{E}[\\mathbb{E}[Y_i(0)|D_i=0]|D_i=0] \\\\ &amp;= 0 \\end{aligned} \\] Portanto, \\(\\mathbb{E}[Y_i|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] = \\tau + (\\mathbb{E}[\\tau_i|D_i=1] -\\tau) + \\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0]\\) Em palavras, estimamos o efeito causal médio, \\(\\tau\\), mais um componente que tem a ver com os efeitos causais heterogêneos mais um componente que é a diferença no resultado potencial do controle entre os tratados e o controle. Se \\(\\mathbb{E}[Y_i(0)|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] \\neq 0\\), o efeito estimado é viesado. Similarmente, se \\(\\mathbb{E}[\\tau_i|D_i=1] \\neq \\tau\\), também teremos viés, ou seja, se o efeito causal dos tratados for diferente do efeito médio da população, também temos uma estimativa viesada do ATE. Porém, nesse caso, note que estamos viesando para estimar o efeito médio dos tratados, que é o ATT. Para ver isso, suponha que não há diferença nos resultados potenciais de tratamento e controle, de modo que \\(\\mathbb{E}[Y_i|D_i=1] - \\mathbb{E}[Y_i(0)|D_i=0] = \\tau + (\\mathbb{E}[\\tau_i|D_i=1] -\\tau) = \\mathbb{E}[\\tau_i|D_i=1]\\), que é o ATT. 2.12 Referências Lundberg, I., Johnson, R., &amp; Stewart, B. M. (2021). What is your estimand? Defining the target quantity connects statistical evidence to theory. American Sociological Review, 86(3), 532-565. Paul W Holland. Statistics and causal inference. Journal of the American statistical Association, 81(396):945–960, 1986. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
